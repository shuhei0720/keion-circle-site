# ç¬¬16ç« ï¼šã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«èª¿æ•´æ©Ÿèƒ½ã®å®Ÿè£…

> **ã“ã®ç« ã§ã¯ã€è¤‡æ•°ã®å€™è£œæ—¥ã‹ã‚‰æœ€é©ãªæ—¥ç¨‹ã‚’æ±ºã‚ã‚‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«èª¿æ•´æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™**

## ğŸ“š ã“ã®ç« ã§å­¦ã¶ã“ã¨

- âœ… è¤‡æ•°å€™è£œæ—¥ã®ç®¡ç†
- âœ… 3æ®µéšæŠ•ç¥¨ã‚·ã‚¹ãƒ†ãƒ ï¼ˆâ—¯/â–³/âœ•ï¼‰
- âœ… æŠ•ç¥¨çµæœã®é›†è¨ˆã¨å¯è¦–åŒ–
- âœ… æœ€æœ‰åŠ›å€™è£œã®è‡ªå‹•é¸å‡º
- âœ… å€™è£œæ—¥ã”ã¨ã®ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½
- âœ… æ¥½è¦³çš„UIã«ã‚ˆã‚‹å³åº§ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

## ğŸ’¡ ã“ã®ç« ã§å®Ÿè£…ã™ã‚‹æ©Ÿèƒ½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«èª¿æ•´æ©Ÿèƒ½ã®å…¨ä½“åƒ                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆã€‘
ç®¡ç†è€…ãŒè¤‡æ•°ã®å€™è£œæ—¥ã‚’è¨­å®š
   â†“
ã€ãƒ¡ãƒ³ãƒãƒ¼æŠ•ç¥¨ã€‘
å„å€™è£œæ—¥ã«å¯¾ã—ã¦ â—¯/â–³/âœ• ã§æŠ•ç¥¨
   â†“
ã€çµæœé›†è¨ˆã€‘
å‚åŠ å¯èƒ½ãªäººæ•°ã‚’è‡ªå‹•é›†è¨ˆ
   â†“
ã€æœ€æœ‰åŠ›å€™è£œè¡¨ç¤ºã€‘
æœ€ã‚‚å‚åŠ è€…ãŒå¤šã„å€™è£œæ—¥ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å€™è£œæ—¥1: 12/25(æ°´) 18:00        â”‚
â”‚   â—¯: 8å  â–³: 2å  âœ•: 1å        â”‚
â”‚   â˜… æœ€æœ‰åŠ›å€™è£œï¼                  â”‚
â”‚   [ã‚ãªãŸ: â—¯] [â–³] [âœ•]           â”‚
â”‚   ğŸ’¬ ã‚³ãƒ¡ãƒ³ãƒˆ: 3ä»¶                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å€™è£œæ—¥2: 12/26(æœ¨) 18:00        â”‚
â”‚   â—¯: 6å  â–³: 3å  âœ•: 2å        â”‚
â”‚   [â—¯] [ã‚ãªãŸ: â–³] [âœ•]           â”‚
â”‚   ğŸ’¬ ã‚³ãƒ¡ãƒ³ãƒˆ: 1ä»¶                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 16.1 ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã®ç¢ºèª

### ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã®æ§‹é€ 

ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«èª¿æ•´æ©Ÿèƒ½ã¯ã€3ã¤ã®ãƒ¢ãƒ‡ãƒ«ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Scheduleï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æœ¬ä½“ï¼‰         â”‚
â”‚  - id                                   â”‚
â”‚  - title                                â”‚
â”‚  - description                          â”‚
â”‚  - authorId                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 1å¯¾å¤š
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ScheduleCandidateï¼ˆå€™è£œæ—¥ï¼‰            â”‚
â”‚  - id                                   â”‚
â”‚  - scheduleId                           â”‚
â”‚  - date                                 â”‚
â”‚  - location                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 1å¯¾å¤š
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ScheduleVoteï¼ˆæŠ•ç¥¨ï¼‰                   â”‚
â”‚  - id                                   â”‚
â”‚  - candidateId                          â”‚
â”‚  - userId                               â”‚
â”‚  - status (AVAILABLE/MAYBE/UNAVAILABLE) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step 1: Prismaã‚¹ã‚­ãƒ¼ãƒã®ç¢ºèª

`prisma/schema.prisma` ã‚’é–‹ã„ã¦ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é–¢é€£ã®ãƒ¢ãƒ‡ãƒ«ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

```prisma
// ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆè¤‡æ•°å€™è£œæ—¥ã‚’æŒã¤ï¼‰
model Schedule {
  id          String   @id @default(cuid())
  title       String
  description String?
  
  // ä½œæˆè€…
  author      User     @relation(fields: [authorId], references: [id])
  authorId    String
  
  // å€™è£œæ—¥ä¸€è¦§
  candidates  ScheduleCandidate[]
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å€™è£œæ—¥
model ScheduleCandidate {
  id         String   @id @default(cuid())
  date       DateTime
  location   String?
  
  // æ‰€å±ã™ã‚‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
  schedule   Schedule @relation(fields: [scheduleId], references: [id], onDelete: Cascade)
  scheduleId String
  
  // ã“ã®å€™è£œæ—¥ã¸ã®æŠ•ç¥¨
  votes      ScheduleVote[]
  
  // ã“ã®å€™è£œæ—¥ã¸ã®ã‚³ãƒ¡ãƒ³ãƒˆ
  comments   ScheduleCandidateComment[]
  
  createdAt  DateTime @default(now())
}

// å€™è£œæ—¥ã¸ã®æŠ•ç¥¨
model ScheduleVote {
  id          String       @id @default(cuid())
  status      VoteStatus   // AVAILABLE, MAYBE, UNAVAILABLE
  
  // æŠ•ç¥¨è€…
  user        User         @relation(fields: [userId], references: [id])
  userId      String
  
  // æŠ•ç¥¨å…ˆã®å€™è£œæ—¥
  candidate   ScheduleCandidate @relation(fields: [candidateId], references: [id], onDelete: Cascade)
  candidateId String
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåŒã˜å€™è£œæ—¥ã«è¤‡æ•°å›æŠ•ç¥¨ã§ããªã„ã‚ˆã†ã«ã™ã‚‹
  @@unique([userId, candidateId])
}

// æŠ•ç¥¨ã®çŠ¶æ…‹ï¼ˆ3æ®µéšï¼‰
enum VoteStatus {
  AVAILABLE    // â—¯ å‚åŠ å¯èƒ½
  MAYBE        // â–³ æœªå®š
  UNAVAILABLE  // âœ• å‚åŠ ä¸å¯
}

// å€™è£œæ—¥ã¸ã®ã‚³ãƒ¡ãƒ³ãƒˆ
model ScheduleCandidateComment {
  id          String   @id @default(cuid())
  content     String
  
  // ã‚³ãƒ¡ãƒ³ãƒˆè€…
  user        User     @relation(fields: [userId], references: [id])
  userId      String
  
  // ã‚³ãƒ¡ãƒ³ãƒˆå…ˆã®å€™è£œæ—¥
  candidate   ScheduleCandidate @relation(fields: [candidateId], references: [id], onDelete: Cascade)
  candidateId String
  
  createdAt   DateTime @default(now())
}
```

**ãƒ¢ãƒ‡ãƒ«ã®ãƒã‚¤ãƒ³ãƒˆ:**

| ãƒ¢ãƒ‡ãƒ« | èª¬æ˜ |
|--------|------|
| `Schedule` | ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æœ¬ä½“ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜ï¼‰ |
| `ScheduleCandidate` | å€™è£œæ—¥ï¼ˆæ—¥æ™‚ã€å ´æ‰€ï¼‰ |
| `ScheduleVote` | æŠ•ç¥¨ï¼ˆâ—¯/â–³/âœ•ï¼‰ |
| `VoteStatus` | æŠ•ç¥¨çŠ¶æ…‹ã®Enumå‹ |
| `ScheduleCandidateComment` | å€™è£œæ—¥ã¸ã®ã‚³ãƒ¡ãƒ³ãƒˆ |

**é‡è¦ãªåˆ¶ç´„:**
- `@@unique([userId, candidateId])`: åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåŒã˜å€™è£œæ—¥ã«é‡è¤‡æŠ•ç¥¨ã§ããªã„
- `onDelete: Cascade`: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å‰Šé™¤æ™‚ã«å€™è£œæ—¥ãƒ»æŠ•ç¥¨ã‚‚é€£é–å‰Šé™¤

---

## 16.2 ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§ãƒšãƒ¼ã‚¸ã®å®Ÿè£…

### Step 1: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§ãƒšãƒ¼ã‚¸ã‚’ä½œæˆ

`src/app/schedules/page.tsx` ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

```typescript
import { prisma } from '@/lib/db';
import { auth } from '@/lib/auth';
import Link from 'next/link';
import { Calendar, Users, Plus, CheckCircle } from 'lucide-react';

export default async function SchedulesPage() {
  const session = await auth();

  // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§ã‚’å–å¾—
  const schedules = await prisma.schedule.findMany({
    include: {
      author: {
        select: {
          id: true,
          name: true,
          image: true,
        },
      },
      candidates: {
        include: {
          votes: true,
        },
        orderBy: {
          date: 'asc',
        },
      },
    },
    orderBy: {
      createdAt: 'desc',
    },
  });

  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
        <div className="flex justify-between items-center mb-8">
          <div>
            <h1 className="text-3xl font-bold text-gray-900">
              ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«èª¿æ•´
            </h1>
            <p className="text-gray-600 mt-2">
              è¤‡æ•°ã®å€™è£œæ—¥ã‹ã‚‰æœ€é©ãªæ—¥ç¨‹ã‚’æ±ºã‚ã¾ã—ã‚‡ã†
            </p>
          </div>

          {/* æ–°è¦ä½œæˆãƒœã‚¿ãƒ³ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰ */}
          {session?.user?.role === 'admin' && (
            <Link
              href="/schedules/new"
              className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2"
            >
              <Plus size={20} />
              æ–°è¦ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
            </Link>
          )}
        </div>

        {/* ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§ */}
        {schedules.length === 0 ? (
          <div className="bg-white rounded-lg shadow p-12 text-center">
            <p className="text-gray-500 text-lg">
              ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“
            </p>
            {session?.user?.role === 'admin' && (
              <Link
                href="/schedules/new"
                className="inline-block mt-4 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
              >
                ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½œæˆ
              </Link>
            )}
          </div>
        ) : (
          <div className="space-y-6">
            {schedules.map((schedule) => (
              <ScheduleCard
                key={schedule.id}
                schedule={schedule}
                session={session}
              />
            ))}
          </div>
        )}
      </div>
    </div>
  );
}

// ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
function ScheduleCard({ schedule, session }: { schedule: any; session: any }) {
  // æœ€æœ‰åŠ›å€™è£œã‚’è¨ˆç®—
  const bestCandidate = schedule.candidates.reduce(
    (best: any, candidate: any) => {
      const availableCount = candidate.votes.filter(
        (v: any) => v.status === 'AVAILABLE'
      ).length;
      
      if (!best || availableCount > best.count) {
        return { candidate, count: availableCount };
      }
      return best;
    },
    null
  );

  return (
    <Link
      href={`/schedules/${schedule.id}`}
      className="block bg-white rounded-lg shadow hover:shadow-lg transition-shadow"
    >
      <div className="p-6">
        {/* ã‚¿ã‚¤ãƒˆãƒ«ã¨èª¬æ˜ */}
        <div className="mb-4">
          <h2 className="text-2xl font-bold text-gray-900 mb-2">
            {schedule.title}
          </h2>
          {schedule.description && (
            <p className="text-gray-600">{schedule.description}</p>
          )}
        </div>

        {/* å€™è£œæ—¥ä¸€è¦§ */}
        <div className="space-y-3 mb-4">
          {schedule.candidates.map((candidate: any) => {
            const availableCount = candidate.votes.filter(
              (v: any) => v.status === 'AVAILABLE'
            ).length;
            const maybeCount = candidate.votes.filter(
              (v: any) => v.status === 'MAYBE'
            ).length;
            const unavailableCount = candidate.votes.filter(
              (v: any) => v.status === 'UNAVAILABLE'
            ).length;

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æŠ•ç¥¨çŠ¶æ…‹
            const userVote = session?.user
              ? candidate.votes.find((v: any) => v.userId === session.user.id)
              : null;

            // æœ€æœ‰åŠ›å€™è£œã‹ã©ã†ã‹
            const isBest =
              bestCandidate?.candidate.id === candidate.id &&
              availableCount > 0;

            return (
              <div
                key={candidate.id}
                className={`
                  p-4 rounded-lg border-2
                  ${isBest ? 'border-green-500 bg-green-50' : 'border-gray-200'}
                `}
              >
                <div className="flex items-start justify-between">
                  <div className="flex-1">
                    {/* æ—¥æ™‚ */}
                    <div className="flex items-center gap-2 mb-2">
                      <Calendar size={18} className="text-gray-500" />
                      <span className="font-semibold text-gray-900">
                        {new Date(candidate.date).toLocaleDateString('ja-JP', {
                          month: 'long',
                          day: 'numeric',
                          weekday: 'short',
                          hour: '2-digit',
                          minute: '2-digit',
                        })}
                      </span>
                      {isBest && (
                        <span className="px-2 py-1 bg-green-500 text-white text-xs font-bold rounded">
                          æœ€æœ‰åŠ›
                        </span>
                      )}
                    </div>

                    {/* æŠ•ç¥¨çŠ¶æ³ */}
                    <div className="flex items-center gap-4 text-sm">
                      <span className="text-green-600 font-medium">
                        â—¯ {availableCount}å
                      </span>
                      <span className="text-yellow-600 font-medium">
                        â–³ {maybeCount}å
                      </span>
                      <span className="text-red-600 font-medium">
                        âœ• {unavailableCount}å
                      </span>
                    </div>
                  </div>

                  {/* ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æŠ•ç¥¨çŠ¶æ…‹ */}
                  {userVote && (
                    <div className="ml-4">
                      {userVote.status === 'AVAILABLE' && (
                        <span className="text-2xl">â—¯</span>
                      )}
                      {userVote.status === 'MAYBE' && (
                        <span className="text-2xl">â–³</span>
                      )}
                      {userVote.status === 'UNAVAILABLE' && (
                        <span className="text-2xl">âœ•</span>
                      )}
                    </div>
                  )}
                </div>
              </div>
            );
          })}
        </div>

        {/* ãƒ•ãƒƒã‚¿ãƒ¼ */}
        <div className="flex items-center justify-between pt-4 border-t border-gray-200 text-sm text-gray-600">
          <div className="flex items-center gap-2">
            <Users size={16} />
            <span>{schedule.candidates.length}å€‹ã®å€™è£œæ—¥</span>
          </div>
          <span>
            ä½œæˆ: {new Date(schedule.createdAt).toLocaleDateString('ja-JP')}
          </span>
        </div>
      </div>
    </Link>
  );
}
```

**ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§ã®ç‰¹å¾´:**

1. âœ… **å€™è£œæ—¥ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**: å„å€™è£œæ—¥ã®æŠ•ç¥¨çŠ¶æ³ã‚’ä¸€ç›®ã§ç¢ºèª
2. âœ… **æœ€æœ‰åŠ›å€™è£œã®è¡¨ç¤º**: æœ€ã‚‚å‚åŠ è€…ãŒå¤šã„å€™è£œæ—¥ã‚’ç·‘ã§ãƒã‚¤ãƒ©ã‚¤ãƒˆ
3. âœ… **è‡ªåˆ†ã®æŠ•ç¥¨çŠ¶æ…‹**: â—¯/â–³/âœ• ã§è¡¨ç¤º
4. âœ… **ã‚«ãƒ¼ãƒ‰å½¢å¼**: ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ãƒšãƒ¼ã‚¸ã¸

### Step 2: å‹•ä½œç¢ºèª

ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:3000/schedules ã‚’é–‹ã„ã¦ãã ã•ã„ã€‚

â†’ âœ… ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼ï¼ˆã¾ã ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒãªã„å ´åˆã¯ç©ºã®çŠ¶æ…‹ï¼‰

---

## 16.3 ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆæ©Ÿèƒ½ã®å®Ÿè£…

### Step 1: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆAPIã‚’å®Ÿè£…

`src/app/api/schedules/route.ts` ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

```typescript
import { NextResponse } from 'next/server';
import { auth } from '@/lib/auth';
import { prisma } from '@/lib/db';

/**
 * ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆï¼ˆPOSTï¼‰
 */
export async function POST(request: Request) {
  try {
    // èªè¨¼ãƒã‚§ãƒƒã‚¯
    const session = await auth();
    if (!session?.user) {
      return NextResponse.json(
        { error: 'ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™' },
        { status: 401 }
      );
    }

    // ç®¡ç†è€…æ¨©é™ãƒã‚§ãƒƒã‚¯
    if (session.user.role !== 'admin') {
      return NextResponse.json(
        { error: 'ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™' },
        { status: 403 }
      );
    }

    const body = await request.json();
    const { title, description, candidates } = body;

    // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    if (!title) {
      return NextResponse.json(
        { error: 'ã‚¿ã‚¤ãƒˆãƒ«ã¯å¿…é ˆã§ã™' },
        { status: 400 }
      );
    }

    if (!candidates || candidates.length === 0) {
      return NextResponse.json(
        { error: 'å€™è£œæ—¥ã‚’1ã¤ä»¥ä¸Šè¨­å®šã—ã¦ãã ã•ã„' },
        { status: 400 }
      );
    }

    // å€™è£œæ—¥ã®æ¤œè¨¼
    for (const candidate of candidates) {
      if (!candidate.date) {
        return NextResponse.json(
          { error: 'å€™è£œæ—¥ã®æ—¥æ™‚ã¯å¿…é ˆã§ã™' },
          { status: 400 }
        );
      }

      const candidateDate = new Date(candidate.date);
      if (isNaN(candidateDate.getTime())) {
        return NextResponse.json(
          { error: 'ç„¡åŠ¹ãªæ—¥æ™‚ã§ã™' },
          { status: 400 }
        );
      }
    }

    // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨å€™è£œæ—¥ã‚’ä¸€æ‹¬ä½œæˆ
    const schedule = await prisma.schedule.create({
      data: {
        title,
        description: description || null,
        authorId: session.user.id,
        candidates: {
          create: candidates.map((c: any) => ({
            date: new Date(c.date),
            location: c.location || null,
          })),
        },
      },
      include: {
        author: {
          select: {
            id: true,
            name: true,
            email: true,
            image: true,
          },
        },
        candidates: {
          orderBy: {
            date: 'asc',
          },
        },
      },
    });

    return NextResponse.json({ schedule }, { status: 201 });
  } catch (error) {
    console.error('ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆã‚¨ãƒ©ãƒ¼:', error);
    return NextResponse.json(
      { error: 'ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ' },
      { status: 500 }
    );
  }
}
```

### Step 2: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆãƒšãƒ¼ã‚¸ã‚’ä½œæˆ

`src/app/schedules/new/page.tsx` ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

```typescript
import { auth } from '@/lib/auth';
import { redirect } from 'next/navigation';
import { ScheduleForm } from '@/components/ScheduleForm';

export default async function NewSchedulePage() {
  const session = await auth();

  // èªè¨¼ãƒã‚§ãƒƒã‚¯
  if (!session) {
    redirect('/auth/signin');
  }

  // ç®¡ç†è€…æ¨©é™ãƒã‚§ãƒƒã‚¯
  if (session.user?.role !== 'admin') {
    redirect('/schedules');
  }

  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <h1 className="text-3xl font-bold text-gray-900 mb-8">
          æ–°è¦ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆ
        </h1>
        
        <ScheduleForm />
      </div>
    </div>
  );
}
```

### Step 3: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆ

`src/components/ScheduleForm.tsx` ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

```typescript
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { Plus, X } from 'lucide-react';
import { Button } from '@/components/ui/Button';

interface Candidate {
  date: string;
  location: string;
}

export function ScheduleForm() {
  const router = useRouter();
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  // ãƒ•ã‚©ãƒ¼ãƒ ã®çŠ¶æ…‹
  const [title, setTitle] = useState('');
  const [description, setDescription] = useState('');
  const [candidates, setCandidates] = useState<Candidate[]>([
    { date: '', location: '' },
    { date: '', location: '' },
  ]);

  // å€™è£œæ—¥ã‚’è¿½åŠ 
  const addCandidate = () => {
    setCandidates([...candidates, { date: '', location: '' }]);
  };

  // å€™è£œæ—¥ã‚’å‰Šé™¤
  const removeCandidate = (index: number) => {
    if (candidates.length <= 1) {
      alert('å€™è£œæ—¥ã¯æœ€ä½1ã¤å¿…è¦ã§ã™');
      return;
    }
    setCandidates(candidates.filter((_, i) => i !== index));
  };

  // å€™è£œæ—¥ã‚’æ›´æ–°
  const updateCandidate = (
    index: number,
    field: 'date' | 'location',
    value: string
  ) => {
    const newCandidates = [...candidates];
    newCandidates[index][field] = value;
    setCandidates(newCandidates);
  };

  // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError('');
    setLoading(true);

    try {
      // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
      if (!title.trim()) {
        setError('ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        setLoading(false);
        return;
      }

      // å€™è£œæ—¥ã®æ¤œè¨¼ï¼ˆç©ºã§ãªã„å€™è£œæ—¥ã®ã¿ï¼‰
      const validCandidates = candidates.filter((c) => c.date.trim());

      if (validCandidates.length === 0) {
        setError('å€™è£œæ—¥ã‚’1ã¤ä»¥ä¸Šè¨­å®šã—ã¦ãã ã•ã„');
        setLoading(false);
        return;
      }

      const response = await fetch('/api/schedules', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          title: title.trim(),
          description: description.trim() || null,
          candidates: validCandidates.map((c) => ({
            date: new Date(c.date).toISOString(),
            location: c.location.trim() || null,
          })),
        }),
      });

      const data = await response.json();

      if (!response.ok) {
        setError(data.error || 'ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ');
        setLoading(false);
        return;
      }

      // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è©³ç´°ãƒšãƒ¼ã‚¸ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
      router.push(`/schedules/${data.schedule.id}`);
      router.refresh();
    } catch (err) {
      setError('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
      setLoading(false);
    }
  };

  return (
    <form onSubmit={handleSubmit} className="bg-white rounded-lg shadow p-6">
      {/* ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */}
      {error && (
        <div className="mb-6 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg">
          {error}
        </div>
      )}

      {/* ã‚¿ã‚¤ãƒˆãƒ« */}
      <div className="mb-6">
        <label
          htmlFor="title"
          className="block text-sm font-medium text-gray-700 mb-2"
        >
          ã‚¿ã‚¤ãƒˆãƒ« <span className="text-red-500">*</span>
        </label>
        <input
          id="title"
          type="text"
          value={title}
          onChange={(e) => setTitle(e.target.value)}
          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          placeholder="ä¾‹: 1æœˆå®šæœŸãƒ©ã‚¤ãƒ–ã®æ—¥ç¨‹èª¿æ•´"
          required
        />
      </div>

      {/* èª¬æ˜ */}
      <div className="mb-6">
        <label
          htmlFor="description"
          className="block text-sm font-medium text-gray-700 mb-2"
        >
          èª¬æ˜
        </label>
        <textarea
          id="description"
          value={description}
          onChange={(e) => setDescription(e.target.value)}
          rows={3}
          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          placeholder="ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«èª¿æ•´ã®ç›®çš„ã‚„æ³¨æ„äº‹é …ã‚’å…¥åŠ›..."
        />
      </div>

      {/* å€™è£œæ—¥ */}
      <div className="mb-6">
        <div className="flex items-center justify-between mb-4">
          <label className="block text-sm font-medium text-gray-700">
            å€™è£œæ—¥ <span className="text-red-500">*</span>
          </label>
          <button
            type="button"
            onClick={addCandidate}
            className="text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1"
          >
            <Plus size={16} />
            å€™è£œæ—¥ã‚’è¿½åŠ 
          </button>
        </div>

        <div className="space-y-4">
          {candidates.map((candidate, index) => (
            <div
              key={index}
              className="p-4 border border-gray-200 rounded-lg bg-gray-50"
            >
              <div className="flex items-start gap-4">
                <div className="flex-1 space-y-3">
                  {/* å€™è£œæ—¥ç•ªå· */}
                  <div className="font-semibold text-gray-700">
                    å€™è£œæ—¥ {index + 1}
                  </div>

                  {/* æ—¥æ™‚ */}
                  <div>
                    <label className="block text-sm text-gray-600 mb-1">
                      æ—¥æ™‚ <span className="text-red-500">*</span>
                    </label>
                    <input
                      type="datetime-local"
                      value={candidate.date}
                      onChange={(e) =>
                        updateCandidate(index, 'date', e.target.value)
                      }
                      className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                      required
                    />
                  </div>

                  {/* å ´æ‰€ */}
                  <div>
                    <label className="block text-sm text-gray-600 mb-1">
                      å ´æ‰€ï¼ˆä»»æ„ï¼‰
                    </label>
                    <input
                      type="text"
                      value={candidate.location}
                      onChange={(e) =>
                        updateCandidate(index, 'location', e.target.value)
                      }
                      className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="ä¾‹: ã‚¹ã‚¿ã‚¸ã‚ªA"
                    />
                  </div>
                </div>

                {/* å‰Šé™¤ãƒœã‚¿ãƒ³ */}
                {candidates.length > 1 && (
                  <button
                    type="button"
                    onClick={() => removeCandidate(index)}
                    className="p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"
                    title="å‰Šé™¤"
                  >
                    <X size={20} />
                  </button>
                )}
              </div>
            </div>
          ))}
        </div>

        <p className="mt-3 text-sm text-gray-500">
          ğŸ’¡ ãƒ’ãƒ³ãƒˆ: è¤‡æ•°ã®å€™è£œæ—¥ã‚’è¨­å®šã™ã‚‹ã¨ã€ãƒ¡ãƒ³ãƒãƒ¼ãŒéƒ½åˆã®è‰¯ã„æ—¥ã‚’é¸ã³ã‚„ã™ããªã‚Šã¾ã™
        </p>
      </div>

      {/* ãƒœã‚¿ãƒ³ */}
      <div className="flex gap-4">
        <Button
          type="submit"
          variant="primary"
          loading={loading}
          className="flex-1"
        >
          ä½œæˆ
        </Button>
        
        <Button
          type="button"
          variant="outline"
          onClick={() => router.back()}
          disabled={loading}
        >
          ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        </Button>
      </div>
    </form>
  );
}
```

**ScheduleFormã®ç‰¹å¾´:**

1. âœ… **å‹•çš„ãƒ•ã‚©ãƒ¼ãƒ **: å€™è£œæ—¥ã‚’è‡ªç”±ã«è¿½åŠ ãƒ»å‰Šé™¤
2. âœ… **å¿…é ˆé …ç›®**: ã‚¿ã‚¤ãƒˆãƒ«ã¨æœ€ä½1ã¤ã®å€™è£œæ—¥
3. âœ… **ä»»æ„é …ç›®**: èª¬æ˜ã¨å ´æ‰€
4. âœ… **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: ç©ºã®å€™è£œæ—¥ã¯é™¤å¤–

### Step 4: å‹•ä½œç¢ºèª

**4-1.** ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒ­ã‚°ã‚¤ãƒ³

**4-2.** http://localhost:3000/schedules/new ã‚’é–‹ã

**4-3.** ãƒ•ã‚©ãƒ¼ãƒ ã«å…¥åŠ›

```
ã‚¿ã‚¤ãƒˆãƒ«: 1æœˆå®šæœŸãƒ©ã‚¤ãƒ–ã®æ—¥ç¨‹èª¿æ•´
èª¬æ˜: 1æœˆã®ãƒ©ã‚¤ãƒ–æ—¥ç¨‹ã‚’æ±ºã‚ã¾ã—ã‚‡ã†

å€™è£œæ—¥1:
  æ—¥æ™‚: 2025-01-15 18:00
  å ´æ‰€: ã‚¹ã‚¿ã‚¸ã‚ªA

å€™è£œæ—¥2:
  æ—¥æ™‚: 2025-01-22 18:00
  å ´æ‰€: ã‚¹ã‚¿ã‚¸ã‚ªA
```

**4-4.** ã€Œä½œæˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

â†’ âœ… ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒä½œæˆã•ã‚Œã€è©³ç´°ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¾ã™ï¼

---

## 16.4 æŠ•ç¥¨æ©Ÿèƒ½ã®å®Ÿè£…

### æŠ•ç¥¨æ©Ÿèƒ½ã®ä»•çµ„ã¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         3æ®µéšæŠ•ç¥¨ã‚·ã‚¹ãƒ†ãƒ                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€æŠ•ç¥¨ã®ç¨®é¡ã€‘
â—¯ AVAILABLE    å‚åŠ å¯èƒ½ï¼ˆå„ªå…ˆåº¦: é«˜ï¼‰
â–³ MAYBE        æœªå®šï¼ˆå„ªå…ˆåº¦: ä¸­ï¼‰
âœ• UNAVAILABLE  å‚åŠ ä¸å¯ï¼ˆå„ªå…ˆåº¦: ä½ï¼‰

ã€æŠ•ç¥¨ã®æµã‚Œã€‘
1ï¸âƒ£ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå€™è£œæ—¥ã®â—¯/â–³/âœ•ã‚’ã‚¯ãƒªãƒƒã‚¯
2ï¸âƒ£ æ¥½è¦³çš„UI: å³åº§ã«ç”»é¢ã‚’æ›´æ–°
3ï¸âƒ£ APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ: POST /api/schedules/candidates/[id]/vote
4ï¸âƒ£ ã‚µãƒ¼ãƒãƒ¼ã§æ—¢å­˜æŠ•ç¥¨ã‚’ãƒã‚§ãƒƒã‚¯
   - ãªã‘ã‚Œã° â†’ æ–°è¦ä½œæˆ
   - ã‚ã‚Œã°   â†’ æ›´æ–°ï¼ˆåŒã˜ãªã‚‰å‰Šé™¤ï¼‰
5ï¸âƒ£ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ã‘å–ã‚‹
6ï¸âƒ£ ãƒšãƒ¼ã‚¸ã‚’å†æ¤œè¨¼
```

### Step 1: æŠ•ç¥¨APIã‚’å®Ÿè£…

`src/app/api/schedules/candidates/[id]/vote/route.ts` ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

```typescript
import { NextResponse } from 'next/server';
import { auth } from '@/lib/auth';
import { prisma } from '@/lib/db';

/**
 * æŠ•ç¥¨ã®ä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤ï¼ˆPOSTï¼‰
 */
export async function POST(
  request: Request,
  { params }: { params: { id: string } }
) {
  try {
    // èªè¨¼ãƒã‚§ãƒƒã‚¯
    const session = await auth();
    if (!session?.user) {
      return NextResponse.json(
        { error: 'ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™' },
        { status: 401 }
      );
    }

    const candidateId = params.id;
    const userId = session.user.id;
    const body = await request.json();
    const { status } = body; // AVAILABLE, MAYBE, UNAVAILABLE

    // å€™è£œæ—¥ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
    const candidate = await prisma.scheduleCandidate.findUnique({
      where: { id: candidateId },
    });

    if (!candidate) {
      return NextResponse.json(
        { error: 'å€™è£œæ—¥ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“' },
        { status: 404 }
      );
    }

    // æ—¢å­˜ã®æŠ•ç¥¨ã‚’ç¢ºèª
    const existingVote = await prisma.scheduleVote.findUnique({
      where: {
        userId_candidateId: {
          userId,
          candidateId,
        },
      },
    });

    if (existingVote) {
      if (existingVote.status === status) {
        // åŒã˜çŠ¶æ…‹ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ æŠ•ç¥¨ã‚’å‰Šé™¤ï¼ˆå–ã‚Šæ¶ˆã—ï¼‰
        await prisma.scheduleVote.delete({
          where: { id: existingVote.id },
        });

        return NextResponse.json({
          vote: null,
          message: 'æŠ•ç¥¨ã‚’å–ã‚Šæ¶ˆã—ã¾ã—ãŸ',
        });
      } else {
        // ç•°ãªã‚‹çŠ¶æ…‹ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ æŠ•ç¥¨ã‚’æ›´æ–°
        const updatedVote = await prisma.scheduleVote.update({
          where: { id: existingVote.id },
          data: { status },
          include: {
            user: {
              select: {
                id: true,
                name: true,
                image: true,
              },
            },
          },
        });

        return NextResponse.json({
          vote: updatedVote,
          message: 'æŠ•ç¥¨ã‚’æ›´æ–°ã—ã¾ã—ãŸ',
        });
      }
    } else {
      // æ–°è¦æŠ•ç¥¨
      const newVote = await prisma.scheduleVote.create({
        data: {
          userId,
          candidateId,
          status,
        },
        include: {
          user: {
            select: {
              id: true,
              name: true,
              image: true,
            },
          },
        },
      });

      return NextResponse.json({
        vote: newVote,
        message: 'æŠ•ç¥¨ã—ã¾ã—ãŸ',
      });
    }
  } catch (error) {
    console.error('æŠ•ç¥¨ã‚¨ãƒ©ãƒ¼:', error);
    return NextResponse.json(
      { error: 'æŠ•ç¥¨ã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ' },
      { status: 500 }
    );
  }
}
```

**æŠ•ç¥¨APIã®å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     æŠ•ç¥¨APIã®å‡¦ç†ãƒ•ãƒ­ãƒ¼                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  æ—¢å­˜æŠ•ç¥¨ã‚ã‚Š?                          â”‚
â”‚  â”œâ”€ NO  â†’ æ–°è¦ä½œæˆ                     â”‚
â”‚  â””â”€ YES â†’ åŒã˜çŠ¶æ…‹?                    â”‚
â”‚           â”œâ”€ YES â†’ å‰Šé™¤ï¼ˆå–ã‚Šæ¶ˆã—ï¼‰    â”‚
â”‚           â””â”€ NO  â†’ æ›´æ–°                â”‚
â”‚                                        â”‚
â”‚  ä¾‹:                                   â”‚
â”‚  â—¯ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ â—¯æŠ•ç¥¨ä½œæˆ              â”‚
â”‚  â—¯ã‚’å†ã‚¯ãƒªãƒƒã‚¯ â†’ â—¯æŠ•ç¥¨å‰Šé™¤            â”‚
â”‚  â–³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ â—¯â†’â–³ã«æ›´æ–°             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step 2: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è©³ç´°ãƒšãƒ¼ã‚¸ã‚’ä½œæˆ

`src/app/schedules/[id]/page.tsx` ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

```typescript
import { prisma } from '@/lib/db';
import { auth } from '@/lib/auth';
import { notFound } from 'next/navigation';
import Link from 'next/link';
import { Calendar, MapPin, Users, Edit, Trash2 } from 'lucide-react';
import { CandidateVoteSection } from '@/components/CandidateVoteSection';

export default async function ScheduleDetailPage({
  params,
}: {
  params: { id: string };
}) {
  const session = await auth();

  // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å–å¾—
  const schedule = await prisma.schedule.findUnique({
    where: { id: params.id },
    include: {
      author: true,
      candidates: {
        include: {
          votes: {
            include: {
              user: {
                select: {
                  id: true,
                  name: true,
                  image: true,
                },
              },
            },
          },
          comments: {
            include: {
              user: {
                select: {
                  id: true,
                  name: true,
                  image: true,
                },
              },
            },
            orderBy: {
              createdAt: 'desc',
            },
          },
        },
        orderBy: {
          date: 'asc',
        },
      },
    },
  });

  if (!schedule) {
    notFound();
  }

  // ç·¨é›†ãƒ»å‰Šé™¤æ¨©é™
  const canEdit =
    session?.user?.id === schedule.authorId ||
    session?.user?.role === 'admin';

  // æœ€æœ‰åŠ›å€™è£œã‚’è¨ˆç®—
  const bestCandidate = schedule.candidates.reduce(
    (best: any, candidate: any) => {
      const availableCount = candidate.votes.filter(
        (v: any) => v.status === 'AVAILABLE'
      ).length;
      
      if (!best || availableCount > best.count) {
        return { candidate, count: availableCount };
      }
      return best;
    },
    null
  );

  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        {/* æˆ»ã‚‹ãƒªãƒ³ã‚¯ */}
        <Link
          href="/schedules"
          className="inline-flex items-center text-blue-600 hover:text-blue-700 mb-6"
        >
          â† ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§ã«æˆ»ã‚‹
        </Link>

        {/* ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚«ãƒ¼ãƒ‰ */}
        <article className="bg-white rounded-lg shadow-lg overflow-hidden mb-8">
          {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
          <div className="p-6 bg-gradient-to-r from-indigo-600 to-purple-600 text-white">
            <div className="flex justify-between items-start">
              <div>
                <h1 className="text-3xl font-bold mb-2">{schedule.title}</h1>
                {schedule.description && (
                  <p className="text-indigo-100 text-lg">
                    {schedule.description}
                  </p>
                )}
              </div>

              {/* ç·¨é›†ãƒ»å‰Šé™¤ãƒœã‚¿ãƒ³ */}
              {canEdit && (
                <div className="flex gap-2">
                  <Link
                    href={`/schedules/${schedule.id}/edit`}
                    className="px-3 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors flex items-center gap-1"
                  >
                    <Edit size={18} />
                    <span>ç·¨é›†</span>
                  </Link>
                </div>
              )}
            </div>
          </div>

          {/* å€™è£œæ—¥ä¸€è¦§ */}
          <div className="p-6">
            <h2 className="text-2xl font-bold text-gray-900 mb-6">
              å€™è£œæ—¥ã¨æŠ•ç¥¨çŠ¶æ³
            </h2>

            <div className="space-y-6">
              {schedule.candidates.map((candidate: any) => {
                // æœ€æœ‰åŠ›å€™è£œã‹ã©ã†ã‹
                const isBest =
                  bestCandidate?.candidate.id === candidate.id &&
                  bestCandidate.count > 0;

                return (
                  <CandidateVoteSection
                    key={candidate.id}
                    candidate={candidate}
                    currentUserId={session?.user?.id}
                    isAdmin={session?.user?.role === 'admin'}
                    isBest={isBest}
                  />
                );
              })}
            </div>
          </div>
        </article>
      </div>
    </div>
  );
}
```

### Step 3: å€™è£œæ—¥æŠ•ç¥¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆ

`src/components/CandidateVoteSection.tsx` ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

```typescript
'use client';

import { useState, useTransition } from 'react';
import { useRouter } from 'next/router';
import Image from 'next/image';
import { Calendar, MapPin, MessageCircle } from 'lucide-react';

interface CandidateVoteSectionProps {
  candidate: any;
  currentUserId?: string;
  isAdmin?: boolean;
  isBest?: boolean;
}

export function CandidateVoteSection({
  candidate,
  currentUserId,
  isAdmin,
  isBest,
}: CandidateVoteSectionProps) {
  const router = useRouter();
  const [isPending, startTransition] = useTransition();
  const [isVoting, setIsVoting] = useState(false);

  // æŠ•ç¥¨çŠ¶æ³ã®é›†è¨ˆ
  const availableVotes = candidate.votes.filter(
    (v: any) => v.status === 'AVAILABLE'
  );
  const maybeVotes = candidate.votes.filter((v: any) => v.status === 'MAYBE');
  const unavailableVotes = candidate.votes.filter(
    (v: any) => v.status === 'UNAVAILABLE'
  );

  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æŠ•ç¥¨çŠ¶æ…‹
  const userVote = currentUserId
    ? candidate.votes.find((v: any) => v.userId === currentUserId)
    : null;

  // æŠ•ç¥¨å‡¦ç†
  const handleVote = async (status: 'AVAILABLE' | 'MAYBE' | 'UNAVAILABLE') => {
    if (!currentUserId) {
      alert('ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™');
      return;
    }

    setIsVoting(true);

    try {
      const response = await fetch(
        `/api/schedules/candidates/${candidate.id}/vote`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ status }),
        }
      );

      if (!response.ok) {
        throw new Error('æŠ•ç¥¨ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }

      // ãƒšãƒ¼ã‚¸ã‚’å†æ¤œè¨¼
      startTransition(() => {
        router.refresh();
      });
    } catch (error) {
      alert('æŠ•ç¥¨ã«å¤±æ•—ã—ã¾ã—ãŸ');
    } finally {
      setIsVoting(false);
    }
  };

  return (
    <div
      className={`
        border-2 rounded-lg p-6
        ${isBest ? 'border-green-500 bg-green-50' : 'border-gray-200'}
      `}
    >
      {/* æ—¥æ™‚ã¨å ´æ‰€ */}
      <div className="mb-4">
        <div className="flex items-center gap-2 mb-2">
          <Calendar size={20} className="text-gray-600" />
          <span className="text-xl font-bold text-gray-900">
            {new Date(candidate.date).toLocaleDateString('ja-JP', {
              month: 'long',
              day: 'numeric',
              weekday: 'short',
              hour: '2-digit',
              minute: '2-digit',
            })}
          </span>
          {isBest && (
            <span className="px-3 py-1 bg-green-500 text-white text-sm font-bold rounded-full">
              â˜… æœ€æœ‰åŠ›å€™è£œ
            </span>
          )}
        </div>

        {candidate.location && (
          <div className="flex items-center gap-2 text-gray-600">
            <MapPin size={18} />
            <span>{candidate.location}</span>
          </div>
        )}
      </div>

      {/* æŠ•ç¥¨ãƒœã‚¿ãƒ³ */}
      {currentUserId && (
        <div className="mb-6">
          <p className="text-sm font-medium text-gray-700 mb-3">
            ã‚ãªãŸã®å‚åŠ çŠ¶æ³:
          </p>
          <div className="flex gap-3">
            {/* â—¯ å‚åŠ å¯èƒ½ */}
            <button
              onClick={() => handleVote('AVAILABLE')}
              disabled={isVoting || isPending}
              className={`
                flex-1 px-4 py-3 rounded-lg font-semibold transition-all
                ${
                  userVote?.status === 'AVAILABLE'
                    ? 'bg-green-500 text-white ring-4 ring-green-200'
                    : 'bg-white border-2 border-gray-300 text-gray-700 hover:border-green-500 hover:bg-green-50'
                }
                disabled:opacity-50 disabled:cursor-not-allowed
              `}
            >
              <span className="text-2xl mb-1">â—¯</span>
              <div className="text-sm">å‚åŠ å¯èƒ½</div>
            </button>

            {/* â–³ æœªå®š */}
            <button
              onClick={() => handleVote('MAYBE')}
              disabled={isVoting || isPending}
              className={`
                flex-1 px-4 py-3 rounded-lg font-semibold transition-all
                ${
                  userVote?.status === 'MAYBE'
                    ? 'bg-yellow-500 text-white ring-4 ring-yellow-200'
                    : 'bg-white border-2 border-gray-300 text-gray-700 hover:border-yellow-500 hover:bg-yellow-50'
                }
                disabled:opacity-50 disabled:cursor-not-allowed
              `}
            >
              <span className="text-2xl mb-1">â–³</span>
              <div className="text-sm">æœªå®š</div>
            </button>

            {/* âœ• å‚åŠ ä¸å¯ */}
            <button
              onClick={() => handleVote('UNAVAILABLE')}
              disabled={isVoting || isPending}
              className={`
                flex-1 px-4 py-3 rounded-lg font-semibold transition-all
                ${
                  userVote?.status === 'UNAVAILABLE'
                    ? 'bg-red-500 text-white ring-4 ring-red-200'
                    : 'bg-white border-2 border-gray-300 text-gray-700 hover:border-red-500 hover:bg-red-50'
                }
                disabled:opacity-50 disabled:cursor-not-allowed
              `}
            >
              <span className="text-2xl mb-1">âœ•</span>
              <div className="text-sm">å‚åŠ ä¸å¯</div>
            </button>
          </div>
        </div>
      )}

      {/* æŠ•ç¥¨çŠ¶æ³ã‚µãƒãƒªãƒ¼ */}
      <div className="mb-6 p-4 bg-gray-50 rounded-lg">
        <div className="grid grid-cols-3 gap-4 text-center">
          <div>
            <div className="text-3xl font-bold text-green-600">
              {availableVotes.length}
            </div>
            <div className="text-sm text-gray-600">â—¯ å‚åŠ å¯èƒ½</div>
          </div>
          <div>
            <div className="text-3xl font-bold text-yellow-600">
              {maybeVotes.length}
            </div>
            <div className="text-sm text-gray-600">â–³ æœªå®š</div>
          </div>
          <div>
            <div className="text-3xl font-bold text-red-600">
              {unavailableVotes.length}
            </div>
            <div className="text-sm text-gray-600">âœ• å‚åŠ ä¸å¯</div>
          </div>
        </div>
      </div>

      {/* å‚åŠ å¯èƒ½ãªäººä¸€è¦§ */}
      {availableVotes.length > 0 && (
        <div className="mb-4">
          <h4 className="text-sm font-semibold text-gray-700 mb-2">
            â—¯ å‚åŠ å¯èƒ½ãªäºº ({availableVotes.length}å)
          </h4>
          <div className="flex flex-wrap gap-2">
            {availableVotes.map((vote: any) => (
              <div
                key={vote.id}
                className="flex items-center gap-2 px-3 py-1 bg-green-100 rounded-full"
              >
                {vote.user.image ? (
                  <Image
                    src={vote.user.image}
                    alt={vote.user.name || ''}
                    width={20}
                    height={20}
                    className="rounded-full"
                  />
                ) : (
                  <div className="w-5 h-5 rounded-full bg-green-600 flex items-center justify-center text-white text-xs">
                    {vote.user.name?.charAt(0) || 'U'}
                  </div>
                )}
                <span className="text-sm text-green-900">
                  {vote.user.name}
                </span>
              </div>
            ))}
          </div>
        </div>
      )}

      {/* ã‚³ãƒ¡ãƒ³ãƒˆæ•° */}
      {candidate.comments.length > 0 && (
        <div className="flex items-center gap-2 text-gray-600">
          <MessageCircle size={18} />
          <span className="text-sm">
            ã‚³ãƒ¡ãƒ³ãƒˆ {candidate.comments.length}ä»¶
          </span>
        </div>
      )}
    </div>
  );
}
```

**CandidateVoteSectionã®ç‰¹å¾´:**

1. âœ… **3æ®µéšæŠ•ç¥¨ãƒœã‚¿ãƒ³**: â—¯/â–³/âœ• ã®å¤§ããªãƒœã‚¿ãƒ³
2. âœ… **é¸æŠçŠ¶æ…‹ã®è¦–è¦šåŒ–**: ãƒªãƒ³ã‚°åŠ¹æœã§ç¾åœ¨ã®é¸æŠã‚’å¼·èª¿
3. âœ… **æŠ•ç¥¨çŠ¶æ³ã®é›†è¨ˆ**: å„æ®µéšã®äººæ•°ã‚’è¡¨ç¤º
4. âœ… **å‚åŠ å¯èƒ½ãªäººä¸€è¦§**: ã‚¢ãƒã‚¿ãƒ¼ä»˜ãã§è¡¨ç¤º
5. âœ… **æœ€æœ‰åŠ›å€™è£œ**: ç·‘ã®èƒŒæ™¯ã¨â˜…ãƒãƒ¼ã‚¯

### Step 4: å‹•ä½œç¢ºèª

**4-1.** ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è©³ç´°ãƒšãƒ¼ã‚¸ã‚’é–‹ã

**4-2.** å€™è£œæ—¥ã®ã€Œâ—¯ å‚åŠ å¯èƒ½ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

â†’ âœ… ãƒœã‚¿ãƒ³ãŒå¼·èª¿è¡¨ç¤ºã•ã‚Œã€å‚åŠ å¯èƒ½ãªäººä¸€è¦§ã«è¿½åŠ ã•ã‚Œã‚‹ï¼

**4-3.** ã€Œâ–³ æœªå®šã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

â†’ âœ… æŠ•ç¥¨ãŒâ—¯â†’â–³ã«æ›´æ–°ã•ã‚Œã‚‹ï¼

**4-4.** ã‚‚ã†ä¸€åº¦ã€Œâ–³ æœªå®šã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

â†’ âœ… æŠ•ç¥¨ãŒå–ã‚Šæ¶ˆã•ã‚Œã‚‹ï¼

---

## 16.5 ç¢ºèªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

Chapter 16ã®å†…å®¹ã‚’ç†è§£ã§ããŸã‹ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

### ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

- [ ] Scheduleã€ScheduleCandidateã€ScheduleVoteãƒ¢ãƒ‡ãƒ«ã®æ§‹é€ ã‚’ç†è§£ã—ãŸ
- [ ] VoteStatus Enumã®3æ®µéšã‚’ç†è§£ã—ãŸ
- [ ] @@uniqueåˆ¶ç´„ã‚’ç†è§£ã—ãŸ
- [ ] ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨onDelete: Cascadeã‚’ç†è§£ã—ãŸ

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§

- [ ] ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§ãƒšãƒ¼ã‚¸ã‚’å®Ÿè£…ã§ãã‚‹
- [ ] å€™è£œæ—¥ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤ºã§ãã‚‹
- [ ] æœ€æœ‰åŠ›å€™è£œã‚’è¨ˆç®—ã—ã¦è¡¨ç¤ºã§ãã‚‹
- [ ] è‡ªåˆ†ã®æŠ•ç¥¨çŠ¶æ…‹ã‚’è¡¨ç¤ºã§ãã‚‹

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆ

- [ ] ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆAPIã‚’å®Ÿè£…ã§ãã‚‹
- [ ] å‹•çš„ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆå€™è£œæ—¥ã®è¿½åŠ ãƒ»å‰Šé™¤ï¼‰ã‚’å®Ÿè£…ã§ãã‚‹
- [ ] è¤‡æ•°å€™è£œæ—¥ã®ä¸€æ‹¬ä½œæˆãŒã§ãã‚‹
- [ ] ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã§ãã‚‹

### æŠ•ç¥¨æ©Ÿèƒ½

- [ ] 3æ®µéšæŠ•ç¥¨APIã‚’å®Ÿè£…ã§ãã‚‹
- [ ] æŠ•ç¥¨ã®ä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç†è§£ã—ãŸ
- [ ] æŠ•ç¥¨ãƒœã‚¿ãƒ³UIã‚’å®Ÿè£…ã§ãã‚‹
- [ ] é¸æŠçŠ¶æ…‹ã®è¦–è¦šåŒ–ãŒã§ãã‚‹
- [ ] æŠ•ç¥¨çŠ¶æ³ã®é›†è¨ˆãŒã§ãã‚‹

### æœ€æœ‰åŠ›å€™è£œ

- [ ] å‚åŠ å¯èƒ½äººæ•°ã«ã‚ˆã‚‹æœ€æœ‰åŠ›å€™è£œã®é¸å‡ºãŒã§ãã‚‹
- [ ] æœ€æœ‰åŠ›å€™è£œã®ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤ºãŒã§ãã‚‹

---

## ã¾ã¨ã‚

ã“ã®ç« ã§ã¯ã€è¤‡é›‘ãªã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«èª¿æ•´æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

### ğŸ“ ã“ã®ç« ã§å­¦ã‚“ã ã“ã¨

#### ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ
- âœ… 3ã¤ã®ãƒ¢ãƒ‡ãƒ«ã®é–¢é€£ï¼ˆSchedule â†’ Candidate â†’ Voteï¼‰
- âœ… Enumå‹ã®æ´»ç”¨ï¼ˆVoteStatusï¼‰
- âœ… @@uniqueåˆ¶ç´„ã«ã‚ˆã‚‹é‡è¤‡é˜²æ­¢
- âœ… onDelete: Cascadeã«ã‚ˆã‚‹é€£é–å‰Šé™¤

#### è¤‡æ•°å€™è£œæ—¥ç®¡ç†
- âœ… å‹•çš„ãƒ•ã‚©ãƒ¼ãƒ ã§ã®å€™è£œæ—¥è¿½åŠ ãƒ»å‰Šé™¤
- âœ… ä¸€æ‹¬ä½œæˆï¼ˆcreate with nested dataï¼‰
- âœ… å€™è£œæ—¥ã”ã¨ã®æŠ•ç¥¨ç®¡ç†

#### 3æ®µéšæŠ•ç¥¨ã‚·ã‚¹ãƒ†ãƒ 
- âœ… â—¯/â–³/âœ• ã®3æ®µéšæŠ•ç¥¨
- âœ… æŠ•ç¥¨ã®ä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤ãƒ­ã‚¸ãƒƒã‚¯
- âœ… åŒã˜ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã§æŠ•ç¥¨å–ã‚Šæ¶ˆã—
- âœ… æ¥½è¦³çš„UIã«ã‚ˆã‚‹å³åº§ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

#### é›†è¨ˆã¨å¯è¦–åŒ–
- âœ… æŠ•ç¥¨çŠ¶æ³ã®é›†è¨ˆ
- âœ… æœ€æœ‰åŠ›å€™è£œã®è‡ªå‹•é¸å‡º
- âœ… å‚åŠ å¯èƒ½ãªäººä¸€è¦§ã®è¡¨ç¤º
- âœ… è¦–è¦šçš„ãªå¼·èª¿è¡¨ç¤º

### ğŸ’¡ é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

#### æŠ•ç¥¨ã®ãƒˆã‚°ãƒ«ãƒ­ã‚¸ãƒƒã‚¯

```typescript
if (existingVote) {
  if (existingVote.status === status) {
    // åŒã˜çŠ¶æ…‹ â†’ å‰Šé™¤ï¼ˆå–ã‚Šæ¶ˆã—ï¼‰
    await prisma.vote.delete(...);
  } else {
    // ç•°ãªã‚‹çŠ¶æ…‹ â†’ æ›´æ–°
    await prisma.vote.update(...);
  }
} else {
  // æ–°è¦ä½œæˆ
  await prisma.vote.create(...);
}
```

#### æœ€æœ‰åŠ›å€™è£œã®è¨ˆç®—

```typescript
const bestCandidate = candidates.reduce((best, candidate) => {
  const count = candidate.votes.filter(
    v => v.status === 'AVAILABLE'
  ).length;
  
  return (!best || count > best.count)
    ? { candidate, count }
    : best;
}, null);
```

### ğŸš€ æ¬¡ã®ç« ã¸ã®æº–å‚™

æ¬¡ã®ç« ï¼ˆChapter 17: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã¨ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ï¼‰ã§ã¯ã€ä»¥ä¸‹ã‚’å­¦ã³ã¾ã™ï¼š

1. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§**
   - å…¨ãƒ¡ãƒ³ãƒãƒ¼ã®è¡¨ç¤º
   - å½¹å‰²ã®è¡¨ç¤º

2. **ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†**
   - ã‚¢ãƒã‚¿ãƒ¼ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
   - è‡ªå·±ç´¹ä»‹ã®ç·¨é›†
   - æ‹…å½“æ¥½å™¨ã®è¨­å®š

3. **ç®¡ç†è€…æ©Ÿèƒ½**
   - å½¹å‰²ã®å¤‰æ›´
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†

**æº–å‚™ã™ã‚‹ã“ã¨:**
- âœ… ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- âœ… æŠ•ç¥¨æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- âœ… æœ€æœ‰åŠ›å€™è£œãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

---

[â† å‰ã®ç« ï¼šç¬¬15ç«  ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†æ©Ÿèƒ½ã®å®Ÿè£…](15-ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†æ©Ÿèƒ½ã®å®Ÿè£….md) | [ç›®æ¬¡ã«æˆ»ã‚‹](00-ç›®æ¬¡.md) | [æ¬¡ã®ç« ã¸ï¼šç¬¬17ç«  ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã¨ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« â†’](17-ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã¨ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«.md)
