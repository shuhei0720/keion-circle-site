# ç¬¬ 9 ç« ï¼šãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆã®ç†è§£

> **ã“ã®ç« ã§ã¯ã€ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹é€ ã‚’å®Œå…¨ã«ç†è§£ã—ã¾ã™**

å‰ç« ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã—ãŸã€‚ã“ã®ç« ã§ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²ã‚’ 1 ã¤ãšã¤ç¢ºèªã—ã¦ã„ãã¾ã™ã€‚

## ğŸ“š ã“ã®ç« ã§å­¦ã¶ã“ã¨

- âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å…¨ä½“æ§‹é€ 
- âœ… å„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å½¹å‰²ã¨ä½¿ã„æ–¹
- âœ… é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹
- âœ… Next.js App Router ã®ä»•çµ„ã¿
- âœ… ãƒ•ã‚¡ã‚¤ãƒ«ã®å‘½åè¦å‰‡ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

---

## 9.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®å…¨ä½“åƒ

ã¾ãšã€VSCode ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ã„ã¦ã€å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

### ğŸ”§ Step 1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ VSCode ã§é–‹ã

**ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œï¼š**

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd keion-circle-site

# VSCodeã§é–‹ã
code .
```

VSCode ã®å·¦å´ã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ã«ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹é€ ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

```
keion-circle-site/
â”œâ”€â”€ ğŸ“ .git/                    # Gitãƒªãƒã‚¸ãƒˆãƒªï¼ˆè¡¨ç¤ºã•ã‚Œãªã„å ´åˆã‚ã‚Šï¼‰
â”œâ”€â”€ ğŸ“ .next/                   # Next.jsãƒ“ãƒ«ãƒ‰çµæœï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
â”œâ”€â”€ ğŸ“ node_modules/            # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
â”œâ”€â”€ ğŸ“ prisma/                  # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£ â­
â”‚   â”œâ”€â”€ schema.prisma           # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
â”‚   â””â”€â”€ migrations/             # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆæœ¬ç•ªç’°å¢ƒç”¨ï¼‰
â”œâ”€â”€ ğŸ“ public/                  # é™çš„ãƒ•ã‚¡ã‚¤ãƒ« â­
â”‚   â””â”€â”€ favicon.ico             # ãƒ•ã‚¡ãƒ“ã‚³ãƒ³
â”œâ”€â”€ ğŸ“ scripts/                 # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â””â”€â”€ create-admin.js         # ç®¡ç†è€…ä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ ğŸ“ src/                     # ãƒ¡ã‚¤ãƒ³ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ â­â­â­
â”‚   â”œâ”€â”€ ğŸ“ app/                 # Next.js App Routerï¼ˆãƒšãƒ¼ã‚¸ã¨APIï¼‰
â”‚   â”‚   â”œâ”€â”€ layout.tsx          # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”‚   â”œâ”€â”€ page.tsx            # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ globals.css         # ã‚°ãƒ­ãƒ¼ãƒãƒ«CSS
â”‚   â”‚   â””â”€â”€ ...                 # ãã®ä»–ã®ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ ğŸ“ components/          # å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ ...                 # å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â””â”€â”€ ğŸ“ lib/                 # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
â”‚       â”œâ”€â”€ auth.ts             # èªè¨¼è¨­å®š
â”‚       â”œâ”€â”€ db.ts               # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
â”‚       â””â”€â”€ supabase.ts         # Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”œâ”€â”€ .env.local                  # ç’°å¢ƒå¤‰æ•°ï¼ˆæ©Ÿå¯†æƒ…å ±ï¼‰ â­
â”œâ”€â”€ .eslintrc.json              # ESLintè¨­å®š
â”œâ”€â”€ .gitignore                  # Gité™¤å¤–è¨­å®š
â”œâ”€â”€ next.config.ts              # Next.jsè¨­å®š
â”œâ”€â”€ package.json                # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æƒ…å ±
â”œâ”€â”€ README.md                   # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆèª¬æ˜
â”œâ”€â”€ tailwind.config.ts          # Tailwind CSSè¨­å®š
â””â”€â”€ tsconfig.json               # TypeScriptè¨­å®š
```

### ğŸ“Š ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®é‡è¦åº¦

| ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª      | é‡è¦åº¦ | ã‚ˆãè§¦ã‚‹åº¦ | èª¬æ˜                    |
| ----------------- | ------ | ---------- | ----------------------- |
| `src/app/`        | â­â­â­ | ğŸ”¥ğŸ”¥ğŸ”¥     | ãƒšãƒ¼ã‚¸ã¨ API ã‚’ä½œã‚‹å ´æ‰€ |
| `src/components/` | â­â­â­ | ğŸ”¥ğŸ”¥ğŸ”¥     | å…±é€šéƒ¨å“ã‚’ä½œã‚‹å ´æ‰€      |
| `src/lib/`        | â­â­   | ğŸ”¥ğŸ”¥       | ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°      |
| `prisma/`         | â­â­   | ğŸ”¥         | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ        |
| `public/`         | â­     | ğŸ”¥         | ç”»åƒãªã©ã®é™çš„ãƒ•ã‚¡ã‚¤ãƒ«  |
| `.env.local`      | â­â­   | ğŸ”¥         | ç’°å¢ƒå¤‰æ•°ï¼ˆAPI ã‚­ãƒ¼ç­‰ï¼‰  |
| è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç¾¤    | â­     | â–³          | åŸºæœ¬çš„ã«å¤‰æ›´ä¸è¦        |

### ğŸ¯ é–‹ç™ºã§ä¸»ã«ä½œæ¥­ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

åˆå¿ƒè€…ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é€²ã‚ã‚‹éš›ã«ã€ä¸»ã«ä½œæ¥­ã™ã‚‹ã®ã¯ä»¥ä¸‹ã® 3 ã¤ã§ã™ï¼š

```
src/
â”œâ”€â”€ app/          â† ãƒšãƒ¼ã‚¸ã¨APIãƒ«ãƒ¼ãƒˆï¼ˆæœ€ã‚‚é‡è¦ï¼ï¼‰
â”œâ”€â”€ components/   â† å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â””â”€â”€ lib/          â† ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
```

---

## 9.2 å„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®è©³ç´°

ãã‚Œã§ã¯ã€å„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å½¹å‰²ã‚’ 1 ã¤ãšã¤è©³ã—ãè¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

### ğŸ“‚ `prisma/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

**å½¹å‰²ï¼š** ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®è¨­è¨ˆå›³ï¼ˆã‚¹ã‚­ãƒ¼ãƒï¼‰ã‚’å®šç¾©ã™ã‚‹å ´æ‰€

```
prisma/
â”œâ”€â”€ schema.prisma    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
â””â”€â”€ migrations/      # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆæœ¬ç•ªç’°å¢ƒç”¨ï¼‰
```

#### `schema.prisma`ã®å½¹å‰²

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã‚’å®šç¾©ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚Chapter 8 ã§ä½œæˆã—ã¾ã—ãŸã€‚

**å®Ÿéš›ã«é–‹ã„ã¦ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š**

1. VSCode ã§`prisma/schema.prisma`ã‚’é–‹ã
2. ä»¥ä¸‹ã®ã‚ˆã†ãªå†…å®¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

```prisma
// ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®è¨­å®š
datasource db {
  provider = "postgresql"          // PostgreSQL (Supabase)
  url      = env("DATABASE_URL")   // ç’°å¢ƒå¤‰æ•°ã‹ã‚‰æ¥ç¶šå…ˆã‚’å–å¾—
}

// Prisma Clientã®ç”Ÿæˆè¨­å®š
generator client {
  provider = "prisma-client-js"
}

// Userãƒ¢ãƒ‡ãƒ«ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
model User {
  id            String    @id @default(cuid())
  name          String?
  email         String    @unique
  emailVerified DateTime?
  image         String?
  password      String?
  role          Role      @default(member)
  bio           String?
  instrument    String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆä»–ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã®é–¢ä¿‚ï¼‰
  accounts      Account[]
  sessions      Session[]
  posts         Post[]
  likes         Like[]
  comments      Comment[]
  // ...ä»–ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
}

// å½¹å‰²ï¼ˆEnumï¼‰
enum Role {
  admin   // ç®¡ç†è€…
  member  // ä¸€èˆ¬ãƒ¡ãƒ³ãƒãƒ¼
}

// ...ä»–ã®ãƒ¢ãƒ‡ãƒ«ï¼ˆPost, Event, Scheduleç­‰ï¼‰
```

**ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ç‰¹å¾´ï¼š**

- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
- ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆé–¢ä¿‚æ€§ï¼‰ã‚‚æ˜ç¢ºã«è¨˜è¿°ã•ã‚Œã¦ã„ã‚‹
- ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´ã—ãŸã‚‰`npx prisma db push`ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åæ˜ 

---

### ğŸ“‚ `public/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

**å½¹å‰²ï¼š** é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆç”»åƒã€ãƒ•ã‚©ãƒ³ãƒˆã€ã‚¢ã‚¤ã‚³ãƒ³ç­‰ï¼‰ã‚’é…ç½®ã™ã‚‹å ´æ‰€

```
public/
â””â”€â”€ favicon.ico      # ãƒ–ãƒ©ã‚¦ã‚¶ã‚¿ãƒ–ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚¢ã‚¤ã‚³ãƒ³
```

#### é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®æ‰±ã„æ–¹

**`public/`å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ãƒ«ãƒ¼ãƒˆ`/`ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ï¼š**

```tsx
// ä¾‹ï¼špublic/logo.pngã‚’ä½¿ã„ãŸã„å ´åˆ
<Image src="/logo.png" alt="ãƒ­ã‚´" width={100} height={100} />
```

**å®Ÿè·µä¾‹ï¼š**

1. `public/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«ç”»åƒã‚’é…ç½®
2. ã‚³ãƒ¼ãƒ‰å†…ã§`/ãƒ•ã‚¡ã‚¤ãƒ«å`ã§ã‚¢ã‚¯ã‚»ã‚¹

```tsx
// public/images/banner.jpg ã‚’ä½¿ç”¨
<Image src="/images/banner.jpg" alt="ãƒãƒŠãƒ¼" width={800} height={400} />
```

**ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ï¼š**

- ç”»åƒã¯`public/images/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ•´ç†
- ãƒ•ã‚©ãƒ³ãƒˆã¯`public/fonts/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ•´ç†
- ãƒ•ã‚¡ã‚¤ãƒ«åã¯å°æ–‡å­—ã¨ãƒã‚¤ãƒ•ãƒ³ã‚’ä½¿ç”¨ï¼ˆä¾‹ï¼š`banner-image.jpg`ï¼‰

---

### ğŸ“‚ `scripts/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

**å½¹å‰²ï¼š** é–‹ç™ºã‚„ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã§ä½¿ã†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```
scripts/
â””â”€â”€ create-admin.js     # ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```

#### `create-admin.js`ã®ä½¿ã„æ–¹

ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç°¡å˜ã«ä½œæˆã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚

**ä½¿ç”¨ä¾‹ï¼š**

```bash
node scripts/create-admin.js admin@example.com password123 "ç®¡ç†è€…å"
```

**ä¸­èº«ã‚’ç¢ºèªï¼š**

```javascript
// scripts/create-admin.js
const { PrismaClient } = require("@prisma/client");
const bcrypt = require("bcryptjs");

const prisma = new PrismaClient();

async function main() {
  const email = process.argv[2];
  const password = process.argv[3];
  const name = process.argv[4];

  // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒãƒƒã‚·ãƒ¥åŒ–
  const hashedPassword = await bcrypt.hash(password, 10);

  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆ
  const user = await prisma.user.create({
    data: {
      email,
      password: hashedPassword,
      name,
      role: "admin", // ç®¡ç†è€…ã¨ã—ã¦ä½œæˆ
    },
  });

  console.log("ç®¡ç†è€…ã‚’ä½œæˆã—ã¾ã—ãŸ:", user);
}

main()
  .catch((e) => console.error(e))
  .finally(() => prisma.$disconnect());
```

**ç‹¬è‡ªã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š**

- ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒªã‚»ãƒƒãƒˆ

---

### ğŸ“‚ `src/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

**å½¹å‰²ï¼š** ãƒ¡ã‚¤ãƒ³ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã€‚ã™ã¹ã¦ã® TypeScript ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã“ã“ã«é…ç½®

```
src/
â”œâ”€â”€ app/            # Next.js App Routerï¼ˆãƒšãƒ¼ã‚¸ã¨APIï¼‰
â”œâ”€â”€ components/     # å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â””â”€â”€ lib/            # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
```

ã“ã®ä¸­ã®å„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¤ã„ã¦ã€ã•ã‚‰ã«è©³ã—ãè¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

---

## 9.3 `src/app/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆæœ€é‡è¦ï¼ï¼‰

**å½¹å‰²ï¼š** Next.js App Router ã®ä¸­å¿ƒã€‚ãƒšãƒ¼ã‚¸ã¨ API ãƒ«ãƒ¼ãƒˆã‚’å®šç¾©ã™ã‚‹å ´æ‰€

### App Router ã®åŸºæœ¬æ¦‚å¿µ

Next.js 13 ä»¥é™ã®**App Router**ã§ã¯ã€**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãŒãã®ã¾ã¾ URL ã«ãªã‚Šã¾ã™**ã€‚

```
src/app/
â”œâ”€â”€ page.tsx              â†’ /ï¼ˆãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ï¼‰
â”œâ”€â”€ layout.tsx            â†’ å…¨ãƒšãƒ¼ã‚¸å…±é€šã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”œâ”€â”€ globals.css           â†’ ã‚°ãƒ­ãƒ¼ãƒãƒ«CSS
â”œâ”€â”€ ğŸ“ posts/
â”‚   â”œâ”€â”€ page.tsx          â†’ /postsï¼ˆæŠ•ç¨¿ä¸€è¦§ï¼‰
â”‚   â””â”€â”€ ğŸ“ [id]/
â”‚       â””â”€â”€ page.tsx      â†’ /posts/123ï¼ˆæŠ•ç¨¿è©³ç´°ï¼‰
â”œâ”€â”€ ğŸ“ events/
â”‚   â””â”€â”€ page.tsx          â†’ /eventsï¼ˆã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ï¼‰
â”œâ”€â”€ ğŸ“ schedules/
â”‚   â””â”€â”€ page.tsx          â†’ /schedulesï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§ï¼‰
â”œâ”€â”€ ğŸ“ users/
â”‚   â””â”€â”€ page.tsx          â†’ /usersï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ï¼‰
â”œâ”€â”€ ğŸ“ profile/
â”‚   â””â”€â”€ page.tsx          â†’ /profileï¼ˆãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ï¼‰
â”œâ”€â”€ ğŸ“ auth/
â”‚   â”œâ”€â”€ ğŸ“ signin/
â”‚   â”‚   â””â”€â”€ page.tsx      â†’ /auth/signinï¼ˆãƒ­ã‚°ã‚¤ãƒ³ï¼‰
â”‚   â””â”€â”€ ğŸ“ signup/
â”‚       â””â”€â”€ page.tsx      â†’ /auth/signupï¼ˆã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ï¼‰
â””â”€â”€ ğŸ“ api/               # APIãƒ«ãƒ¼ãƒˆ
    â”œâ”€â”€ ğŸ“ posts/
    â”‚   â”œâ”€â”€ route.ts      â†’ /api/postsï¼ˆæŠ•ç¨¿APIï¼‰
    â”‚   â””â”€â”€ ğŸ“ [id]/
    â”‚       â””â”€â”€ route.ts  â†’ /api/posts/123ï¼ˆæŠ•ç¨¿è©³ç´°APIï¼‰
    â””â”€â”€ ğŸ“ users/
        â””â”€â”€ route.ts      â†’ /api/usersï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼APIï¼‰
```

### ãƒ•ã‚¡ã‚¤ãƒ«åã®æ„å‘³

| ãƒ•ã‚¡ã‚¤ãƒ«å      | å½¹å‰²                     | ä¾‹                                      |
| --------------- | ------------------------ | --------------------------------------- |
| `page.tsx`      | ãƒšãƒ¼ã‚¸ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ   | `/posts` â†’ `app/posts/page.tsx`         |
| `layout.tsx`    | ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | å…¨ãƒšãƒ¼ã‚¸å…±é€š                            |
| `route.ts`      | API ãƒ«ãƒ¼ãƒˆ               | `/api/posts` â†’ `app/api/posts/route.ts` |
| `loading.tsx`   | ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹         | ãƒ‡ãƒ¼ã‚¿å–å¾—ä¸­ã«è¡¨ç¤º                      |
| `error.tsx`     | ã‚¨ãƒ©ãƒ¼è¡¨ç¤º               | ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã«è¡¨ç¤º                      |
| `not-found.tsx` | 404 ãƒšãƒ¼ã‚¸               | ãƒšãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã¨ã                |
| `[id]`          | å‹•çš„ãƒ«ãƒ¼ãƒˆ               | `[id]`ã¯ä»»æ„ã®å€¤                        |

### å®Ÿéš›ã«ç¢ºèªã—ã¦ã¿ã‚ˆã†

**Step 1: ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã‚’é–‹ã**

`src/app/page.tsx`ã‚’é–‹ã„ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```tsx
// src/app/page.tsx
export default function Home() {
  return (
    <main className="min-h-screen flex items-center justify-center">
      <div className="text-center">
        <h1 className="text-4xl font-bold">ğŸ¸ BOLD è»½éŸ³ãƒ¡ãƒ³ãƒãƒ¼ã‚µã‚¤ãƒˆ</h1>
        <p className="mt-4 text-gray-600">
          ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã—ãŸï¼
        </p>
      </div>
    </main>
  );
}
```

**ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒ`http://localhost:3000/`ï¼ˆãƒ«ãƒ¼ãƒˆï¼‰ã«å¯¾å¿œã—ã¾ã™ã€‚**

**Step 2: é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã§ç¢ºèª**

```bash
npm run dev
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§`http://localhost:3000`ã‚’é–‹ã„ã¦ã€å®Ÿéš›ã«è¡¨ç¤ºã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

**Step 3: ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’é–‹ã**

`src/app/layout.tsx`ã‚’é–‹ã„ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```tsx
// src/app/layout.tsx
import type { Metadata } from "next";
import "./globals.css";

// ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆSEOå¯¾ç­–ï¼‰
export const metadata: Metadata = {
  title: "BOLDè»½éŸ³ãƒ¡ãƒ³ãƒãƒ¼ã‚µã‚¤ãƒˆ",
  description: "ã‚µãƒ¼ã‚¯ãƒ«ãƒ¡ãƒ³ãƒãƒ¼å°‚ç”¨ã®Webã‚µã‚¤ãƒˆ",
};

// ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆå…¨ãƒšãƒ¼ã‚¸å…±é€šï¼‰
export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="ja">
      <body>
        {/* ã“ã“ã«å…¨ãƒšãƒ¼ã‚¸å…±é€šã®è¦ç´ ï¼ˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ç­‰ï¼‰ã‚’é…ç½® */}
        {children} {/* å„ãƒšãƒ¼ã‚¸ã®å†…å®¹ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ */}
      </body>
    </html>
  );
}
```

**ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²ï¼š**

- ã™ã¹ã¦ã®ãƒšãƒ¼ã‚¸ã§å…±é€šã® HTML æ§‹é€ ã‚’å®šç¾©
- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜æ–‡ï¼‰ã‚’è¨­å®š
- å…¨ãƒšãƒ¼ã‚¸ã§å…±é€šã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ç­‰ã‚’é…ç½®

### å‹•çš„ãƒ«ãƒ¼ãƒˆã®ç†è§£

`[id]`ã®ã‚ˆã†ãª`[]`ã§å›²ã¾ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯**å‹•çš„ãƒ«ãƒ¼ãƒˆ**ã¨å‘¼ã°ã‚Œã¾ã™ã€‚

**ä¾‹ï¼šæŠ•ç¨¿è©³ç´°ãƒšãƒ¼ã‚¸**

```
src/app/posts/[id]/page.tsx  â†’ /posts/ä»»æ„ã®å€¤
```

**ã‚¢ã‚¯ã‚»ã‚¹ä¾‹ï¼š**

- `/posts/abc123` â†’ `id = "abc123"`
- `/posts/xyz789` â†’ `id = "xyz789"`

**ã‚³ãƒ¼ãƒ‰å†…ã§`id`ã‚’å–å¾—ï¼š**

```tsx
// src/app/posts/[id]/page.tsx
export default function PostDetailPage({ params }: { params: { id: string } }) {
  // URLã®idã‚’å–å¾—
  const postId = params.id;

  return (
    <div>
      <h1>æŠ•ç¨¿ID: {postId}</h1>
    </div>
  );
}
```

### API ãƒ«ãƒ¼ãƒˆã®ç†è§£

`src/app/api/`ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€**API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**ã«ãªã‚Šã¾ã™ã€‚

**ä¾‹ï¼šæŠ•ç¨¿ä¸€è¦§ API**

```typescript
// src/app/api/posts/route.ts
import { NextResponse } from "next/server";
import { prisma } from "@/lib/db";

// GET /api/posts
export async function GET() {
  const posts = await prisma.post.findMany({
    include: {
      author: true, // æŠ•ç¨¿è€…æƒ…å ±ã‚‚å–å¾—
    },
    orderBy: {
      createdAt: "desc", // æ–°ã—ã„é †
    },
  });

  return NextResponse.json(posts);
}

// POST /api/posts
export async function POST(request: Request) {
  const body = await request.json();

  const post = await prisma.post.create({
    data: {
      title: body.title,
      content: body.content,
      authorId: body.authorId,
    },
  });

  return NextResponse.json(post);
}
```

**ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒ`http://localhost:3000/api/posts`ã«å¯¾å¿œã—ã¾ã™ã€‚**

**å‹•ä½œç¢ºèªï¼š**

```bash
# ãƒ–ãƒ©ã‚¦ã‚¶ã¾ãŸã¯ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ç¢ºèª
curl http://localhost:3000/api/posts
```

---

## 9.4 `src/components/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

**å½¹å‰²ï¼š** è¤‡æ•°ã®ãƒšãƒ¼ã‚¸ã§å†åˆ©ç”¨ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’é…ç½®

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã¯ï¼Ÿ

UI ã®éƒ¨å“ï¼ˆãƒœã‚¿ãƒ³ã€ã‚«ãƒ¼ãƒ‰ã€ãƒ•ã‚©ãƒ¼ãƒ ç­‰ï¼‰ã‚’å†åˆ©ç”¨å¯èƒ½ãªå½¢ã§å®šç¾©ã—ãŸã‚‚ã®ã§ã™ã€‚

**ä¾‹ï¼šãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**

```tsx
// src/components/Button.tsx
interface ButtonProps {
  children: React.ReactNode;
  onClick?: () => void;
  variant?: "primary" | "secondary";
}

export function Button({
  children,
  onClick,
  variant = "primary",
}: ButtonProps) {
  const baseStyle = "px-4 py-2 rounded font-semibold";
  const variantStyle =
    variant === "primary"
      ? "bg-blue-600 text-white hover:bg-blue-700"
      : "bg-gray-200 text-gray-800 hover:bg-gray-300";

  return (
    <button onClick={onClick} className={`${baseStyle} ${variantStyle}`}>
      {children}
    </button>
  );
}
```

**ä½¿ã„æ–¹ï¼š**

```tsx
// src/app/page.tsx
import { Button } from "@/components/Button";

export default function Home() {
  return (
    <div>
      <Button variant="primary">ä¿å­˜</Button>
      <Button variant="secondary">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</Button>
    </div>
  );
}
```

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®é…ç½®ä¾‹

```
src/components/
â”œâ”€â”€ Button.tsx              # ãƒœã‚¿ãƒ³
â”œâ”€â”€ Card.tsx                # ã‚«ãƒ¼ãƒ‰
â”œâ”€â”€ Navigation.tsx          # ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼
â”œâ”€â”€ Footer.tsx              # ãƒ•ãƒƒã‚¿ãƒ¼
â”œâ”€â”€ RichTextEditor.tsx      # Markdownã‚¨ãƒ‡ã‚£ã‚¿
â”œâ”€â”€ AvatarUpload.tsx        # ã‚¢ãƒã‚¿ãƒ¼ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
â””â”€â”€ ...
```

---

## 9.5 `src/lib/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

**å½¹å‰²ï¼š** ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã‚„è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®

### ä¸»è¦ãªãƒ•ã‚¡ã‚¤ãƒ«

```
src/lib/
â”œâ”€â”€ auth.ts         # NextAuth.jsèªè¨¼è¨­å®š
â”œâ”€â”€ db.ts           # Prismaãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
â”œâ”€â”€ supabase.ts     # Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â””â”€â”€ permissions.ts  # æ¨©é™ãƒã‚§ãƒƒã‚¯é–¢æ•°
```

#### `db.ts` - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š

```typescript
// src/lib/db.ts
import { PrismaClient } from "@prisma/client";

const globalForPrisma = global as unknown as { prisma: PrismaClient };

export const prisma =
  globalForPrisma.prisma ||
  new PrismaClient({
    log: ["query"], // SQLã‚¯ã‚¨ãƒªã‚’ãƒ­ã‚°å‡ºåŠ›
  });

if (process.env.NODE_ENV !== "production") {
  globalForPrisma.prisma = prisma;
}
```

**ä½¿ã„æ–¹ï¼š**

```typescript
import { prisma } from "@/lib/db";

// ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã‚’å–å¾—
const users = await prisma.user.findMany();

// æŠ•ç¨¿ã‚’ä½œæˆ
const post = await prisma.post.create({
  data: {
    title: "æ–°ã—ã„æŠ•ç¨¿",
    content: "å†…å®¹",
    authorId: "user-id",
  },
});
```

#### `auth.ts` - èªè¨¼è¨­å®š

```typescript
// src/lib/auth.ts (ç°¡ç•¥ç‰ˆ)
import NextAuth from "next-auth";
import Google from "next-auth/providers/google";
import Credentials from "next-auth/providers/credentials";
import { prisma } from "@/lib/db";

export const { handlers, signIn, signOut, auth } = NextAuth({
  providers: [
    Google({
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
    }),
    Credentials({
      // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ + ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼
      async authorize(credentials) {
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ç¢ºèªå‡¦ç†
      },
    }),
  ],
  // ...ãã®ä»–ã®è¨­å®š
});
```

**ä½¿ã„æ–¹ï¼š**

```typescript
import { auth } from "@/lib/auth";

// ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§èªè¨¼çŠ¶æ…‹ã‚’å–å¾—
const session = await auth();

if (!session) {
  return <div>ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„</div>;
}

return <div>ã‚ˆã†ã“ãã€{session.user.name}ã•ã‚“ï¼</div>;
```

---

## 9.6 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç†è§£

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ã‚ã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã¤ã„ã¦ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

### ğŸ“„ `.env.local` - ç’°å¢ƒå¤‰æ•°

**å½¹å‰²ï¼š** API ã‚­ãƒ¼ã‚„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šå…ˆãªã©ã€æ©Ÿå¯†æƒ…å ±ã‚’ä¿ç®¡

**ç¢ºèªæ–¹æ³•ï¼š**

VSCode ã§`.env.local`ã‚’é–‹ã„ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```env
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šå…ˆï¼ˆSupabaseï¼‰
DATABASE_URL="postgresql://postgres.[project-ref]:[YOUR-PASSWORD]@aws-0-ap-northeast-1.pooler.supabase.com:6543/postgres"

# NextAuth.jsèªè¨¼è¨­å®š
AUTH_URL="http://localhost:3000"
AUTH_SECRET="your-generated-secret-key"
AUTH_TRUST_HOST=true

NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-generated-secret-key"

# Google OAuthè¨­å®šï¼ˆå¾Œã§è¨­å®šï¼‰
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""

# Supabaseè¨­å®šï¼ˆå¾Œã§è¨­å®šï¼‰
NEXT_PUBLIC_SUPABASE_URL=""
NEXT_PUBLIC_SUPABASE_ANON_KEY=""
```

**é‡è¦ãªãƒ«ãƒ¼ãƒ«ï¼š**

- âœ… ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯`.gitignore`ã«å«ã¾ã‚Œã¦ã„ã‚‹ï¼ˆGit ã«ã‚³ãƒŸãƒƒãƒˆã•ã‚Œãªã„ï¼‰
- âœ… `NEXT_PUBLIC_`ã§å§‹ã¾ã‚‹å¤‰æ•°ã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ï¼‰ã§ä½¿ãˆã‚‹
- âœ… ãã‚Œä»¥å¤–ã®å¤‰æ•°ã¯ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§ã®ã¿ä½¿ãˆã‚‹

**ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•ï¼š**

```typescript
// ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ï¼ˆAPI Routes, Server Componentsï¼‰
const databaseUrl = process.env.DATABASE_URL;
const authSecret = process.env.AUTH_SECRET;

// ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ï¼‰
// NEXT_PUBLIC_ã§å§‹ã¾ã‚‹å¤‰æ•°ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
```

### ğŸ“„ `package.json` - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æƒ…å ±

**å½¹å‰²ï¼š** ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¾å­˜é–¢ä¿‚ã¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®šç¾©

**ä¸»è¦ãªéƒ¨åˆ†ï¼š**

```json
{
  "name": "keion-circle-site",
  "version": "0.1.0",
  "private": true,

  // ã‚ˆãä½¿ã†ã‚³ãƒãƒ³ãƒ‰
  "scripts": {
    "dev": "next dev", // é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
    "build": "prisma generate && prisma db push --skip-generate --accept-data-loss && next build",
    "start": "next start", // æœ¬ç•ªã‚µãƒ¼ãƒãƒ¼èµ·å‹•
    "lint": "eslint", // ã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯
    "db:generate": "prisma generate", // Prisma Clientç”Ÿæˆ
    "db:push": "prisma db push", // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°
    "db:studio": "prisma studio" // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹GUIèµ·å‹•
  },

  // æœ¬ç•ªç’°å¢ƒã§ã‚‚å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
  "dependencies": {
    "@auth/core": "^0.41.0",
    "@auth/prisma-adapter": "^2.11.1",
    "@prisma/client": "^5.22.0",
    "@supabase/supabase-js": "^2.89.0",
    "bcryptjs": "^3.0.3",
    "lucide-react": "^0.562.0",
    "next": "16.1.0",
    "next-auth": "^5.0.0-beta.30",
    "react": "19.2.3",
    "react-dom": "19.2.3",
    "react-youtube": "^10.1.0"
  },

  // é–‹ç™ºç’°å¢ƒã®ã¿ã§å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/bcryptjs": "^2.4.6",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "eslint": "^9",
    "eslint-config-next": "16.1.0",
    "prisma": "^5.22.0",
    "tailwindcss": "^4",
    "typescript": "^5"
  }
}
```

**ã‚ˆãä½¿ã†ã‚³ãƒãƒ³ãƒ‰ï¼š**

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹GUIèµ·å‹•
npm run db:studio

# æœ¬ç•ªãƒ“ãƒ«ãƒ‰
npm run build
```

### ğŸ“„ `tsconfig.json` - TypeScript è¨­å®š

**å½¹å‰²ï¼š** TypeScript ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©è¨­å®š

**é‡è¦ãªè¨­å®šï¼š**

```json
{
  "compilerOptions": {
    "target": "ES2022", // å‡ºåŠ›ã™ã‚‹JavaScriptã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
    "lib": ["dom", "dom.iterable", "esnext"],
    "strict": true, // å³æ ¼ãªå‹ãƒã‚§ãƒƒã‚¯
    "paths": {
      "@/*": ["./src/*"] // ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹
    }
  }
}
```

**ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®æ´»ç”¨ï¼š**

```typescript
// ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹ãªã—ï¼ˆç›¸å¯¾ãƒ‘ã‚¹ï¼‰
import { Button } from "../../../components/Button";
import { db } from "../../../lib/db";

// ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚ã‚Šï¼ˆçµ¶å¯¾ãƒ‘ã‚¹ï¼‰
import { Button } from "@/components/Button";
import { db } from "@/lib/db";
```

`@/`ã¯`src/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡ã™ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã§ã™ã€‚æ·±ã„éšå±¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚‚ã€å¸¸ã«`@/`ã‹ã‚‰å§‹ã‚ã‚‰ã‚Œã‚‹ã®ã§ä¾¿åˆ©ã§ã™ã€‚

### ğŸ“„ `next.config.ts` - Next.js è¨­å®š

**å½¹å‰²ï¼š** Next.js ã®å‹•ä½œã‚’è¨­å®š

```typescript
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  // ç”»åƒæœ€é©åŒ–ã®è¨­å®š
  images: {
    remotePatterns: [
      {
        protocol: "https",
        hostname: "*.supabase.co",
        pathname: "/storage/v1/object/public/**",
      },
    ],
  },
};

export default nextConfig;
```

**ã“ã®è¨­å®šã®æ„å‘³ï¼š**

- Supabase Storage ã®ç”»åƒã‚’`<Image>`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚ã€è¨±å¯ã•ã‚ŒãŸãƒ‰ãƒ¡ã‚¤ãƒ³ã®ç”»åƒã®ã¿èª­ã¿è¾¼ã‚ã‚‹

### ğŸ“„ `tailwind.config.ts` - Tailwind CSS è¨­å®š

**å½¹å‰²ï¼š** Tailwind CSS ã®å‹•ä½œã‚’è¨­å®š

```typescript
import type { Config } from "tailwindcss";

const config: Config = {
  // Tailwind CSSã‚’é©ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«
  content: [
    "./src/pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
  ],

  // ãƒ†ãƒ¼ãƒã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
  theme: {
    extend: {
      // ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼ã€ãƒ•ã‚©ãƒ³ãƒˆç­‰ã‚’è¿½åŠ ã§ãã‚‹
    },
  },

  plugins: [],
};

export default config;
```

**ã“ã®è¨­å®šã®æ„å‘³ï¼š**

- `content`ï¼šTailwind CSS ã‚’é©ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŒ‡å®š
- ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‚¯ãƒ©ã‚¹ã®ã¿ã‚’æœ€çµ‚çš„ãª CSS ã«å«ã‚ã‚‹ã“ã¨ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’å‰Šæ¸›

### ğŸ“„ `.eslintrc.json` - ã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯è¨­å®š

**å½¹å‰²ï¼š** ã‚³ãƒ¼ãƒ‰ã®å•é¡Œã‚’è‡ªå‹•æ¤œå‡º

```json
{
  "extends": "next/core-web-vitals"
}
```

**ã“ã®ãƒ„ãƒ¼ãƒ«ãŒã§ãã‚‹ã“ã¨ï¼š**

- æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã®æ¤œå‡º
- æ¨å¥¨ã•ã‚Œãªã„æ›¸ãæ–¹ã®è­¦å‘Š
- ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã®çµ±ä¸€

### ğŸ“„ `.gitignore` - Git é™¤å¤–è¨­å®š

**å½¹å‰²ï¼š** Git ã§ç®¡ç†ã—ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®š

```gitignore
# ä¾å­˜é–¢ä¿‚
/node_modules

# Next.jsãƒ“ãƒ«ãƒ‰çµæœ
/.next
/out

# ç’°å¢ƒå¤‰æ•°ï¼ˆæ©Ÿå¯†æƒ…å ±ï¼‰
.env
.env.local
.env*.local

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
*.db
*.db-journal

# ãã®ä»–
.DS_Store
Thumbs.db
```

**ãªãœé™¤å¤–ã™ã‚‹ã®ã‹ï¼š**

| ãƒ•ã‚¡ã‚¤ãƒ«/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª | ç†ç”±                                             |
| --------------------- | ------------------------------------------------ |
| `node_modules/`       | å®¹é‡ãŒå¤§ãã„ï¼ˆæ•°ç™¾ MBï¼‰ã€`npm install`ã§å¾©å…ƒå¯èƒ½ |
| `.next/`              | ãƒ“ãƒ«ãƒ‰çµæœã€`npm run build`ã§å¾©å…ƒå¯èƒ½            |
| `.env.local`          | API ã‚­ãƒ¼ãªã©ã®æ©Ÿå¯†æƒ…å ±ãŒå«ã¾ã‚Œã‚‹                 |
| `*.db`                | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã€é–‹ç™ºç’°å¢ƒã”ã¨ã«ç•°ãªã‚‹       |

---

## 9.7 ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å‘½åè¦å‰‡

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½¿ã‚ã‚Œã¦ã„ã‚‹å‘½åè¦å‰‡ã‚’ç†è§£ã—ã¾ã—ã‚‡ã†ã€‚

### ãƒ•ã‚¡ã‚¤ãƒ«åã®å‘½åè¦å‰‡

| ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®é¡          | å‘½åè¦å‰‡                   | ä¾‹                                   |
| ----------------------- | -------------------------- | ------------------------------------ |
| ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ    | PascalCaseï¼ˆå¤§æ–‡å­—å§‹ã¾ã‚Šï¼‰ | `PostList.tsx`, `UserProfile.tsx`    |
| ç‰¹æ®Šãª Next.js ãƒ•ã‚¡ã‚¤ãƒ« | å°æ–‡å­—                     | `page.tsx`, `layout.tsx`, `route.ts` |
| ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°      | camelCaseï¼ˆå°æ–‡å­—å§‹ã¾ã‚Šï¼‰  | `auth.ts`, `db.ts`, `supabase.ts`    |
| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ          | PascalCase                 | `Button.tsx`, `Card.tsx`             |

### å¤‰æ•°åãƒ»é–¢æ•°åã®å‘½åè¦å‰‡

```typescript
// âœ… è‰¯ã„ä¾‹
const userName = "å¤ªéƒ"; // camelCaseï¼ˆå¤‰æ•°ï¼‰
const MAX_RETRY_COUNT = 3; // UPPER_SNAKE_CASEï¼ˆå®šæ•°ï¼‰
function calculateTotal() {} // camelCaseï¼ˆé–¢æ•°ï¼‰
function UserProfile() {} // PascalCaseï¼ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰
interface UserData {} // PascalCaseï¼ˆå‹ï¼‰

// âŒ æ‚ªã„ä¾‹
const user_name = "å¤ªéƒ"; // snake_caseï¼ˆJavaScriptã§ã¯éæ¨å¥¨ï¼‰
const max_retry = 3; // å®šæ•°ãªã®ã«å°æ–‡å­—
function CalculateTotal() {} // é–¢æ•°ãªã®ã«PascalCase
```

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã®å‘½åè¦å‰‡

```
src/
â”œâ”€â”€ app/              # å°æ–‡å­—ï¼ˆNext.jsã®è¦ç´„ï¼‰
â”œâ”€â”€ components/       # å°æ–‡å­—
â””â”€â”€ lib/              # å°æ–‡å­—
```

**Next.js App Router ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåï¼š**

- åŸºæœ¬çš„ã«å°æ–‡å­—ã‚’ä½¿ç”¨
- è¤‡æ•°å˜èªã®å ´åˆã¯ãƒã‚¤ãƒ•ãƒ³åŒºåˆ‡ã‚Šï¼ˆä¾‹ï¼š`user-profile/`ï¼‰
- å‹•çš„ãƒ«ãƒ¼ãƒˆã¯`[id]`ã®ã‚ˆã†ã«`[]`ã§å›²ã‚€

---

## 9.8 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®ç¢ºèªæ¼”ç¿’

å®Ÿéš›ã«æ‰‹ã‚’å‹•ã‹ã—ã¦ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

### ğŸ”§ æ¼”ç¿’ 1: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’è¡¨ç¤º

**ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œï¼š**

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’è¡¨ç¤ºï¼ˆmacOS/Linuxï¼‰
tree -L 2 -I 'node_modules|.next'

# ã¾ãŸã¯ã€ls ã‚³ãƒãƒ³ãƒ‰ã§ç¢ºèª
ls -la
ls -la src/
ls -la src/app/
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ï¼š**

```
.
â”œâ”€â”€ README.md
â”œâ”€â”€ next-env.d.ts
â”œâ”€â”€ next.config.ts
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ package.json
â”œâ”€â”€ prisma
â”‚   â”œâ”€â”€ dev.db
â”‚   â””â”€â”€ schema.prisma
â”œâ”€â”€ public
â”‚   â””â”€â”€ favicon.ico
â”œâ”€â”€ scripts
â”‚   â””â”€â”€ create-admin.js
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ app
â”‚   â”œâ”€â”€ components
â”‚   â””â”€â”€ lib
â”œâ”€â”€ tailwind.config.ts
â””â”€â”€ tsconfig.json
```

### ğŸ”§ æ¼”ç¿’ 2: å„ãƒ•ã‚¡ã‚¤ãƒ«ã®è¡Œæ•°ã‚’ç¢ºèª

```bash
# å„ãƒ•ã‚¡ã‚¤ãƒ«ã®è¡Œæ•°ã‚’ç¢ºèª
wc -l prisma/schema.prisma
wc -l src/app/layout.tsx
wc -l src/app/page.tsx
```

### ğŸ”§ æ¼”ç¿’ 3: ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª

```bash
# ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªï¼ˆå†…å®¹ã¯è¡¨ç¤ºã•ã‚Œãªã„ï¼‰
ls -la .env.local

# ç’°å¢ƒå¤‰æ•°ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªï¼ˆé–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•æ™‚ï¼‰
npm run dev
# â†’ "Environments: .env.local" ã¨è¡¨ç¤ºã•ã‚Œã‚Œã°OK
```

### ğŸ”§ æ¼”ç¿’ 4: Prisma Studio ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç¢ºèª

```bash
npm run db:studio
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§`http://localhost:5555`ãŒé–‹ãã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ§‹é€ ãŒç¢ºèªã§ãã¾ã™ã€‚

**ç¢ºèªé …ç›®ï¼š**

- [ ] 12 å€‹ã®ãƒ¢ãƒ‡ãƒ«ï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] Userã€Postã€Eventã€Schedule ç­‰ã®ãƒ¢ãƒ‡ãƒ«ãŒå­˜åœ¨ã™ã‚‹
- [ ] å„ãƒ¢ãƒ‡ãƒ«ã®æ§‹é€ ãŒç¢ºèªã§ãã‚‹

---

## 9.9 ã‚ˆãã‚ã‚‹ç–‘å•ã¨å›ç­”

### Q1: `src/app/`ã¨`src/components/`ã®é•ã„ã¯ï¼Ÿ

**A:**

- `src/app/`ï¼šãƒšãƒ¼ã‚¸ã¨ API ãƒ«ãƒ¼ãƒˆï¼ˆURL ã«å¯¾å¿œï¼‰
- `src/components/`ï¼šå†åˆ©ç”¨å¯èƒ½ãªéƒ¨å“ï¼ˆURL ã«ã¯å¯¾å¿œã—ãªã„ï¼‰

**ä¾‹ï¼š**

```
src/app/posts/page.tsx        â†’ /posts ã¨ã„ã†URLã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
src/components/Button.tsx      â†’ ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ import ã—ã¦ä½¿ã†
```

### Q2: ãªãœ`@/`ã¨ã„ã†ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä½¿ã†ã®ï¼Ÿ

**A:** ç›¸å¯¾ãƒ‘ã‚¹ï¼ˆ`../../..`ï¼‰ã ã¨ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®éšå±¤ãŒæ·±ããªã‚‹ã¨åˆ†ã‹ã‚Šã«ãããªã‚‹ãŸã‚ã€‚

```typescript
// ç›¸å¯¾ãƒ‘ã‚¹ï¼ˆåˆ†ã‹ã‚Šã«ãã„ï¼‰
import { Button } from "../../../components/Button";

// ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆåˆ†ã‹ã‚Šã‚„ã™ã„ï¼‰
import { Button } from "@/components/Button";
```

ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã§ã‚‚å¸¸ã«`@/`ã‹ã‚‰å§‹ã‚ã‚‰ã‚Œã‚‹ã®ã§ã€è¿·ã„ã¾ã›ã‚“ã€‚

### Q3: `page.tsx`ã¨`layout.tsx`ã®é•ã„ã¯ï¼Ÿ

**A:**

- `page.tsx`ï¼šãã® URL ã®ãƒšãƒ¼ã‚¸å†…å®¹
- `layout.tsx`ï¼šè¤‡æ•°ã®ãƒšãƒ¼ã‚¸ã§å…±é€šã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

```
app/
â”œâ”€â”€ layout.tsx       â† å…¨ãƒšãƒ¼ã‚¸å…±é€šï¼ˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ç­‰ï¼‰
â”œâ”€â”€ page.tsx         â† /
â””â”€â”€ posts/
    â”œâ”€â”€ layout.tsx   â† /posts ä»¥ä¸‹ã§å…±é€š
    â””â”€â”€ page.tsx     â† /posts
```

### Q4: API ãƒ«ãƒ¼ãƒˆï¼ˆ`route.ts`ï¼‰ã¯ã„ã¤ä½¿ã†ï¼Ÿ

**A:** ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ãƒ‡ãƒ¼ã‚¿ã‚’é€å—ä¿¡ã™ã‚‹æ™‚ã«ä½¿ã„ã¾ã™ã€‚

**ä¾‹ï¼šæŠ•ç¨¿ã‚’ä½œæˆã™ã‚‹æµã‚Œ**

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ•ã‚©ãƒ¼ãƒ ã«å…¥åŠ›
2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆpage.tsxï¼‰ãŒAPIãƒ«ãƒ¼ãƒˆï¼ˆ/api/postsï¼‰ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡
3. APIãƒ«ãƒ¼ãƒˆï¼ˆroute.tsï¼‰ãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜
4. APIãƒ«ãƒ¼ãƒˆãŒçµæœã‚’ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«è¿”ã™
5. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒç”»é¢ã‚’æ›´æ–°
```

### Q5: `.env.local`ã«æ›¸ã„ãŸå€¤ãŒèª­ã¿è¾¼ã¾ã‚Œãªã„

**A:** é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„ã€‚

```bash
# ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ Ctrl + C ã‚’æŠ¼ã—ã¦åœæ­¢
# å†åº¦èµ·å‹•
npm run dev
```

ç’°å¢ƒå¤‰æ•°ã¯é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•æ™‚ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ãŸã‚ã€å¤‰æ›´ã—ãŸã‚‰å†èµ·å‹•ãŒå¿…è¦ã§ã™ã€‚

---

## 9.10 ç¢ºèªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

Chapter 9 ã®å†…å®¹ã‚’ç†è§£ã§ããŸã‹ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ç†è§£

- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å…¨ä½“æ§‹é€ ã‚’èª¬æ˜ã§ãã‚‹
- [ ] `prisma/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å½¹å‰²ã‚’ç†è§£ã—ãŸ
- [ ] `public/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½¿ã„æ–¹ã‚’ç†è§£ã—ãŸ
- [ ] `src/app/`ãŒãƒšãƒ¼ã‚¸ã¨ API ã«å¯¾å¿œã™ã‚‹ã“ã¨ã‚’ç†è§£ã—ãŸ
- [ ] `src/components/`ãŒå†åˆ©ç”¨å¯èƒ½ãªéƒ¨å“ã‚’ç½®ãå ´æ‰€ã ã¨ç†è§£ã—ãŸ
- [ ] `src/lib/`ãŒãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã‚’ç½®ãå ´æ‰€ã ã¨ç†è§£ã—ãŸ

### App Router ã®ç†è§£

- [ ] ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãŒ URL ã«ãªã‚‹ã“ã¨ã‚’ç†è§£ã—ãŸ
- [ ] `page.tsx`ãŒãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã ã¨ç†è§£ã—ãŸ
- [ ] `layout.tsx`ãŒå…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã ã¨ç†è§£ã—ãŸ
- [ ] `route.ts`ãŒ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã ã¨ç†è§£ã—ãŸ
- [ ] å‹•çš„ãƒ«ãƒ¼ãƒˆ`[id]`ã®ä»•çµ„ã¿ã‚’ç†è§£ã—ãŸ

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç†è§£

- [ ] `.env.local`ã«æ©Ÿå¯†æƒ…å ±ã‚’ä¿ç®¡ã™ã‚‹ã“ã¨ã‚’ç†è§£ã—ãŸ
- [ ] `package.json`ã®`scripts`ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç†è§£ã—ãŸ
- [ ] `tsconfig.json`ã®ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹è¨­å®šã‚’ç†è§£ã—ãŸ
- [ ] `.gitignore`ã®å½¹å‰²ã‚’ç†è§£ã—ãŸ

### å®Ÿè·µçš„ãªç†è§£

- [ ] VSCode ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ã„ã¦ç¢ºèªã—ãŸ
- [ ] å„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿéš›ã«è¦‹ãŸ
- [ ] Prisma Studio ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ã‚’ç¢ºèªã—ãŸ
- [ ] `src/app/page.tsx`ã‚’ç·¨é›†ã—ã¦å¤‰æ›´ã‚’ç¢ºèªã—ãŸ

---

## ã¾ã¨ã‚

ã“ã®ç« ã§ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹é€ ã‚’è©³ã—ãå­¦ã³ã¾ã—ãŸã€‚

### ğŸ“ ã“ã®ç« ã§å­¦ã‚“ã ã“ã¨

#### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

- âœ… ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å…¨ä½“åƒã¨å„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å½¹å‰²
- âœ… ãƒ•ã‚¡ã‚¤ãƒ«ã®é…ç½®å ´æ‰€ã¨ãã®ç†ç”±
- âœ… Next.js App Router ã®ä»•çµ„ã¿

#### App Router

- âœ… ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãŒ URL ã«å¯¾å¿œ
- âœ… `page.tsx`ã€`layout.tsx`ã€`route.ts`ã®å½¹å‰²
- âœ… å‹•çš„ãƒ«ãƒ¼ãƒˆ`[id]`ã®ä½¿ã„æ–¹

#### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

- âœ… å„è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²
- âœ… ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†æ–¹æ³•
- âœ… ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹`@/`ã®æ´»ç”¨

#### å‘½åè¦å‰‡

- âœ… ãƒ•ã‚¡ã‚¤ãƒ«åã®å‘½åè¦å‰‡ï¼ˆPascalCase, camelCaseï¼‰
- âœ… å¤‰æ•°åãƒ»é–¢æ•°åã®å‘½åè¦å‰‡
- âœ… ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã®å‘½åè¦å‰‡

### ğŸš€ æ¬¡ã®ç« ã¸ã®æº–å‚™

æ¬¡ã®ç« ï¼ˆChapter 10: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ Prisma ã®åŸºç¤ï¼‰ã§ã¯ã€ä»¥ä¸‹ã‚’å­¦ã³ã¾ã™ï¼š

1. **Prisma ã®ä½¿ã„æ–¹**

   - CRUD æ“ä½œï¼ˆä½œæˆã€èª­ã¿å–ã‚Šã€æ›´æ–°ã€å‰Šé™¤ï¼‰
   - ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã®å–å¾—
   - ã‚¯ã‚¨ãƒªã®æ›¸ãæ–¹

2. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã®å®Ÿè·µ**
   - å®Ÿéš›ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆãƒ»å–å¾—
   - Prisma Studio ã§ã®ç¢ºèª
   - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ä½¿ã„æ–¹

**æº–å‚™ã™ã‚‹ã“ã¨ï¼š**

- âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã‚’å¾©ç¿’ã—ã¦ãŠã
- âœ… `prisma/schema.prisma`ã®å†…å®¹ã‚’ç¢ºèªã—ã¦ãŠã
- âœ… Prisma Studio ã®ä½¿ã„æ–¹ã‚’ç¢ºèªã—ã¦ãŠã

### ğŸ’¡ é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

1. **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãŒ URL ã«å¯¾å¿œ**: Next.js App Router ã®æœ€ã‚‚é‡è¦ãªæ¦‚å¿µ
2. **ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹`@/`ã‚’æ´»ç”¨**: ç›¸å¯¾ãƒ‘ã‚¹ã®è¤‡é›‘ã•ã‚’é¿ã‘ã‚‰ã‚Œã‚‹
3. **ç’°å¢ƒå¤‰æ•°ã§æ©Ÿå¯†æƒ…å ±ã‚’ç®¡ç†**: `.env.local`ã¯çµ¶å¯¾ã« Git ã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„
4. **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯åŸºæœ¬çš„ã«å¤‰æ›´ä¸è¦**: æœ€åˆã®è¨­å®šã®ã¾ã¾ã§å‹•ä½œã™ã‚‹

---

[â† å‰ã®ç« ï¼šç¬¬ 8 ç«  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](08-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—.md) | [ç›®æ¬¡ã«æˆ»ã‚‹](00-ç›®æ¬¡.md) | [æ¬¡ã®ç« ã¸ï¼šç¬¬ 10 ç«  ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ Prisma ã®åŸºç¤ â†’](10-ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨Prismaã®åŸºç¤.md)

event Event? @relation(fields: [eventId], references: [id], onDelete: Cascade)
candidates ScheduleCandidate[] // å€™è£œæ—¥

createdAt DateTime @default(now())
updatedAt DateTime @updatedAt
}

// ScheduleCandidate ãƒ¢ãƒ‡ãƒ«ï¼ˆå€™è£œæ—¥ï¼‰
model ScheduleCandidate {
id String @id @default(cuid())
scheduleId String
datetime DateTime
location String?

schedule Schedule @relation(fields: [scheduleId], references: [id], onDelete: Cascade)
votes ScheduleVote[]
comments ScheduleCandidateComment[]

createdAt DateTime @default(now())
updatedAt DateTime @updatedAt
}

// ScheduleVote ãƒ¢ãƒ‡ãƒ«ï¼ˆæŠ•ç¥¨ï¼‰
model ScheduleVote {
id String @id @default(cuid())
candidateId String
userId String
response String // "å‚åŠ å¯èƒ½" | "æœªå®š" | "å‚åŠ ä¸å¯"

candidate ScheduleCandidate @relation(fields: [candidateId], references: [id], onDelete: Cascade)
user User @relation(fields: [userId], references: [id], onDelete: Cascade)

createdAt DateTime @default(now())
updatedAt DateTime @updatedAt

@@unique([candidateId, userId])
}

// ScheduleCandidateComment ãƒ¢ãƒ‡ãƒ«ï¼ˆå€™è£œæ—¥ã¸ã®ã‚³ãƒ¡ãƒ³ãƒˆï¼‰
model ScheduleCandidateComment {
id String @id @default(cuid())
candidateId String
userId String
content String @db.Text

candidate ScheduleCandidate @relation(fields: [candidateId], references: [id], onDelete: Cascade)

createdAt DateTime @default(now())
updatedAt DateTime @updatedAt
}

// NextAuth.js ç”¨ã®ãƒ¢ãƒ‡ãƒ«
model Account {
id String @id @default(cuid())
userId String
type String
provider String
providerAccountId String
refresh_token String? @db.Text
access_token String? @db.Text
expires_at Int?
token_type String?
scope String?
id_token String? @db.Text
session_state String?

user User @relation(fields: [userId], references: [id], onDelete: Cascade)

@@unique([provider, providerAccountId])
}

model Session {
id String @id @default(cuid())
sessionToken String @unique
userId String
expires DateTime

user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model VerificationToken {
identifier String
token String @unique
expires DateTime

@@unique([identifier, token])
}

````

**ãƒã‚¤ãƒ³ãƒˆï¼š**

- `@id`: ä¸»ã‚­ãƒ¼
- `@unique`: ä¸€æ„åˆ¶ç´„
- `@default`: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
- `@relation`: ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©
- `onDelete: Cascade`: è¦ªãŒå‰Šé™¤ã•ã‚ŒãŸã‚‰å­ã‚‚å‰Šé™¤

---

## 9.3 `src/lib/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

å…±é€šã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã‚’æ ¼ç´ã—ã¾ã™ã€‚

### src/lib/db.tsï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šï¼‰

```typescript
import { PrismaClient } from '@prisma/client';

// PrismaClientã®ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
const globalForPrisma = global as unknown as { prisma: PrismaClient };

export const prisma =
  globalForPrisma.prisma ||
  new PrismaClient({
    log: ['query'], // SQLã‚¯ã‚¨ãƒªã‚’ãƒ­ã‚°å‡ºåŠ›ï¼ˆé–‹ç™ºæ™‚ã®ã¿ï¼‰
  });

if (process.env.NODE_ENV !== 'production') {
  globalForPrisma.prisma = prisma;
}
````

**ãªãœã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã«ã™ã‚‹ã®ã‹ï¼Ÿ**

é–‹ç™ºç’°å¢ƒã§ã€ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ã®ãŸã³ã«æ–°ã—ã„æ¥ç¶šã‚’ä½œã‚‹ã¨ã€æ¥ç¶šæ•°ã®ä¸Šé™ã«é”ã—ã¦ã—ã¾ã†ãŸã‚ã€‚

**ä½¿ã„æ–¹ï¼š**

```typescript
import { prisma } from "@/lib/db";

// ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã‚’å–å¾—
const users = await prisma.user.findMany();

// æŠ•ç¨¿ã‚’ä½œæˆ
const post = await prisma.post.create({
  data: {
    title: "æ–°ã—ã„æŠ•ç¨¿",
    content: "å†…å®¹",
    authorId: "user-id",
  },
});
```

### src/lib/auth.tsï¼ˆèªè¨¼è¨­å®šï¼‰

```typescript
import NextAuth from "next-auth";
import { PrismaAdapter } from "@auth/prisma-adapter";
import Google from "next-auth/providers/google";
import Credentials from "next-auth/providers/credentials";
import { prisma } from "@/lib/db";
import bcrypt from "bcryptjs";

export const { handlers, signIn, signOut, auth } = NextAuth({
  // Prismaã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜
  adapter: PrismaAdapter(prisma),

  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼
  session: {
    strategy: "jwt", // JWTã‚’ä½¿ç”¨
  },

  // èªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
  providers: [
    // Google OAuth
    Google({
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
    }),

    // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ + ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
    Credentials({
      credentials: {
        email: { label: "Email", type: "email" },
        password: { label: "Password", type: "password" },
      },
      async authorize(credentials) {
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ¤œç´¢
        const user = await prisma.user.findUnique({
          where: { email: credentials.email as string },
        });

        if (!user || !user.password) {
          return null;
        }

        // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ¤œè¨¼
        const isValid = await bcrypt.compare(
          credentials.password as string,
          user.password
        );

        if (!isValid) {
          return null;
        }

        return {
          id: user.id,
          email: user.email,
          name: user.name,
          image: user.image,
          role: user.role,
        };
      },
    }),
  ],

  // ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
  callbacks: {
    // JWTãƒˆãƒ¼ã‚¯ãƒ³ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¿½åŠ 
    async jwt({ token, user }) {
      if (user) {
        token.id = user.id;
        token.role = user.role;
      }
      return token;
    },

    // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¿½åŠ 
    async session({ session, token }) {
      if (session.user) {
        session.user.id = token.id as string;
        session.user.role = token.role as string;
      }
      return session;
    },
  },

  // ã‚«ã‚¹ã‚¿ãƒ ãƒšãƒ¼ã‚¸
  pages: {
    signIn: "/login", // ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
  },
});
```

**ä½¿ã„æ–¹ï¼š**

```typescript
import { auth } from "@/lib/auth";

// ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
export default async function Page() {
  const session = await auth();

  if (!session) {
    return <div>ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„</div>;
  }

  return <div>ã“ã‚“ã«ã¡ã¯ã€{session.user.name}ã•ã‚“</div>;
}

// API Route
export async function GET() {
  const session = await auth();

  if (!session) {
    return Response.json({ error: "Unauthorized" }, { status: 401 });
  }

  // å‡¦ç†...
}
```

### src/lib/supabase.tsï¼ˆSupabase è¨­å®šï¼‰

```typescript
import { createClient } from "@supabase/supabase-js";

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;
const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;

export const supabase = createClient(supabaseUrl, supabaseKey);
```

**ä½¿ã„æ–¹ï¼ˆç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰ï¼š**

```typescript
import { supabase } from "@/lib/supabase";

// ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
const file = event.target.files[0];
const fileName = `${Date.now()}-${file.name}`;

const { data, error } = await supabase.storage
  .from("avatars")
  .upload(fileName, file);

if (error) {
  console.error(error);
  return;
}

// å…¬é–‹URLã‚’å–å¾—
const { data: urlData } = supabase.storage
  .from("avatars")
  .getPublicUrl(fileName);

const imageUrl = urlData.publicUrl;
```

---

## 9.4 `src/app/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆApp Routerï¼‰

Next.js 16 ã® App Router ã‚’ä½¿ã£ãŸãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ§‹é€ ã§ã™ã€‚

```
src/app/
â”œâ”€â”€ api/                    # APIãƒ«ãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ auth/               # èªè¨¼é–¢é€£API
â”‚   â”‚   â””â”€â”€ [...nextauth]/route.ts
â”‚   â”œâ”€â”€ posts/              # æŠ•ç¨¿é–¢é€£API
â”‚   â”‚   â”œâ”€â”€ route.ts
â”‚   â”‚   â”œâ”€â”€ [id]/route.ts
â”‚   â”‚   â””â”€â”€ [id]/like/route.ts
â”‚   â”œâ”€â”€ schedules/          # ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é–¢é€£API
â”‚   â””â”€â”€ users/              # ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£API
â”œâ”€â”€ posts/                  # æŠ•ç¨¿ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ page.tsx            # /posts
â”‚   â”œâ”€â”€ new/page.tsx        # /posts/new
â”‚   â””â”€â”€ [id]/page.tsx       # /posts/123
â”œâ”€â”€ schedules/              # ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ page.tsx            # /schedules
â”‚   â”œâ”€â”€ new/page.tsx        # /schedules/new
â”‚   â””â”€â”€ [id]/page.tsx       # /schedules/123
â”œâ”€â”€ users/                  # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ page.tsx            # /users
â”‚   â””â”€â”€ [id]/page.tsx       # /users/123
â”œâ”€â”€ login/                  # ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚   â””â”€â”€ page.tsx
â”œâ”€â”€ register/               # ç™»éŒ²ãƒšãƒ¼ã‚¸
â”‚   â””â”€â”€ page.tsx
â”œâ”€â”€ layout.tsx              # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”œâ”€â”€ page.tsx                # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ï¼ˆ/ï¼‰
â””â”€â”€ globals.css             # ã‚°ãƒ­ãƒ¼ãƒãƒ«CSS
```

### ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ä»•çµ„ã¿

```
ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹                    URL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
app/page.tsx                â†’ /
app/posts/page.tsx          â†’ /posts
app/posts/new/page.tsx      â†’ /posts/new
app/posts/[id]/page.tsx     â†’ /posts/123
app/schedules/[id]/page.tsx â†’ /schedules/abc
```

**å‹•çš„ãƒ«ãƒ¼ãƒˆ `[id]`:**

```typescript
// app/posts/[id]/page.tsx
export default async function PostPage({
  params,
}: {
  params: Promise<{ id: string }>;
}) {
  const { id } = await params;

  // idã‚’ä½¿ã£ã¦æŠ•ç¨¿ã‚’å–å¾—
  const post = await prisma.post.findUnique({
    where: { id },
  });

  return <div>{post.title}</div>;
}
```

---

## 9.5 ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚·ã‚¹ãƒ†ãƒ 

### app/layout.tsxï¼ˆãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼‰

ã™ã¹ã¦ã®ãƒšãƒ¼ã‚¸ã«å…±é€šã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã§ã™ã€‚

```typescript
import type { Metadata } from "next";
import { Inter } from "next/font/google";
import "./globals.css";
import Navigation from "@/components/Navigation";
import AuthButton from "@/components/AuthButton";

const inter = Inter({ subsets: ["latin"] });

export const metadata: Metadata = {
  title: "BOLDè»½éŸ³ ãƒ¡ãƒ³ãƒãƒ¼ã‚µã‚¤ãƒˆ",
  description: "ãƒ¡ãƒ³ãƒãƒ¼å°‚ç”¨ã®æ´»å‹•å ±å‘Šãƒ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«èª¿æ•´ã‚µã‚¤ãƒˆ",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="ja">
      <body className={inter.className}>
        <header className="border-b">
          <div className="container mx-auto px-4 py-4 flex justify-between items-center">
            <h1 className="text-2xl font-bold">BOLDè»½éŸ³</h1>
            <div className="flex items-center gap-4">
              <Navigation />
              <AuthButton />
            </div>
          </div>
        </header>

        <main className="container mx-auto px-4 py-8">{children}</main>

        <footer className="border-t mt-16">
          <div className="container mx-auto px-4 py-8 text-center text-gray-600">
            Â© 2024 BOLDè»½éŸ³ã‚µãƒ¼ã‚¯ãƒ«
          </div>
        </footer>
      </body>
    </html>
  );
}
```

**ãƒã‚¤ãƒ³ãƒˆï¼š**

- `{children}`: å„ãƒšãƒ¼ã‚¸ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒæŒ¿å…¥ã•ã‚Œã‚‹
- `<header>` ã¨ `<footer>` ã¯ã™ã¹ã¦ã®ãƒšãƒ¼ã‚¸ã§å…±é€š
- `metadata`: SEO ç”¨ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿

### ãƒã‚¹ãƒˆã•ã‚ŒãŸãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

```typescript
// app/posts/layout.tsx
export default function PostsLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <div>
      <div className="mb-8">
        <h2 className="text-3xl font-bold">æ´»å‹•å ±å‘Š</h2>
        <p className="text-gray-600">BOLDè»½éŸ³ã®æ´»å‹•ã‚’ã‚·ã‚§ã‚¢ã—ã‚ˆã†</p>
      </div>
      {children}
    </div>
  );
}
```

ã“ã‚Œã«ã‚ˆã‚Šã€`/posts` é…ä¸‹ã®ã™ã¹ã¦ã®ãƒšãƒ¼ã‚¸ã§å…±é€šã®ãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

---

## 9.6 `src/components/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ ¼ç´ã—ã¾ã™ã€‚

```
src/components/
â”œâ”€â”€ AuthButton.tsx          # èªè¨¼ãƒœã‚¿ãƒ³
â”œâ”€â”€ Navigation.tsx          # ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ PostCard.tsx            # æŠ•ç¨¿ã‚«ãƒ¼ãƒ‰
â”œâ”€â”€ CommentList.tsx         # ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§
â”œâ”€â”€ YouTubeEmbed.tsx        # YouTubeåŸ‹ã‚è¾¼ã¿
â”œâ”€â”€ ImageUpload.tsx         # ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
â”œâ”€â”€ ScheduleVoteButton.tsx  # ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æŠ•ç¥¨ãƒœã‚¿ãƒ³
â””â”€â”€ UserAvatar.tsx          # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ãƒã‚¿ãƒ¼
```

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆã®åŸå‰‡

**1. å°ã•ãã€å†åˆ©ç”¨å¯èƒ½ã«**

```typescript
// âŒ æ‚ªã„ä¾‹ï¼šå¤§ãã™ãã‚‹
function PostPage() {
  return (
    <div>
      {/* æŠ•ç¨¿è¡¨ç¤º */}
      {/* ã„ã„ã­ãƒœã‚¿ãƒ³ */}
      {/* ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§ */}
      {/* ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ  */}
    </div>
  );
}

// âœ… è‰¯ã„ä¾‹ï¼šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«åˆ†å‰²
function PostPage() {
  return (
    <div>
      <PostHeader />
      <PostContent />
      <LikeButton />
      <CommentList />
      <CommentForm />
    </div>
  );
}
```

**2. Props ã§ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹ã‚ˆã†ã« Avatar ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼š**

```typescript
// components/UserAvatar.tsx
interface UserAvatarProps {
  src?: string | null;
  name: string;
  size?: 'sm' | 'md' | 'lg';
}

export default function UserAvatar({ src, name, size = 'md' }: UserAvatarProps) {
  const sizeClasses = {
    sm: 'w-8 h-8 text-sm',
    md: 'w-12 h-12 text-base',
    lg: 'w-16 h-16 text-lg',
  };

  if (src) {
    return (
      <img
        src={src}
        alt={name}
        className={`${sizeClasses[size]} rounded-full object-cover`}
      />
    );
  }

  // ç”»åƒãŒãªã„å ´åˆã¯åå‰ã®é ­æ–‡å­—
  const initial = name.charAt(0).toUpperCase();

  return (
    <div
      className={`${sizeClasses[size]} rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold`}
    >
      {initial}
    </div>
  );
}

// ä½¿ã„æ–¹
<UserAvatar src={user.image} name={user.name} size="sm" />
<UserAvatar src={user.image} name={user.name} size="md" />
<UserAvatar src={user.image} name={user.name} size="lg" />
```

**3. Client Component ã¨ Server Component ã‚’ä½¿ã„åˆ†ã‘ã‚‹**

```typescript
// Server Componentï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
export default async function PostList() {
  const posts = await prisma.post.findMany();

  return (
    <div>
      {posts.map((post) => (
        <PostCard key={post.id} post={post} />
      ))}
    </div>
  );
}

// Client Componentï¼ˆã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ãŒå¿…è¦ï¼‰
("use client");

export default function LikeButton({ postId }: { postId: string }) {
  const [liked, setLiked] = useState(false);

  const handleLike = async () => {
    await fetch(`/api/posts/${postId}/like`, { method: "POST" });
    setLiked(true);
  };

  return <button onClick={handleLike}>{liked ? "â¤ï¸" : "ğŸ¤"} ã„ã„ã­</button>;
}
```

---

## 9.7 API ãƒ«ãƒ¼ãƒˆã®æ§‹é€ 

### app/api/posts/route.tsï¼ˆæŠ•ç¨¿ä¸€è¦§ãƒ»ä½œæˆï¼‰

```typescript
import { NextRequest, NextResponse } from "next/server";
import { auth } from "@/lib/auth";
import { prisma } from "@/lib/db";

// GET /api/posts - æŠ•ç¨¿ä¸€è¦§
export async function GET() {
  const posts = await prisma.post.findMany({
    include: {
      author: true,
      _count: { select: { likes: true, comments: true } },
    },
    orderBy: { createdAt: "desc" },
  });

  return NextResponse.json(posts);
}

// POST /api/posts - æŠ•ç¨¿ä½œæˆ
export async function POST(request: NextRequest) {
  const session = await auth();

  // èªè¨¼ãƒã‚§ãƒƒã‚¯
  if (!session?.user) {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  // ç®¡ç†è€…ãƒã‚§ãƒƒã‚¯
  if (session.user.role !== "admin") {
    return NextResponse.json({ error: "Forbidden" }, { status: 403 });
  }

  const body = await request.json();

  const post = await prisma.post.create({
    data: {
      title: body.title,
      content: body.content,
      youtubeUrls: body.youtubeUrls || [],
      images: body.images || [],
      authorId: session.user.id,
    },
  });

  return NextResponse.json(post);
}
```

### app/api/posts/[id]/route.tsï¼ˆæŠ•ç¨¿è©³ç´°ãƒ»æ›´æ–°ãƒ»å‰Šé™¤ï¼‰

```typescript
// GET /api/posts/123 - æŠ•ç¨¿è©³ç´°
export async function GET(
  request: NextRequest,
  { params }: { params: Promise<{ id: string }> }
) {
  const { id } = await params;

  const post = await prisma.post.findUnique({
    where: { id },
    include: {
      author: true,
      likes: true,
      comments: {
        include: { user: true },
        orderBy: { createdAt: "desc" },
      },
    },
  });

  if (!post) {
    return NextResponse.json({ error: "Not found" }, { status: 404 });
  }

  return NextResponse.json(post);
}

// PUT /api/posts/123 - æŠ•ç¨¿æ›´æ–°
export async function PUT(
  request: NextRequest,
  { params }: { params: Promise<{ id: string }> }
) {
  const session = await auth();
  const { id } = await params;

  if (!session?.user || session.user.role !== "admin") {
    return NextResponse.json({ error: "Forbidden" }, { status: 403 });
  }

  const body = await request.json();

  const post = await prisma.post.update({
    where: { id },
    data: {
      title: body.title,
      content: body.content,
      youtubeUrls: body.youtubeUrls,
      images: body.images,
    },
  });

  return NextResponse.json(post);
}

// DELETE /api/posts/123 - æŠ•ç¨¿å‰Šé™¤
export async function DELETE(
  request: NextRequest,
  { params }: { params: Promise<{ id: string }> }
) {
  const session = await auth();
  const { id } = await params;

  if (!session?.user || session.user.role !== "admin") {
    return NextResponse.json({ error: "Forbidden" }, { status: 403 });
  }

  await prisma.post.delete({
    where: { id },
  });

  return NextResponse.json({ success: true });
}
```

---

## 9.8 ãƒ•ã‚¡ã‚¤ãƒ«å‘½åè¦å‰‡

### ç‰¹æ®Šãªãƒ•ã‚¡ã‚¤ãƒ«å

Next.js App Router ã§ã¯ã€ç‰¹å®šã®åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ç‰¹åˆ¥ãªæ„å‘³ãŒã‚ã‚Šã¾ã™ï¼š

```
page.tsx          - ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
layout.tsx        - ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
loading.tsx       - ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
error.tsx         - ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
not-found.tsx     - 404ãƒšãƒ¼ã‚¸
route.ts          - APIãƒ«ãƒ¼ãƒˆ
```

### ä¾‹ï¼šloading.tsx

```typescript
// app/posts/loading.tsx
export default function Loading() {
  return (
    <div className="flex justify-center items-center min-h-screen">
      <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600" />
    </div>
  );
}
```

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã¨ã€`/posts` ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ä¸­ã«è‡ªå‹•çš„ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

### ä¾‹ï¼šerror.tsx

```typescript
// app/posts/error.tsx
"use client";

export default function Error({
  error,
  reset,
}: {
  error: Error;
  reset: () => void;
}) {
  return (
    <div className="text-center py-16">
      <h2 className="text-2xl font-bold text-red-600 mb-4">
        ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ
      </h2>
      <p className="text-gray-600 mb-4">{error.message}</p>
      <button
        onClick={reset}
        className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
      >
        å†è©¦è¡Œ
      </button>
    </div>
  );
}
```

---

## 9.9 ã‚³ãƒ¼ãƒ‰åˆ†å‰²ã¨æœ€é©åŒ–

### å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

é‡ã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å‹•çš„ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã§ã€åˆæœŸãƒ­ãƒ¼ãƒ‰ã‚’é«˜é€ŸåŒ–ã§ãã¾ã™ã€‚

```typescript
import dynamic from "next/dynamic";

// å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆä½¿ç”¨æ™‚ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ï¼‰
const ReactPlayer = dynamic(() => import("react-player"), {
  ssr: false, // ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’ç„¡åŠ¹åŒ–
  loading: () => <div>Loading player...</div>,
});

export default function VideoPage() {
  return (
    <div>
      <ReactPlayer url="https://youtube.com/watch?v=..." />
    </div>
  );
}
```

### ç”»åƒæœ€é©åŒ–

```typescript
import Image from "next/image";

export default function PostImage({ src, alt }: { src: string; alt: string }) {
  return (
    <Image
      src={src}
      alt={alt}
      width={800}
      height={600}
      className="rounded-lg"
      // è‡ªå‹•çš„ã«æœ€é©ãªã‚µã‚¤ã‚ºã«å¤‰æ›ã•ã‚Œã‚‹
    />
  );
}
```

---

## 9.10 ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†

### .env.localï¼ˆé–‹ç™ºç’°å¢ƒï¼‰

```env
# å…¬é–‹ã•ã‚Œãªã„ï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®ã¿ï¼‰
DATABASE_URL="postgresql://postgres.[project-ref]:[YOUR-PASSWORD]@aws-0-ap-northeast-1.pooler.supabase.com:6543/postgres"
AUTH_SECRET="secret-key"
GOOGLE_CLIENT_SECRET="secret"

# å…¬é–‹ã•ã‚Œã‚‹ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚‚ä½¿ãˆã‚‹ï¼‰
NEXT_PUBLIC_SUPABASE_URL="https://xxx.supabase.co"
NEXT_PUBLIC_SUPABASE_ANON_KEY="xxx"
```

**ä½¿ã„æ–¹ï¼š**

```typescript
// ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®ã¿
const dbUrl = process.env.DATABASE_URL;

// ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚‚ä½¿ãˆã‚‹
const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
```

**é‡è¦ï¼š** `NEXT_PUBLIC_` ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’ã¤ã‘ã‚‹ã¨ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ã‚‚å…¬é–‹ã•ã‚Œã‚‹ã®ã§ã€ç§˜å¯†æƒ…å ±ã¯å…¥ã‚Œãªã„ï¼

---

## ã¾ã¨ã‚

ã“ã®ç« ã§ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆã«ã¤ã„ã¦å­¦ã³ã¾ã—ãŸï¼š

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

- âœ… **prisma/**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ
- âœ… **src/lib/**: ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ï¼ˆdbã€authã€supabaseï¼‰
- âœ… **src/app/**: App Router ã®ãƒšãƒ¼ã‚¸ã¨ã‚¢ãƒ”
- âœ… **src/components/**: å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### App Router

- âœ… **page.tsx**: ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- âœ… **layout.tsx**: ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- âœ… **route.ts**: API ãƒ«ãƒ¼ãƒˆ
- âœ… **[id]**: å‹•çš„ãƒ«ãƒ¼ãƒˆ

### è¨­è¨ˆåŸå‰‡

- âœ… **å°ã•ãåˆ†å‰²**: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å°ã•ãã€å†åˆ©ç”¨å¯èƒ½ã«
- âœ… **Server/Client åˆ†é›¢**: é©åˆ‡ã«ä½¿ã„åˆ†ã‘ã‚‹
- âœ… **å‹å®‰å…¨**: TypeScript ã§å‹ã‚’å®šç¾©
- âœ… **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆã€ç”»åƒæœ€é©åŒ–

æ¬¡ã®ç« ã§ã¯ã€**NextAuth.js ã«ã‚ˆã‚‹èªè¨¼ã‚·ã‚¹ãƒ†ãƒ **ã®å®Ÿè£…ã‚’è©³ã—ãè¦‹ã¦ã„ãã¾ã™ã€‚

---

[â† å‰ã®ç« ï¼šç¬¬ 8 ç«  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](08-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—.md) | [ç›®æ¬¡ã«æˆ»ã‚‹](00-ç›®æ¬¡.md) | [æ¬¡ã®ç« ã¸ï¼šç¬¬ 10 ç«  NextAuth.js ã«ã‚ˆã‚‹èªè¨¼ â†’](10-NextAuth.jsã«ã‚ˆã‚‹èªè¨¼.md)
