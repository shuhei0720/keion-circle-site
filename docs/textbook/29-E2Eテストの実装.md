# ç¬¬29ç« ï¼šE2Eãƒ†ã‚¹ãƒˆã®å®Ÿè£…ã€ãƒãƒ³ã‚ºã‚ªãƒ³ã€‘

> **ã“ã®ç« ã§ã¯ã€Playwright ã§å®Ÿéš›ã®ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ä½¿ã£ãŸ E2E ãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã—ã¾ã™**

## ğŸ› ï¸ **ãƒãƒ³ã‚ºã‚ªãƒ³ä½œæ¥­**

**âš ï¸ é‡è¦**: ã“ã®ç« ã§ã¯å®Ÿéš›ã«æ‰‹ã‚’å‹•ã‹ã—ã¦ E2E ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œãƒ•ãƒ­ãƒ¼ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ã€æŠ•ç¨¿ä½œæˆã€ã„ã„ã­ã€ã‚³ãƒ¡ãƒ³ãƒˆï¼‰ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚

> ğŸ’¡ **å‰æ**: ç¬¬26ç« ã€Œãƒ†ã‚¹ãƒˆç’°å¢ƒã®åŸºç¤ã€ã§ Playwright ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

## ğŸ“š ã“ã®ç« ã§å­¦ã¶ã“ã¨

- âœ… ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼ã®ãƒ†ã‚¹ãƒˆ
- âœ… æŠ•ç¨¿ä½œæˆã®ãƒ†ã‚¹ãƒˆ
- âœ… ã„ã„ã­æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ
- âœ… ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ
- âœ… ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ’®å½±

---

## 29.1 E2E ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

### Step 1: ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ä»¥ä¸‹ã®æ§‹é€ ã§ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã„ãã¾ã™ï¼š

```
tests/
â”œâ”€â”€ e2e/
â”‚   â”œâ”€â”€ auth.spec.ts          â† ä½œæˆï¼ˆèªè¨¼ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â”œâ”€â”€ posts.spec.ts         â† ä½œæˆï¼ˆæŠ•ç¨¿ãƒ†ã‚¹ãƒˆï¼‰
â”‚   â””â”€â”€ interactions.spec.ts  â† ä½œæˆï¼ˆã„ã„ã­ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆï¼‰
â””â”€â”€ fixtures/
    â””â”€â”€ test-data.ts          â† ä½œæˆï¼ˆãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ï¼‰
```

### Step 2: ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ

`tests/fixtures` ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¦ã€`test-data.ts` ã‚’é–‹ã„ã¦ä»¥ä¸‹ã‚’**ã™ã¹ã¦**å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š

```typescript
// tests/fixtures/test-data.ts

export const testUser = {
  email: 'test@example.com',
  password: 'test123',
  name: 'ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼',
};

export const testPost = {
  title: 'ãƒ†ã‚¹ãƒˆæŠ•ç¨¿',
  content: 'ã“ã‚Œã¯E2Eãƒ†ã‚¹ãƒˆç”¨ã®æŠ•ç¨¿ã§ã™ã€‚',
  youtubeUrls: ['https://www.youtube.com/watch?v=dQw4w9WgXcQ'],
};

export const testEvent = {
  title: 'ãƒ†ã‚¹ãƒˆã‚¤ãƒ™ãƒ³ãƒˆ',
  date: '2025-12-31',
  location: 'æ±äº¬',
};
```

---

## 29.2 èªè¨¼ãƒ•ãƒ­ãƒ¼ã®ãƒ†ã‚¹ãƒˆ

### Step 3: `tests/e2e` ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆ

```bash
mkdir -p tests/e2e
```

### Step 4: `tests/e2e/auth.spec.ts` ã‚’ä½œæˆã—ã¦ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’**ã™ã¹ã¦**å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š

```typescript
import { test, expect } from '@playwright/test';
import { testUser } from '../fixtures/test-data';

test.describe('èªè¨¼ãƒ•ãƒ­ãƒ¼', () => {

export default defineConfig({
  // ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
  testDir: './tests/e2e',

  // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
  timeout: 30000,
  expect: {
    timeout: 5000,
  },

  // ä¸¦åˆ—å®Ÿè¡Œ
  fullyParallel: true,
  workers: process.env.CI ? 1 : undefined,

  // å¤±æ•—æ™‚ã®ãƒªãƒˆãƒ©ã‚¤
  retries: process.env.CI ? 2 : 0,

  // ãƒ¬ãƒãƒ¼ãƒˆè¨­å®š
  reporter: [
    ['html'],
    ['list'],
    ['json', { outputFile: 'test-results/results.json' }],
  ],

  // å…±é€šè¨­å®š
  use: {
    // ãƒ™ãƒ¼ã‚¹URL
    baseURL: 'http://localhost:3000',

    // ãƒˆãƒ¬ãƒ¼ã‚¹ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
    trace: 'on-first-retry',

    // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
    screenshot: 'only-on-failure',

    // å‹•ç”»
    video: 'retain-on-failure',
  },

  // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šï¼ˆãƒ–ãƒ©ã‚¦ã‚¶åˆ¥ï¼‰
  projects: [
    {
      name: 'chromium',
      use: { ...devices['Desktop Chrome'] },
    },
    {
      name: 'firefox',
      use: { ...devices['Desktop Firefox'] },
    },
    {
      name: 'webkit',
      use: { ...devices['Desktop Safari'] },
    },
    // ãƒ¢ãƒã‚¤ãƒ«
    {
      name: 'Mobile Chrome',
      use: { ...devices['Pixel 5'] },
    },
    {
      name: 'Mobile Safari',
      use: { ...devices['iPhone 12'] },
    },
  ],

  // ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•
  webServer: {
    command: 'npm run dev',
    url: 'http://localhost:3000',
    reuseExistingServer: !process.env.CI,
    timeout: 120000,
  },
});
```

**ã“ã®ã‚³ãƒ¼ãƒ‰ã®è©³ã—ã„èª¬æ˜:**

#### 1. ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

```typescript
// ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
testDir: './tests/e2e',

// ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
timeout: 30000,     // 1ã¤ã®ãƒ†ã‚¹ãƒˆå…¨ä½“: 30ç§’
expect: {
  timeout: 5000,    // å€‹åˆ¥ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³: 5ç§’
},
```

**ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã®éšå±¤:**

```
timeout: 30000 (ãƒ†ã‚¹ãƒˆå…¨ä½“)
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ it('ãƒ†ã‚¹ãƒˆ', async () => {     â”‚
â”‚   await page.goto('/');        â”‚ â† æœ€å¤§30ç§’
â”‚   await expect(page)           â”‚
â”‚     .toHaveTitle('...');       â”‚ â† æœ€å¤§5ç§’ï¼ˆexpect.timeoutï¼‰
â”‚ });                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã®ä¾‹:**

```typescript
// âœ“ 2ç§’ã§å®Œäº† â†’ æˆåŠŸ
it('é€Ÿã„ãƒ†ã‚¹ãƒˆ', async ({ page }) => {
  await page.goto('/');  // 1ç§’
  await expect(page).toHaveTitle('BOLD'); // 0.5ç§’
});

// âœ— 31ç§’ã‹ã‹ã‚‹ â†’ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆtimeout: 30000ï¼‰
it('é…ã„ãƒ†ã‚¹ãƒˆ', async ({ page }) => {
  await page.goto('/very-slow-page');  // 31ç§’...
});
```

#### 2. ä¸¦åˆ—å®Ÿè¡Œã¨ãƒ¯ãƒ¼ã‚«ãƒ¼

```typescript
fullyParallel: true,  // ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’ä¸¦åˆ—å®Ÿè¡Œ
workers: process.env.CI ? 1 : undefined,
```

**ä¸¦åˆ—å®Ÿè¡Œã®åŠ¹æœ:**

```
ä¸¦åˆ—å®Ÿè¡Œãªã—ï¼ˆ1ãƒ¯ãƒ¼ã‚«ãƒ¼ï¼‰:
ãƒ†ã‚¹ãƒˆ1 â†’ ãƒ†ã‚¹ãƒˆ2 â†’ ãƒ†ã‚¹ãƒˆ3 â†’ ãƒ†ã‚¹ãƒˆ4
|â”€â”€â”€â”€â”€â”€â”€â”€â”€30ç§’â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€|

ä¸¦åˆ—å®Ÿè¡Œã‚ã‚Šï¼ˆ4ãƒ¯ãƒ¼ã‚«ãƒ¼ï¼‰:
ãƒ†ã‚¹ãƒˆ1 â”
ãƒ†ã‚¹ãƒˆ2 â”œâ†’ åŒæ™‚å®Ÿè¡Œ
ãƒ†ã‚¹ãƒˆ3 â”‚
ãƒ†ã‚¹ãƒˆ4 â”˜
|â”€7.5ç§’â”€|
```

**workers ã®è¨­å®š:**

```typescript
workers: process.env.CI ? 1 : undefined
```

- **ãƒ­ãƒ¼ã‚«ãƒ«**: `undefined` â†’ CPU ã‚³ã‚¢æ•°ã«å¿œã˜ã¦è‡ªå‹•ï¼ˆé€Ÿã„ï¼‰
- **CIç’°å¢ƒ**: `1` â†’ 1ã¤ãšã¤å®Ÿè¡Œï¼ˆãƒ¡ãƒ¢ãƒªç¯€ç´„ï¼‰

**å›³è§£:**

```
ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºï¼ˆworkers: undefinedï¼‰:
CPU 8ã‚³ã‚¢ â†’ æœ€å¤§8å€‹ã®ãƒ†ã‚¹ãƒˆã‚’ä¸¦åˆ—å®Ÿè¡Œ
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ãƒ†ã‚¹ãƒˆâ”‚ãƒ†ã‚¹ãƒˆâ”‚ãƒ†ã‚¹ãƒˆâ”‚ãƒ†ã‚¹ãƒˆâ”‚ãƒ†ã‚¹ãƒˆâ”‚ãƒ†ã‚¹ãƒˆâ”‚ãƒ†ã‚¹ãƒˆâ”‚ãƒ†ã‚¹ãƒˆâ”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

CIç’°å¢ƒï¼ˆworkers: 1ï¼‰:
ãƒ¡ãƒ¢ãƒªåˆ¶é™ã‚ã‚Š â†’ 1ã¤ãšã¤å®Ÿè¡Œ
â”Œâ”€â”€â”€â”€â”
â”‚ãƒ†ã‚¹ãƒˆâ”‚ â†’ æ¬¡ â†’ æ¬¡ â†’ ...
â””â”€â”€â”€â”€â”˜
```

#### 3. ãƒªãƒˆãƒ©ã‚¤è¨­å®š

```typescript
retries: process.env.CI ? 2 : 0,
```

- **ãƒ­ãƒ¼ã‚«ãƒ«**: ãƒªãƒˆãƒ©ã‚¤ãªã—ï¼ˆã™ãã«ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèªï¼‰
- **CIç’°å¢ƒ**: 2å›ãƒªãƒˆãƒ©ã‚¤ï¼ˆä¸€æ™‚çš„ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã«å¯¾å¿œï¼‰

**ãƒªãƒˆãƒ©ã‚¤ã®å‹•ã:**

```
ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1å›ç›®   â”‚ â†’ å¤±æ•—
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2å›ç›®   â”‚ â†’ å¤±æ•—ï¼ˆãƒªãƒˆãƒ©ã‚¤1å›ç›®ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3å›ç›®   â”‚ â†’ æˆåŠŸ âœ“
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
çµæœ: æˆåŠŸï¼ˆãƒªãƒˆãƒ©ã‚¤ã§å¾©æ—§ï¼‰
```

#### 4. ãƒ¬ãƒãƒ¼ãƒˆè¨­å®š

```typescript
reporter: [
  ['html'],   // HTMLãƒ¬ãƒãƒ¼ãƒˆ
  ['list'],   // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›
  ['json', { outputFile: 'test-results/results.json' }],  // JSON
],
```

**å„ãƒ¬ãƒãƒ¼ã‚¿ãƒ¼ã®ç‰¹å¾´:**

| ãƒ¬ãƒãƒ¼ã‚¿ãƒ¼ | å‡ºåŠ›å…ˆ | ç”¨é€” |
|-----------|--------|------|
| `html` | `playwright-report/index.html` | ãƒ–ãƒ©ã‚¦ã‚¶ã§è©³ç´°ç¢ºèª |
| `list` | ã‚³ãƒ³ã‚½ãƒ¼ãƒ« | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§é€²æ—ç¢ºèª |
| `json` | JSONãƒ•ã‚¡ã‚¤ãƒ« | CI/CDã§è§£æ |

**HTMLãƒ¬ãƒãƒ¼ãƒˆã®è¦‹æ–¹:**

```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¾Œ
npx playwright show-report

# â†’ ãƒ–ãƒ©ã‚¦ã‚¶ãŒé–‹ã
# â†’ æˆåŠŸ/å¤±æ•—ã®ä¸€è¦§ã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã€å‹•ç”»ãŒè¦‹ã‚Œã‚‹
```

#### 5. å…±é€šè¨­å®šï¼ˆuseï¼‰

```typescript
use: {
  baseURL: 'http://localhost:3000',
  trace: 'on-first-retry',
  screenshot: 'only-on-failure',
  video: 'retain-on-failure',
},
```

**5-1. baseURL**

```typescript
baseURL: 'http://localhost:3000',
```

- ç›¸å¯¾URLã‚’è‡ªå‹•çš„ã«è§£æ±º

```typescript
// ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
await page.goto('/posts');

// å®Ÿéš›ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã‚‹URL
// http://localhost:3000/posts
```

**5-2. traceï¼ˆãƒˆãƒ¬ãƒ¼ã‚¹ï¼‰**

```typescript
trace: 'on-first-retry',
```

- **ãƒˆãƒ¬ãƒ¼ã‚¹**: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã®è©³ç´°è¨˜éŒ²ï¼ˆDOMã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼‰
- **`on-first-retry`**: å¤±æ•—ã—ã¦åˆã‚ã¦ãƒªãƒˆãƒ©ã‚¤ã™ã‚‹æ™‚ã«è¨˜éŒ²

**ãƒˆãƒ¬ãƒ¼ã‚¹ã®å†…å®¹:**

```
ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ« (.zip)
â”œâ”€â”€ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆï¼ˆå„ã‚¹ãƒ†ãƒƒãƒ—ï¼‰
â”œâ”€â”€ DOM ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
â”œâ”€â”€ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
â”œâ”€â”€ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°
â””â”€â”€ ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³
```

**ç¢ºèªæ–¹æ³•:**

```bash
npx playwright show-trace test-results/trace.zip
```

**5-3. screenshotï¼ˆã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆï¼‰**

```typescript
screenshot: 'only-on-failure',
```

| è¨­å®šå€¤ | å‹•ä½œ |
|--------|------|
| `'off'` | æ’®ã‚‰ãªã„ |
| `'only-on-failure'` | å¤±æ•—æ™‚ã®ã¿ |
| `'on'` | å¸¸ã«æ’®ã‚‹ |

**å¤±æ•—æ™‚ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ:**

```
test-results/
â””â”€â”€ home-spec-ts-home-page-test-chromium/
    â””â”€â”€ test-failed-1.png  â† å¤±æ•—æ™‚ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
```

**5-4. videoï¼ˆå‹•ç”»éŒ²ç”»ï¼‰**

```typescript
video: 'retain-on-failure',
```

| è¨­å®šå€¤ | å‹•ä½œ |
|--------|------|
| `'off'` | éŒ²ç”»ã—ãªã„ |
| `'retain-on-failure'` | å¤±æ•—æ™‚ã®ã¿ä¿å­˜ |
| `'on'` | å¸¸ã«éŒ²ç”»ãƒ»ä¿å­˜ |

**å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«:**

```
test-results/
â””â”€â”€ home-spec-ts-home-page-test-chromium/
    â””â”€â”€ video.webm  â† ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã®å‹•ç”»
```

#### 6. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šï¼ˆãƒ–ãƒ©ã‚¦ã‚¶åˆ¥ï¼‰

```typescript
projects: [
  {
    name: 'chromium',
    use: { ...devices['Desktop Chrome'] },
  },
  {
    name: 'Mobile Chrome',
    use: { ...devices['Pixel 5'] },
  },
],
```

**devices ã¨ã¯ï¼Ÿ**

- Playwright ãŒæä¾›ã™ã‚‹**ãƒ‡ãƒã‚¤ã‚¹ãƒ—ãƒªã‚»ãƒƒãƒˆ**
- ç”»é¢ã‚µã‚¤ã‚ºã€User-Agentã€ã‚¿ãƒƒãƒå¯¾å¿œãªã©ã‚’è¨­å®šæ¸ˆã¿

**åˆ©ç”¨å¯èƒ½ãªãƒ‡ãƒã‚¤ã‚¹:**

```typescript
devices['Desktop Chrome']       // ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ— Chrome
devices['Desktop Firefox']      // ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ— Firefox
devices['Desktop Safari']       // ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ— Safari
devices['iPhone 12']            // iPhone 12
devices['iPhone 13 Pro']        // iPhone 13 Pro
devices['Pixel 5']              // Pixel 5
devices['iPad Pro']             // iPad Pro
devices['Galaxy S9+']           // Galaxy S9+
```

**ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚ã®æŒ™å‹•:**

```bash
$ npx playwright test

Running 5 tests using 5 workers
  âœ“ chromium: test1        (3s)
  âœ“ firefox: test1         (2s)
  âœ“ webkit: test1          (3s)
  âœ“ Mobile Chrome: test1   (2s)
  âœ“ Mobile Safari: test1   (3s)
```

#### 7. webServerï¼ˆé–‹ç™ºã‚µãƒ¼ãƒãƒ¼è‡ªå‹•èµ·å‹•ï¼‰

```typescript
webServer: {
  command: 'npm run dev',                   // èµ·å‹•ã‚³ãƒãƒ³ãƒ‰
  url: 'http://localhost:3000',             // ç¢ºèªURL
  reuseExistingServer: !process.env.CI,     // æ—¢å­˜ã‚µãƒ¼ãƒãƒ¼ã‚’å†åˆ©ç”¨
  timeout: 120000,                          // èµ·å‹•å¾…ã¡æ™‚é–“: 120ç§’
},
```

**å‹•ä½œã®æµã‚Œ:**

```
1. Playwrightãƒ†ã‚¹ãƒˆé–‹å§‹
   â†“
2. http://localhost:3000 ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ï¼Ÿ
   â†“ ã„ã„ãˆ
3. `npm run dev` ã‚’å®Ÿè¡Œ
   â†“
4. 120ç§’ä»¥å†…ã«ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã™ã‚‹ã¾ã§å¾…ã¤
   â†“
5. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
   â†“
6. ãƒ†ã‚¹ãƒˆçµ‚äº†å¾Œã€ã‚µãƒ¼ãƒãƒ¼ã‚’åœæ­¢
```

**reuseExistingServer ã®å‹•ä½œ:**

```typescript
reuseExistingServer: !process.env.CI
```

| ç’°å¢ƒ | è¨­å®šå€¤ | å‹•ä½œ |
|------|--------|------|
| ãƒ­ãƒ¼ã‚«ãƒ« | `true` | æ—¢å­˜ã‚µãƒ¼ãƒãƒ¼ãŒã‚ã‚Œã°å†åˆ©ç”¨ |
| CI | `false` | å¸¸ã«æ–°è¦èµ·å‹• |

**ãƒ¡ãƒªãƒƒãƒˆ:**

```
ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º:
æ—¢ã« `npm run dev` ã§ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ä¸­
â†’ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚ã«å†èµ·å‹•ä¸è¦ï¼ˆé€Ÿã„ï¼‰ âœ“

CIç’°å¢ƒ:
å¸¸ã«ã‚¯ãƒªãƒ¼ãƒ³ãªçŠ¶æ…‹ã§ãƒ†ã‚¹ãƒˆ
â†’ ä»–ã®ãƒ†ã‚¹ãƒˆã®å½±éŸ¿ã‚’å—ã‘ãªã„ âœ“
```

> ğŸ’¡ **åˆå¿ƒè€…ã¸ã®è£œè¶³:**
> - **ä¸¦åˆ—å®Ÿè¡Œ**: è¤‡æ•°ã®ãƒ†ã‚¹ãƒˆã‚’åŒæ™‚ã«å®Ÿè¡Œï¼ˆé«˜é€ŸåŒ–ï¼‰
> - **ãƒªãƒˆãƒ©ã‚¤**: å¤±æ•—ã—ãŸãƒ†ã‚¹ãƒˆã‚’è‡ªå‹•çš„ã«å†å®Ÿè¡Œ
> - **ãƒˆãƒ¬ãƒ¼ã‚¹**: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã®è©³ç´°è¨˜éŒ²ï¼ˆãƒ‡ãƒãƒƒã‚°ã«ä¾¿åˆ©ï¼‰
> - **webServer**: ãƒ†ã‚¹ãƒˆå‰ã«ã‚µãƒ¼ãƒãƒ¼ã‚’è‡ªå‹•èµ·å‹•
> 
> **æœ€åˆã®è¨­å®šã¯ã‚·ãƒ³ãƒ—ãƒ«ã§OK:**
> ```typescript
> export default defineConfig({
>   testDir: './tests/e2e',
>   use: {
>     baseURL: 'http://localhost:3000',
>   },
>   projects: [
>     { name: 'chromium', use: { ...devices['Desktop Chrome'] } },
>   ],
> });
> ```

### package.json ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ 

```json
{
  "scripts": {
    "test:e2e": "playwright test",
    "test:e2e:ui": "playwright test --ui",
    "test:e2e:debug": "playwright test --debug",
    "test:e2e:headed": "playwright test --headed",
    "test:e2e:report": "playwright show-report"
  }
}
```

**å„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è©³ç´°:**

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ | ä½¿ç”¨å ´é¢ |
|---------|------|---------|
| `npm run test:e2e` | ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œï¼ˆãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ï¼‰ | CI/CDã€æœ€çµ‚ç¢ºèª |
| `npm run test:e2e:ui` | UI ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œ | é–‹ç™ºä¸­ï¼ˆãŠã™ã™ã‚ï¼‰ |
| `npm run test:e2e:debug` | ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ | ãƒ†ã‚¹ãƒˆå¤±æ•—ã®åŸå› èª¿æŸ» |
| `npm run test:e2e:headed` | ãƒ–ãƒ©ã‚¦ã‚¶ã‚’è¡¨ç¤ºã—ã¦å®Ÿè¡Œ | å®Ÿéš›ã®å‹•ä½œã‚’ç›®ã§ç¢ºèª |
| `npm run test:e2e:report` | HTMLãƒ¬ãƒãƒ¼ãƒˆã‚’é–‹ã | çµæœã®è©³ç´°ç¢ºèª |

**å„ãƒ¢ãƒ¼ãƒ‰ã®é•ã„:**

#### 1. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå®Ÿè¡Œï¼ˆãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ï¼‰

```bash
npm run test:e2e
```

- **ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹**: ãƒ–ãƒ©ã‚¦ã‚¶ãŒè¡¨ç¤ºã•ã‚Œãªã„ï¼ˆé«˜é€Ÿï¼‰
- **ä¸¦åˆ—å®Ÿè¡Œ**: è¤‡æ•°ã®ãƒ†ã‚¹ãƒˆã‚’åŒæ™‚å®Ÿè¡Œ
- **CI/CDå‘ã**: GitHub Actions ãªã©ã§ä½¿ç”¨

```
å®Ÿè¡Œã‚¤ãƒ¡ãƒ¼ã‚¸:
$ npm run test:e2e

Running 15 tests using 8 workers
  âœ“ [chromium] home.spec.ts:5:7 â€º ã‚¿ã‚¤ãƒˆãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹ (2s)
  âœ“ [chromium] home.spec.ts:12:7 â€º ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ (1s)
  ...
  15 passed (12s)
```

#### 2. UI ãƒ¢ãƒ¼ãƒ‰ï¼ˆ`--ui`ï¼‰

```bash
npm run test:e2e:ui
```

- **å¯¾è©±å‹**: ãƒ†ã‚¹ãƒˆã‚’é¸æŠã—ã¦å®Ÿè¡Œ
- **ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œ**: 1ã‚¹ãƒ†ãƒƒãƒ—ãšã¤ç¢ºèª
- **DOMãƒ„ãƒªãƒ¼**: è¦ç´ ã‚’å¯è¦–åŒ–
- **é–‹ç™ºä¸­ã«æœ€é©**

```
UI ãƒ¢ãƒ¼ãƒ‰ã®æ©Ÿèƒ½:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ†ã‚¹ãƒˆä¸€è¦§                      â”‚
â”‚ âœ“ home.spec.ts                 â”‚
â”‚   âœ“ ã‚¿ã‚¤ãƒˆãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹       â”‚
â”‚   âœ— ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼         â”‚ â† ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°è¡¨ç¤º
â”‚                                â”‚
â”‚ ãƒ–ãƒ©ã‚¦ã‚¶ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚  [å®Ÿéš›ã®ãƒšãƒ¼ã‚¸è¡¨ç¤º]      â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                â”‚
â”‚ ã‚¹ãƒ†ãƒƒãƒ—:                       â”‚
â”‚ 1. page.goto('/')              â”‚
â”‚ 2. expect(page).toHaveTitle()  â”‚ â† å¤±æ•—ã—ãŸã‚¹ãƒ†ãƒƒãƒ—
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ï¼ˆ`--debug`ï¼‰

```bash
npm run test:e2e:debug
```

- **ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆ**: ã‚³ãƒ¼ãƒ‰ã‚’ä¸€æ™‚åœæ­¢
- **Playwright Inspector**: é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«
- **ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œ**: 1è¡Œãšã¤å®Ÿè¡Œ

```
ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã®å‹•ã:
1. ãƒ†ã‚¹ãƒˆé–‹å§‹
   â†“
2. ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã§åœæ­¢
   â†“
3. Playwright Inspector ãŒé–‹ã
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Console                 â”‚
   â”‚ > page.goto('/')        â”‚
   â”‚                         â”‚
   â”‚ [Step Over] [Resume]    â”‚ â† ãƒœã‚¿ãƒ³ã§åˆ¶å¾¡
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
4. ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œã§é€²ã‚ã‚‹
```

**ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã®è¨­å®š:**

```typescript
test('ãƒ‡ãƒãƒƒã‚°ä¾‹', async ({ page }) => {
  await page.goto('/');
  
  await page.pause();  // â† ã“ã“ã§ä¸€æ™‚åœæ­¢
  
  await expect(page).toHaveTitle('BOLD');
});
```

#### 4. ãƒ˜ãƒƒãƒ‰ä»˜ãå®Ÿè¡Œï¼ˆ`--headed`ï¼‰

```bash
npm run test:e2e:headed
```

- **ãƒ–ãƒ©ã‚¦ã‚¶è¡¨ç¤º**: å®Ÿéš›ã®ãƒ–ãƒ©ã‚¦ã‚¶ãŒé–‹ã
- **ç›®è¦–ç¢ºèª**: å‹•ä½œã‚’ç›®ã§è¦‹ã¦ç¢ºèª
- **ã‚¹ãƒ”ãƒ¼ãƒ‰ã¯é…ã„**: ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ã‚ˆã‚Šé…ã„

```
ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ï¼ˆ--headed ãªã—ï¼‰:
[ç”»é¢ãªã—] â†’ é«˜é€Ÿ
ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­ã€ä½•ã‚‚è¦‹ãˆãªã„

ãƒ˜ãƒƒãƒ‰ä»˜ãï¼ˆ--headedï¼‰:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Chromium ãƒ–ãƒ©ã‚¦ã‚¶]  â”‚ â† å®Ÿéš›ã«è¡¨ç¤ºã•ã‚Œã‚‹
â”‚                      â”‚
â”‚ ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯...    â”‚
â”‚ ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›...      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5. ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤ºï¼ˆ`show-report`ï¼‰

```bash
npm run test:e2e:report
```

- **HTML ãƒ¬ãƒãƒ¼ãƒˆ**: ãƒ†ã‚¹ãƒˆçµæœã‚’è¦–è¦šåŒ–
- **ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ**: å¤±æ•—æ™‚ã®ç”»é¢
- **ãƒˆãƒ¬ãƒ¼ã‚¹**: è©³ç´°ãªå®Ÿè¡Œãƒ­ã‚°
- **å‹•ç”»**: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã®å‹•ç”»

```
HTML ãƒ¬ãƒãƒ¼ãƒˆã®å†…å®¹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Playwright Report              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tests Passed: 12               â”‚
â”‚ Tests Failed: 3                â”‚
â”‚                                â”‚
â”‚ âœ— ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½                  â”‚ â† ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°
â”‚   â”œâ”€â”€ Screenshot.png           â”‚
â”‚   â”œâ”€â”€ Video.webm               â”‚
â”‚   â””â”€â”€ Trace.zip                â”‚
â”‚                                â”‚
â”‚ âœ“ ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸è¡¨ç¤º              â”‚
â”‚ âœ“ æŠ•ç¨¿ä¸€è¦§                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼:**

```
é–‹ç™ºä¸­:
npm run test:e2e:ui
â†’ UIãƒ¢ãƒ¼ãƒ‰ã§é–‹ç™ºã—ãªãŒã‚‰ãƒ†ã‚¹ãƒˆ

ãƒ†ã‚¹ãƒˆå¤±æ•—:
npm run test:e2e:debug
â†’ ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§åŸå› èª¿æŸ»

å‹•ä½œç¢ºèª:
npm run test:e2e:headed
â†’ ãƒ–ãƒ©ã‚¦ã‚¶ã§ç›®è¦–ç¢ºèª

æœ€çµ‚ãƒã‚§ãƒƒã‚¯:
npm run test:e2e
â†’ ã™ã¹ã¦ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ†ã‚¹ãƒˆ

çµæœç¢ºèª:
npm run test:e2e:report
â†’ HTML ãƒ¬ãƒãƒ¼ãƒˆã§è©³ç´°ç¢ºèª
```

> ğŸ’¡ **åˆå¿ƒè€…ã¸ã®ãŠã™ã™ã‚:**
> 1. **æœ€åˆã¯ `--ui` ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ã†** â†’ ç›´æ„Ÿçš„ã§åˆ†ã‹ã‚Šã‚„ã™ã„
> 2. **å¤±æ•—ã—ãŸã‚‰ `--debug` ãƒ¢ãƒ¼ãƒ‰** â†’ åŸå› ã‚’ç‰¹å®šã—ã‚„ã™ã„
> 3. **æœ€å¾Œã«é€šå¸¸å®Ÿè¡Œ** â†’ ã™ã¹ã¦ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§å‹•ä½œç¢ºèª
> 
> **ã‚³ãƒãƒ³ãƒ‰ã®è¦šãˆæ–¹:**
> - `--ui` â†’ User Interfaceï¼ˆç”»é¢ä»˜ãï¼‰
> - `--debug` â†’ Debugï¼ˆãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ï¼‰
> - `--headed` â†’ Headï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®é ­ãŒè¦‹ãˆã‚‹ï¼‰

---

## 28.3 åŸºæœ¬çš„ãªãƒ†ã‚¹ãƒˆã®ä½œæˆ

### ãƒ†ã‚¹ãƒˆã®åŸºæœ¬æ§‹é€ 

Playwright ã®ãƒ†ã‚¹ãƒˆã¯ã€å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã‚’**ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ**ã—ã¾ã™ã€‚

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œ:
1. ãƒšãƒ¼ã‚¸ã‚’é–‹ã
2. ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›
4. çµæœã‚’ç¢ºèª

Playwright ã®ãƒ†ã‚¹ãƒˆ:
1. await page.goto('/')
2. await page.click('button')
3. await page.fill('input', 'text')
4. await expect(page).toHaveText('OK')
```

**åŸºæœ¬çš„ãª API:**

| API | èª¬æ˜ | ä¾‹ |
|-----|------|---|
| `page.goto()` | ãƒšãƒ¼ã‚¸ã«ç§»å‹• | `await page.goto('/posts')` |
| `page.click()` | ã‚¯ãƒªãƒƒã‚¯ | `await page.click('button')` |
| `page.fill()` | ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ› | `await page.fill('input', 'text')` |
| `page.getByText()` | ãƒ†ã‚­ã‚¹ãƒˆã§è¦ç´ ã‚’å–å¾— | `page.getByText('ãƒ­ã‚°ã‚¤ãƒ³')` |
| `page.getByRole()` | ãƒ­ãƒ¼ãƒ«ã§è¦ç´ ã‚’å–å¾— | `page.getByRole('button')` |
| `expect()` | ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ | `await expect(page).toHaveTitle('...')` |

### ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã®ãƒ†ã‚¹ãƒˆ

**tests/e2e/home.spec.ts ã‚’ä½œæˆ:**

```typescript
// tests/e2e/home.spec.ts
import { test, expect } from '@playwright/test';

test.describe('ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸', () => {
  test('ã‚¿ã‚¤ãƒˆãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async ({ page }) => {
    // Arrange: ãƒšãƒ¼ã‚¸ã«ç§»å‹•
    await page.goto('/');
    
    // Assert: ã‚¿ã‚¤ãƒˆãƒ«ã‚’æ¤œè¨¼
    await expect(page).toHaveTitle(/BOLD è»½éŸ³/);
  });

  test('ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async ({ page }) => {
    await page.goto('/');
    
    // ãƒ­ã‚´ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByText('ğŸ¸ BOLD è»½éŸ³')).toBeVisible();
    
    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByRole('link', { name: 'ãƒ›ãƒ¼ãƒ ' })).toBeVisible();
    await expect(page.getByRole('link', { name: 'æŠ•ç¨¿' })).toBeVisible();
    await expect(page.getByRole('link', { name: 'ã‚¤ãƒ™ãƒ³ãƒˆ' })).toBeVisible();
  });

  test('ãƒ•ãƒƒã‚¿ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async ({ page }) => {
    await page.goto('/');
    
    await expect(page.getByText('Â© 2025 BOLD è»½éŸ³')).toBeVisible();
  });

  test('ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒå‹•ä½œã™ã‚‹', async ({ page }) => {
    // ãƒ¢ãƒã‚¤ãƒ«ã‚µã‚¤ã‚ºã«å¤‰æ›´
    await page.setViewportSize({ width: 375, height: 667 }); // iPhone SE
    await page.goto('/');
    
    // ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯
    await page.getByRole('button', { name: 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼' }).click();
    
    // ãƒ¢ãƒã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByRole('link', { name: 'ãƒ›ãƒ¼ãƒ ' })).toBeVisible();
  });
});
```

**ã“ã®ã‚³ãƒ¼ãƒ‰ã®è©³ã—ã„èª¬æ˜:**

#### 1. `test.describe()` - ãƒ†ã‚¹ãƒˆã®ã‚°ãƒ«ãƒ¼ãƒ—åŒ–

```typescript
test.describe('ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸', () => {
  // ã“ã®ä¸­ã«è¤‡æ•°ã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ã
});
```

- **å½¹å‰²**: é–¢é€£ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’ã¾ã¨ã‚ã‚‹ï¼ˆJest ã® `describe` ã¨åŒã˜ï¼‰
- **ãƒ¬ãƒãƒ¼ãƒˆ**: ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«çµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹

```
ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆ:
ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸
  âœ“ ã‚¿ã‚¤ãƒˆãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹
  âœ“ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹
  âœ“ ãƒ•ãƒƒã‚¿ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹
  âœ“ ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒå‹•ä½œã™ã‚‹
```

#### 2. `test()` - å€‹åˆ¥ã®ãƒ†ã‚¹ãƒˆ

```typescript
test('ã‚¿ã‚¤ãƒˆãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async ({ page }) => {
  // ...
});
```

- **ç¬¬1å¼•æ•°**: ãƒ†ã‚¹ãƒˆã®èª¬æ˜
- **ç¬¬2å¼•æ•°**: éåŒæœŸé–¢æ•°
- **`{ page }`**: Playwright ãŒæä¾›ã™ã‚‹ãƒšãƒ¼ã‚¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

**`page` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã¯ï¼Ÿ**

```typescript
// page = ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¿ãƒ–
const page = await browser.newPage();

// ãƒšãƒ¼ã‚¸æ“ä½œ
await page.goto('/');       // ãƒšãƒ¼ã‚¸ã«ç§»å‹•
await page.click('button'); // ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
await page.fill('input', 'text'); // ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›
```

#### 3. `page.goto()` - ãƒšãƒ¼ã‚¸ã«ç§»å‹•

```typescript
await page.goto('/');
```

- **ç›¸å¯¾URL**: `baseURL` ã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹
- **çµ¶å¯¾URL**: `await page.goto('https://example.com')`
- **è‡ªå‹•å¾…æ©Ÿ**: ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã‚’å¾…ã¤

**è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¨ã®é–¢ä¿‚:**

```typescript
// playwright.config.ts
use: {
  baseURL: 'http://localhost:3000',
}

// ãƒ†ã‚¹ãƒˆ
await page.goto('/');
// â†’ http://localhost:3000/ ã«ã‚¢ã‚¯ã‚»ã‚¹

await page.goto('/posts');
// â†’ http://localhost:3000/posts ã«ã‚¢ã‚¯ã‚»ã‚¹
```

#### 4. `page.getByText()` - ãƒ†ã‚­ã‚¹ãƒˆã§è¦ç´ ã‚’å–å¾—

```typescript
await expect(page.getByText('ğŸ¸ BOLD è»½éŸ³')).toBeVisible();
```

- **å½¹å‰²**: æŒ‡å®šã—ãŸãƒ†ã‚­ã‚¹ãƒˆã‚’å«ã‚€è¦ç´ ã‚’å–å¾—
- **éƒ¨åˆ†ä¸€è‡´**: å®Œå…¨ä¸€è‡´ã§ãªãã¦ã‚‚OK

**ä¾‹:**

```html
<h1>ğŸ¸ BOLD è»½éŸ³ã‚µãƒ¼ã‚¯ãƒ«</h1>
```

```typescript
// âœ“ OKï¼ˆéƒ¨åˆ†ä¸€è‡´ï¼‰
page.getByText('BOLD')
page.getByText('ğŸ¸ BOLD')
page.getByText('è»½éŸ³')

// âœ“ OKï¼ˆå®Œå…¨ä¸€è‡´ï¼‰
page.getByText('ğŸ¸ BOLD è»½éŸ³ã‚µãƒ¼ã‚¯ãƒ«', { exact: true })

// âœ— NGï¼ˆexact: true ã§å®Œå…¨ä¸€è‡´ã‚’è¦æ±‚ï¼‰
page.getByText('BOLD', { exact: true })
```

#### 5. `page.getByRole()` - ãƒ­ãƒ¼ãƒ«ã§è¦ç´ ã‚’å–å¾—

```typescript
await expect(page.getByRole('link', { name: 'ãƒ›ãƒ¼ãƒ ' })).toBeVisible();
```

- **ãƒ­ãƒ¼ãƒ«**: HTMLè¦ç´ ã®ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ­ãƒ¼ãƒ«
- **name**: è¦ç´ ã®ãƒ†ã‚­ã‚¹ãƒˆã‚„ `aria-label`

**ä¸»ãªãƒ­ãƒ¼ãƒ«:**

| ãƒ­ãƒ¼ãƒ« | å¯¾å¿œã™ã‚‹è¦ç´  | ä¾‹ |
|--------|-------------|---|
| `button` | `<button>`, `role="button"` | `getByRole('button')` |
| `link` | `<a>` | `getByRole('link', { name: 'ãƒ›ãƒ¼ãƒ ' })` |
| `textbox` | `<input type="text">` | `getByRole('textbox')` |
| `heading` | `<h1>`, `<h2>`, ... | `getByRole('heading', { level: 1 })` |
| `img` | `<img>` | `getByRole('img', { name: 'Logo' })` |

**ãªãœãƒ­ãƒ¼ãƒ«ã‚’ä½¿ã†ã®ã‹ï¼Ÿ**

```
âœ“ ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ã«å„ªã—ã„
âœ“ å®Ÿè£…ã®å¤‰æ›´ã«å¼·ã„ï¼ˆclassåãŒå¤‰ã‚ã£ã¦ã‚‚å‹•ãï¼‰
âœ“ ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦–ç‚¹ã®ãƒ†ã‚¹ãƒˆï¼ˆã€Œãƒœã‚¿ãƒ³ã€ã¨ã—ã¦èªè­˜ã•ã‚Œã‚‹è¦ç´ ã‚’å–å¾—ï¼‰
```

**ä¾‹:**

```html
<!-- ã©ã¡ã‚‰ã‚‚ "button" ãƒ­ãƒ¼ãƒ«ã¨ã—ã¦èªè­˜ -->
<button>é€ä¿¡</button>
<div role="button" onclick="submit()">é€ä¿¡</div>
```

```typescript
// ã©ã¡ã‚‰ã‚‚å–å¾—ã§ãã‚‹
page.getByRole('button', { name: 'é€ä¿¡' })
```

#### 6. `toBeVisible()` - è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹

```typescript
await expect(page.getByText('ğŸ¸ BOLD è»½éŸ³')).toBeVisible();
```

- **æ¤œè¨¼**: è¦ç´ ãŒDOM ã«å­˜åœ¨ã—ã€ã‹ã¤è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹
- **è‡ªå‹•å¾…æ©Ÿ**: è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§æœ€å¤§5ç§’å¾…ã¤

**`toBeVisible()` ã®æ¡ä»¶:**

```
âœ“ DOMã«å­˜åœ¨ã™ã‚‹
âœ“ display: none ã§ã¯ãªã„
âœ“ visibility: hidden ã§ã¯ãªã„
âœ“ opacity: 0 ã§ã¯ãªã„
âœ“ è¦ªè¦ç´ ã«éš ã•ã‚Œã¦ã„ãªã„
```

**ä¾‹:**

```html
<!-- âœ“ è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ -->
<div>Hello</div>

<!-- âœ— è¡¨ç¤ºã•ã‚Œã¦ã„ãªã„ -->
<div style="display: none;">Hello</div>
<div style="visibility: hidden;">Hello</div>
<div style="opacity: 0;">Hello</div>
```

#### 7. `page.setViewportSize()` - ç”»é¢ã‚µã‚¤ã‚ºã®å¤‰æ›´

```typescript
await page.setViewportSize({ width: 375, height: 667 }); // iPhone SE
```

- **å½¹å‰²**: ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã‚µã‚¤ã‚ºã‚’å¤‰æ›´
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ†ã‚¹ãƒˆ**: ãƒ¢ãƒã‚¤ãƒ«/ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ/ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚’ãƒ†ã‚¹ãƒˆ

**ã‚ˆãä½¿ã†ã‚µã‚¤ã‚º:**

| ãƒ‡ãƒã‚¤ã‚¹ | å¹… Ã— é«˜ã• | ã‚³ãƒ¼ãƒ‰ |
|---------|----------|--------|
| iPhone SE | 375 Ã— 667 | `{ width: 375, height: 667 }` |
| iPhone 12 | 390 Ã— 844 | `{ width: 390, height: 844 }` |
| iPad | 768 Ã— 1024 | `{ width: 768, height: 1024 }` |
| Desktop | 1920 Ã— 1080 | `{ width: 1920, height: 1080 }` |

**å›³è§£:**

```
ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ï¼ˆ1920pxï¼‰:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ãƒ­ã‚´] [ãƒ›ãƒ¼ãƒ ][æŠ•ç¨¿][ã‚¤ãƒ™ãƒ³ãƒˆ] â”‚ â† æ¨ªä¸¦ã³
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ãƒ¢ãƒã‚¤ãƒ«ï¼ˆ375pxï¼‰:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ãƒ­ã‚´] [â˜°]   â”‚ â† ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> ğŸ’¡ **åˆå¿ƒè€…ã¸ã®è£œè¶³:**
> - **`page`**: ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¿ãƒ–1ã¤
> - **`getByText()`**: ã€Œã“ã®ãƒ†ã‚­ã‚¹ãƒˆãŒæ›¸ã„ã¦ã‚ã‚‹è¦ç´ ã¯ã©ã“ï¼Ÿã€
> - **`getByRole()`**: ã€Œãƒœã‚¿ãƒ³ã®å½¹å‰²ã‚’æŒã¤è¦ç´ ã¯ã©ã“ï¼Ÿã€
> - **`toBeVisible()`**: ã€Œã“ã®è¦ç´ ã¯ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã¦ã‚‹ï¼Ÿã€
> 
> **å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã‚’ã‚³ãƒ¼ãƒ‰ã§è¡¨ç¾:**
> ```
> ãƒ¦ãƒ¼ã‚¶ãƒ¼: ã€Œãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã‚’é–‹ãã€
> â†’ await page.goto('/')
> 
> ãƒ¦ãƒ¼ã‚¶ãƒ¼: ã€Œã‚¿ã‚¤ãƒˆãƒ«ãŒè¦‹ãˆã‚‹ã€
> â†’ await expect(page).toHaveTitle('...')
> 
> ãƒ¦ãƒ¼ã‚¶ãƒ¼: ã€Œãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã€
> â†’ await page.click('button')
> ```

### æŠ•ç¨¿ä¸€è¦§ãƒšãƒ¼ã‚¸ã®ãƒ†ã‚¹ãƒˆ

**tests/e2e/posts.spec.ts ã‚’ä½œæˆ:**

```typescript
// tests/e2e/posts.spec.ts
import { test, expect } from '@playwright/test';

test.describe('æŠ•ç¨¿ä¸€è¦§ãƒšãƒ¼ã‚¸', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/posts');
  });

  test('æŠ•ç¨¿ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async ({ page }) => {
    // æŠ•ç¨¿ã‚¿ã‚¤ãƒˆãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByRole('heading', { level: 2 })).toBeVisible();
    
    // æŠ•ç¨¿ã‚«ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    const postCards = page.locator('[data-testid="post-card"]');
    await expect(postCards).toHaveCount(await postCards.count());
  });

  test('æŠ•ç¨¿ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨è©³ç´°ãƒšãƒ¼ã‚¸ã«é·ç§»', async ({ page }) => {
    // æœ€åˆã®æŠ•ç¨¿ã‚’ã‚¯ãƒªãƒƒã‚¯
    await page.locator('[data-testid="post-card"]').first().click();
    
    // è©³ç´°ãƒšãƒ¼ã‚¸ã«é·ç§»
    await expect(page).toHaveURL(/\/posts\/.+/);
    
    // è©³ç´°ãƒšãƒ¼ã‚¸ã®è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByRole('heading', { level: 1 })).toBeVisible();
  });

  test('æ¤œç´¢æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹', async ({ page }) => {
    // æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã«å…¥åŠ›
    await page.getByPlaceholder('æŠ•ç¨¿ã‚’æ¤œç´¢').fill('ãƒ†ã‚¹ãƒˆ');
    
    // æ¤œç´¢çµæœãŒçµã‚Šè¾¼ã¾ã‚Œã‚‹
    const results = page.locator('[data-testid="post-card"]');
    const count = await results.count();
    
    // æ¤œç´¢èªã‚’å«ã‚€æŠ•ç¨¿ã®ã¿è¡¨ç¤ºã•ã‚Œã‚‹
    for (let i = 0; i < count; i++) {
      const text = await results.nth(i).textContent();
      expect(text?.toLowerCase()).toContain('ãƒ†ã‚¹ãƒˆ');
    }
  });
});
```

---

## 28.4 èªè¨¼ãƒ•ãƒ­ãƒ¼ã®ãƒ†ã‚¹ãƒˆ

### ãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ

**tests/e2e/auth.spec.ts ã‚’ä½œæˆ:**

```typescript
// tests/e2e/auth.spec.ts
import { test, expect } from '@playwright/test';

test.describe('èªè¨¼', () => {
  test('ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async ({ page }) => {
    await page.goto('/login');
    
    await expect(page.getByRole('heading', { name: 'ãƒ­ã‚°ã‚¤ãƒ³' })).toBeVisible();
    await expect(page.getByLabel('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹')).toBeVisible();
    await expect(page.getByLabel('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰')).toBeVisible();
    await expect(page.getByRole('button', { name: 'ãƒ­ã‚°ã‚¤ãƒ³' })).toBeVisible();
  });

  test('ç©ºã®ãƒ•ã‚©ãƒ¼ãƒ ã§é€ä¿¡ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async ({ page }) => {
    await page.goto('/login');
    
    await page.getByRole('button', { name: 'ãƒ­ã‚°ã‚¤ãƒ³' }).click();
    
    await expect(page.getByText('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„')).toBeVisible();
  });

  test('æ­£ã—ã„èªè¨¼æƒ…å ±ã§ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹', async ({ page }) => {
    await page.goto('/login');
    
    // èªè¨¼æƒ…å ±ã‚’å…¥åŠ›
    await page.getByLabel('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹').fill('admin@test.com');
    await page.getByLabel('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰').fill('admin123');
    
    // ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    await page.getByRole('button', { name: 'ãƒ­ã‚°ã‚¤ãƒ³' }).click();
    
    // ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    await expect(page).toHaveURL('/');
    
    // ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã®ç¢ºèªï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼‰
    await expect(page.getByText('Admin User')).toBeVisible();
  });

  test('é–“é•ã£ãŸèªè¨¼æƒ…å ±ã§ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„', async ({ page }) => {
    await page.goto('/login');
    
    await page.getByLabel('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹').fill('admin@test.com');
    await page.getByLabel('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰').fill('wrongpassword');
    
    await page.getByRole('button', { name: 'ãƒ­ã‚°ã‚¤ãƒ³' }).click();
    
    // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByText('ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ')).toBeVisible();
  });

  test('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã§ãã‚‹', async ({ page }) => {
    // å…ˆã«ãƒ­ã‚°ã‚¤ãƒ³
    await page.goto('/login');
    await page.getByLabel('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹').fill('admin@test.com');
    await page.getByLabel('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰').fill('admin123');
    await page.getByRole('button', { name: 'ãƒ­ã‚°ã‚¤ãƒ³' }).click();
    await page.waitForURL('/');
    
    // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
    await page.getByRole('button', { name: 'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ' }).click();
    
    // ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    await expect(page).toHaveURL('/login');
  });
});
```

### èªè¨¼çŠ¶æ…‹ã®ä¿æŒ

**tests/helpers/auth.ts ã‚’ä½œæˆ:**

```typescript
// tests/helpers/auth.ts
import { Page } from '@playwright/test';

export async function login(
  page: Page,
  email: string = 'admin@test.com',
  password: string = 'admin123'
) {
  await page.goto('/login');
  await page.getByLabel('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹').fill(email);
  await page.getByLabel('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰').fill(password);
  await page.getByRole('button', { name: 'ãƒ­ã‚°ã‚¤ãƒ³' }).click();
  await page.waitForURL('/');
}

export async function loginAsAdmin(page: Page) {
  await login(page, 'admin@test.com', 'admin123');
}

export async function loginAsMember(page: Page) {
  await login(page, 'member@test.com', 'member123');
}
```

**èªè¨¼çŠ¶æ…‹ã‚’ä½¿ã£ãŸãƒ†ã‚¹ãƒˆ:**

```typescript
// tests/e2e/posts-create.spec.ts
import { test, expect } from '@playwright/test';
import { loginAsAdmin } from '../helpers/auth';

test.describe('æŠ•ç¨¿ä½œæˆï¼ˆç®¡ç†è€…ï¼‰', () => {
  test.beforeEach(async ({ page }) => {
    await loginAsAdmin(page);
    await page.goto('/posts/new');
  });

  test('æŠ•ç¨¿ä½œæˆãƒ•ã‚©ãƒ¼ãƒ ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async ({ page }) => {
    await expect(page.getByRole('heading', { name: 'æŠ•ç¨¿ã‚’ä½œæˆ' })).toBeVisible();
    await expect(page.getByLabel('ã‚¿ã‚¤ãƒˆãƒ«')).toBeVisible();
    await expect(page.getByLabel('å†…å®¹')).toBeVisible();
  });

  test('æŠ•ç¨¿ã‚’ä½œæˆã§ãã‚‹', async ({ page }) => {
    // ãƒ•ã‚©ãƒ¼ãƒ ã«å…¥åŠ›
    await page.getByLabel('ã‚¿ã‚¤ãƒˆãƒ«').fill('ãƒ†ã‚¹ãƒˆæŠ•ç¨¿');
    await page.getByLabel('å†…å®¹').fill('ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆã§ã™');
    
    // YouTube URL ã‚’è¿½åŠ 
    await page.getByPlaceholder('YouTube URL').fill('https://youtube.com/watch?v=abc123');
    
    // é€ä¿¡
    await page.getByRole('button', { name: 'æŠ•ç¨¿' }).click();
    
    // æŠ•ç¨¿ä¸€è¦§ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    await expect(page).toHaveURL('/posts');
    
    // ä½œæˆã—ãŸæŠ•ç¨¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByText('ãƒ†ã‚¹ãƒˆæŠ•ç¨¿')).toBeVisible();
  });

  test('ã‚¿ã‚¤ãƒˆãƒ«ãŒç©ºã®å ´åˆã¯ã‚¨ãƒ©ãƒ¼', async ({ page }) => {
    await page.getByLabel('å†…å®¹').fill('å†…å®¹ã®ã¿');
    await page.getByRole('button', { name: 'æŠ•ç¨¿' }).click();
    
    await expect(page.getByText('ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„')).toBeVisible();
  });
});
```

---

## 28.5 ã„ã„ã­æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ

**tests/e2e/likes.spec.ts ã‚’ä½œæˆ:**

```typescript
// tests/e2e/likes.spec.ts
import { test, expect } from '@playwright/test';
import { loginAsMember } from '../helpers/auth';

test.describe('ã„ã„ã­æ©Ÿèƒ½', () => {
  test.beforeEach(async ({ page }) => {
    await loginAsMember(page);
    await page.goto('/posts');
  });

  test('ã„ã„ã­ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã„ã„ã­æ•°ãŒå¢—ãˆã‚‹', async ({ page }) => {
    // æœ€åˆã®æŠ•ç¨¿ã‚’é–‹ã
    await page.locator('[data-testid="post-card"]').first().click();
    
    // ç¾åœ¨ã®ã„ã„ã­æ•°ã‚’å–å¾—
    const likeCountBefore = await page.getByTestId('like-count').textContent();
    const countBefore = parseInt(likeCountBefore || '0', 10);
    
    // ã„ã„ã­ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    await page.getByRole('button', { name: /ã„ã„ã­/ }).click();
    
    // ã„ã„ã­æ•°ãŒå¢—ãˆã‚‹ï¼ˆæ¥½è¦³çš„UIï¼‰
    await expect(page.getByTestId('like-count')).toHaveText(
      (countBefore + 1).toString()
    );
    
    // ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºãŒå¤‰ã‚ã‚‹
    await expect(page.getByRole('button', { name: /ã„ã„ã­æ¸ˆã¿/ })).toBeVisible();
  });

  test('ã„ã„ã­æ¸ˆã¿ã®æŠ•ç¨¿ã‚’ã‚‚ã†ä¸€åº¦ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã„ã„ã­ãŒè§£é™¤ã•ã‚Œã‚‹', async ({ page }) => {
    await page.locator('[data-testid="post-card"]').first().click();
    
    // ã„ã„ã­ã™ã‚‹
    await page.getByRole('button', { name: /ã„ã„ã­/ }).click();
    await page.waitForTimeout(500);
    
    // ã„ã„ã­æ•°ã‚’ç¢ºèª
    const likeCountAfterLike = await page.getByTestId('like-count').textContent();
    const countAfterLike = parseInt(likeCountAfterLike || '0', 10);
    
    // ã‚‚ã†ä¸€åº¦ã‚¯ãƒªãƒƒã‚¯ï¼ˆã„ã„ã­è§£é™¤ï¼‰
    await page.getByRole('button', { name: /ã„ã„ã­æ¸ˆã¿/ }).click();
    
    // ã„ã„ã­æ•°ãŒæ¸›ã‚‹
    await expect(page.getByTestId('like-count')).toHaveText(
      (countAfterLike - 1).toString()
    );
  });

  test('æœªãƒ­ã‚°ã‚¤ãƒ³ã§ã¯ã„ã„ã­ã§ããªã„', async ({ page }) => {
    // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
    await page.getByRole('button', { name: 'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ' }).click();
    await page.waitForURL('/login');
    
    // æŠ•ç¨¿ãƒšãƒ¼ã‚¸ã«ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹
    await page.goto('/posts');
    await page.locator('[data-testid="post-card"]').first().click();
    
    // ã„ã„ã­ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    await page.getByRole('button', { name: /ã„ã„ã­/ }).click();
    
    // ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    await expect(page).toHaveURL('/login');
  });
});
```

---

## 28.6 ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ

**tests/e2e/comments.spec.ts ã‚’ä½œæˆ:**

```typescript
// tests/e2e/comments.spec.ts
import { test, expect } from '@playwright/test';
import { loginAsMember } from '../helpers/auth';

test.describe('ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½', () => {
  test.beforeEach(async ({ page }) => {
    await loginAsMember(page);
    await page.goto('/posts');
    await page.locator('[data-testid="post-card"]').first().click();
  });

  test('ã‚³ãƒ¡ãƒ³ãƒˆãƒ•ã‚©ãƒ¼ãƒ ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async ({ page }) => {
    await expect(page.getByPlaceholder('ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›')).toBeVisible();
    await expect(page.getByRole('button', { name: 'ã‚³ãƒ¡ãƒ³ãƒˆ' })).toBeVisible();
  });

  test('ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿ã§ãã‚‹', async ({ page }) => {
    const commentText = 'ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆã‚³ãƒ¡ãƒ³ãƒˆã§ã™';
    
    // ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›
    await page.getByPlaceholder('ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›').fill(commentText);
    
    // é€ä¿¡
    await page.getByRole('button', { name: 'ã‚³ãƒ¡ãƒ³ãƒˆ' }).click();
    
    // ã‚³ãƒ¡ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByText(commentText)).toBeVisible();
    
    // ãƒ•ã‚©ãƒ¼ãƒ ãŒã‚¯ãƒªã‚¢ã•ã‚Œã‚‹
    await expect(page.getByPlaceholder('ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›')).toHaveValue('');
  });

  test('ç©ºã®ã‚³ãƒ¡ãƒ³ãƒˆã¯é€ä¿¡ã§ããªã„', async ({ page }) => {
    await page.getByRole('button', { name: 'ã‚³ãƒ¡ãƒ³ãƒˆ' }).click();
    
    // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByText('ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„')).toBeVisible();
  });

  test('ã‚³ãƒ¡ãƒ³ãƒˆæ•°ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async ({ page }) => {
    // ã‚³ãƒ¡ãƒ³ãƒˆæ•°ã‚’å–å¾—
    const commentCountBefore = await page.getByTestId('comment-count').textContent();
    const countBefore = parseInt(commentCountBefore || '0', 10);
    
    // ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿
    await page.getByPlaceholder('ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›').fill('æ–°ã—ã„ã‚³ãƒ¡ãƒ³ãƒˆ');
    await page.getByRole('button', { name: 'ã‚³ãƒ¡ãƒ³ãƒˆ' }).click();
    
    // ã‚³ãƒ¡ãƒ³ãƒˆæ•°ãŒå¢—ãˆã‚‹
    await expect(page.getByTestId('comment-count')).toHaveText(
      (countBefore + 1).toString()
    );
  });

  test('è‡ªåˆ†ã®ã‚³ãƒ¡ãƒ³ãƒˆã¯å‰Šé™¤ã§ãã‚‹', async ({ page }) => {
    const commentText = 'å‰Šé™¤ã™ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆ';
    
    // ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿
    await page.getByPlaceholder('ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›').fill(commentText);
    await page.getByRole('button', { name: 'ã‚³ãƒ¡ãƒ³ãƒˆ' }).click();
    await page.waitForTimeout(500);
    
    // ã‚³ãƒ¡ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByText(commentText)).toBeVisible();
    
    // å‰Šé™¤ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    const comment = page.locator(`text=${commentText}`).locator('..');
    await comment.getByRole('button', { name: 'å‰Šé™¤' }).click();
    
    // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    page.on('dialog', dialog => dialog.accept());
    
    // ã‚³ãƒ¡ãƒ³ãƒˆãŒå‰Šé™¤ã•ã‚Œã‚‹
    await expect(page.getByText(commentText)).not.toBeVisible();
  });
});
```

---

## 28.7 ã‚¤ãƒ™ãƒ³ãƒˆæ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ

**tests/e2e/events.spec.ts ã‚’ä½œæˆ:**

```typescript
// tests/e2e/events.spec.ts
import { test, expect } from '@playwright/test';
import { loginAsAdmin, loginAsMember } from '../helpers/auth';

test.describe('ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ï¼ˆç®¡ç†è€…ï¼‰', () => {
  test.beforeEach(async ({ page }) => {
    await loginAsAdmin(page);
  });

  test('ã‚¤ãƒ™ãƒ³ãƒˆã‚’ä½œæˆã§ãã‚‹', async ({ page }) => {
    await page.goto('/events/new');
    
    // ãƒ•ã‚©ãƒ¼ãƒ ã«å…¥åŠ›
    await page.getByLabel('ã‚¤ãƒ™ãƒ³ãƒˆå').fill('æ–°å¹´ãƒ©ã‚¤ãƒ–');
    await page.getByLabel('é–‹å‚¬æ—¥æ™‚').fill('2025-01-15T18:00');
    await page.getByLabel('å ´æ‰€').fill('å¸‚æ°‘ãƒ›ãƒ¼ãƒ«');
    await page.getByLabel('å†…å®¹').fill('æ–°å¹´æœ€åˆã®ãƒ©ã‚¤ãƒ–ã‚¤ãƒ™ãƒ³ãƒˆ');
    
    // èª²é¡Œæ›²ã‚’è¿½åŠ 
    await page.getByRole('button', { name: 'èª²é¡Œæ›²ã‚’è¿½åŠ ' }).click();
    await page.getByLabel('æ›²å').fill('æ˜¥ã‚ˆæ¥ã„');
    await page.getByLabel('YouTube URL').fill('https://youtube.com/watch?v=abc');
    
    // é€ä¿¡
    await page.getByRole('button', { name: 'ä½œæˆ' }).click();
    
    // ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    await expect(page).toHaveURL('/events');
    
    // ä½œæˆã—ãŸã‚¤ãƒ™ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByText('æ–°å¹´ãƒ©ã‚¤ãƒ–')).toBeVisible();
  });

  test('ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç·¨é›†ã§ãã‚‹', async ({ page }) => {
    await page.goto('/events');
    
    // æœ€åˆã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’é¸æŠ
    await page.locator('[data-testid="event-card"]').first().click();
    
    // ç·¨é›†ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    await page.getByRole('button', { name: 'ç·¨é›†' }).click();
    
    // ã‚¤ãƒ™ãƒ³ãƒˆåã‚’å¤‰æ›´
    await page.getByLabel('ã‚¤ãƒ™ãƒ³ãƒˆå').clear();
    await page.getByLabel('ã‚¤ãƒ™ãƒ³ãƒˆå').fill('æ›´æ–°ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆ');
    
    // ä¿å­˜
    await page.getByRole('button', { name: 'ä¿å­˜' }).click();
    
    // å¤‰æ›´ãŒåæ˜ ã•ã‚Œã‚‹
    await expect(page.getByText('æ›´æ–°ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆ')).toBeVisible();
  });

  test('ã‚¤ãƒ™ãƒ³ãƒˆã‚’å‰Šé™¤ã§ãã‚‹', async ({ page }) => {
    await page.goto('/events');
    
    // æœ€åˆã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’é¸æŠ
    await page.locator('[data-testid="event-card"]').first().click();
    
    // ã‚¤ãƒ™ãƒ³ãƒˆåã‚’è¨˜éŒ²
    const eventName = await page.getByRole('heading', { level: 1 }).textContent();
    
    // å‰Šé™¤ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    await page.getByRole('button', { name: 'å‰Šé™¤' }).click();
    
    // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
    page.on('dialog', dialog => {
      expect(dialog.message()).toContain('å‰Šé™¤ã—ã¾ã™ã‹');
      dialog.accept();
    });
    
    // ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    await expect(page).toHaveURL('/events');
    
    // å‰Šé™¤ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œãªã„
    await expect(page.getByText(eventName!)).not.toBeVisible();
  });
});

test.describe('ã‚¤ãƒ™ãƒ³ãƒˆå‚åŠ ï¼ˆä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰', () => {
  test.beforeEach(async ({ page }) => {
    await loginAsMember(page);
  });

  test('ã‚¤ãƒ™ãƒ³ãƒˆã«å‚åŠ ç™»éŒ²ã§ãã‚‹', async ({ page }) => {
    await page.goto('/events');
    await page.locator('[data-testid="event-card"]').first().click();
    
    // å‚åŠ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    await page.getByRole('button', { name: 'å‚åŠ ã™ã‚‹' }).click();
    
    // ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºãŒå¤‰ã‚ã‚‹
    await expect(page.getByRole('button', { name: 'å‚åŠ ä¸­' })).toBeVisible();
    
    // å‚åŠ è€…ãƒªã‚¹ãƒˆã«è‡ªåˆ†ã®åå‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByText('Member User')).toBeVisible();
  });

  test('å‚åŠ ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã§ãã‚‹', async ({ page }) => {
    await page.goto('/events');
    await page.locator('[data-testid="event-card"]').first().click();
    
    // å‚åŠ ã™ã‚‹
    await page.getByRole('button', { name: 'å‚åŠ ã™ã‚‹' }).click();
    await page.waitForTimeout(500);
    
    // ã‚­ãƒ£ãƒ³ã‚»ãƒ«
    await page.getByRole('button', { name: 'å‚åŠ ä¸­' }).click();
    
    // ãƒœã‚¿ãƒ³ãŒå…ƒã«æˆ»ã‚‹
    await expect(page.getByRole('button', { name: 'å‚åŠ ã™ã‚‹' })).toBeVisible();
  });
});
```

---

## 28.8 ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã¨ãƒ“ãƒ‡ã‚ª

### è‡ªå‹•ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ

```typescript
test('å¤±æ•—æ™‚ã«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®ã‚‹', async ({ page }) => {
  await page.goto('/');
  
  // ã‚ã–ã¨å¤±æ•—ã•ã›ã‚‹
  await expect(page.getByText('å­˜åœ¨ã—ãªã„è¦ç´ ')).toBeVisible();
  
  // â†’ å¤±æ•—æ™‚ã«è‡ªå‹•ã§ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ’®å½±
});
```

**æ‰‹å‹•ã§ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ:**

```typescript
test('æŠ•ç¨¿ä½œæˆç”»é¢ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ', async ({ page }) => {
  await loginAsAdmin(page);
  await page.goto('/posts/new');
  
  // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®å½±
  await page.screenshot({ 
    path: 'screenshots/post-create.png',
    fullPage: true 
  });
});
```

### ãƒ“ãƒ‡ã‚ªéŒ²ç”»

```typescript
// playwright.config.ts ã§è¨­å®š
use: {
  video: 'on', // ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã§éŒ²ç”»
  // ã¾ãŸã¯
  video: 'retain-on-failure', // å¤±æ•—æ™‚ã®ã¿ä¿å­˜
}
```

**ãƒ“ãƒ‡ã‚ªã¯test-results/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚**

---

## 28.9 ãƒ¢ãƒã‚¤ãƒ«ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

### ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã§ã®ãƒ†ã‚¹ãƒˆ

```typescript
// tests/e2e/mobile.spec.ts
import { test, expect, devices } from '@playwright/test';

test.use(devices['iPhone 12']);

test.describe('ãƒ¢ãƒã‚¤ãƒ«è¡¨ç¤º', () => {
  test('ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async ({ page }) => {
    await page.goto('/');
    
    // ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¯éè¡¨ç¤º
    await expect(page.getByTestId('desktop-menu')).not.toBeVisible();
    
    // ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByTestId('mobile-menu-button')).toBeVisible();
    
    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã
    await page.getByTestId('mobile-menu-button').click();
    
    // ãƒ¢ãƒã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.getByTestId('mobile-menu')).toBeVisible();
  });

  test('æŠ•ç¨¿ã‚«ãƒ¼ãƒ‰ãŒãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–ã•ã‚Œã¦ã„ã‚‹', async ({ page }) => {
    await page.goto('/posts');
    
    // ã‚«ãƒ¼ãƒ‰ãŒ1ã‚«ãƒ©ãƒ è¡¨ç¤º
    const postCards = page.locator('[data-testid="post-card"]');
    const firstCard = postCards.first();
    
    // ã‚«ãƒ¼ãƒ‰ã®å¹…ãŒãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆå¹…ã«è¿‘ã„
    const boundingBox = await firstCard.boundingBox();
    const viewportSize = page.viewportSize();
    
    expect(boundingBox!.width).toBeGreaterThan(viewportSize!.width * 0.8);
  });
});
```

---

## 28.10 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

### ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚é–“ã®æ¸¬å®š

```typescript
// tests/e2e/performance.spec.ts
import { test, expect } from '@playwright/test';

test.describe('ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹', () => {
  test('ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ãŒ2ç§’ä»¥å†…ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹', async ({ page }) => {
    const startTime = Date.now();
    
    await page.goto('/');
    await page.waitForLoadState('networkidle');
    
    const loadTime = Date.now() - startTime;
    
    expect(loadTime).toBeLessThan(2000);
  });

  test('æŠ•ç¨¿ä¸€è¦§ãŒ3ç§’ä»¥å†…ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹', async ({ page }) => {
    const startTime = Date.now();
    
    await page.goto('/posts');
    await page.waitForSelector('[data-testid="post-card"]');
    
    const loadTime = Date.now() - startTime;
    
    expect(loadTime).toBeLessThan(3000);
  });

  test('ç”»åƒã®é…å»¶èª­ã¿è¾¼ã¿ãŒæ©Ÿèƒ½ã™ã‚‹', async ({ page }) => {
    await page.goto('/posts');
    
    // æœ€åˆã®ç”»åƒãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹
    const firstImage = page.locator('img').first();
    await expect(firstImage).toHaveAttribute('loading', 'lazy');
    
    // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ç”»åƒã‚’è¡¨ç¤º
    await firstImage.scrollIntoViewIfNeeded();
    
    // ç”»åƒãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹
    await expect(firstImage).toHaveAttribute('src', /.+/);
  });
});
```

---

## 28.11 CI/CDã§ã®E2Eãƒ†ã‚¹ãƒˆ

### GitHub Actions ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

**.github/workflows/e2e.yml ã‚’ä½œæˆ:**

```yaml
name: E2E Tests

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Install Playwright browsers
        run: npx playwright install --with-deps

      - name: Setup database
        run: |
          export DATABASE_URL="file:./test.db"
          npx prisma generate
          npx prisma db push

      - name: Create test admin user
        run: |
          export DATABASE_URL="file:./test.db"
          node scripts/create-admin.js admin@test.com admin123 "Admin User"

      - name: Run E2E tests
        env:
          DATABASE_URL: "file:./test.db"
          AUTH_URL: "http://localhost:3000"
          AUTH_SECRET: "test-secret-key-for-ci"
          NEXT_PUBLIC_SUPABASE_URL: "https://test.supabase.co"
          NEXT_PUBLIC_SUPABASE_ANON_KEY: "test-anon-key"
        run: npm run test:e2e

      - name: Upload test results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: playwright-report
          path: playwright-report/

      - name: Upload videos
        if: failure()
        uses: actions/upload-artifact@v4
        with:
          name: test-videos
          path: test-results/
```

---

## ã¾ã¨ã‚

ã“ã®ç« ã§å­¦ã‚“ã ã“ã¨ï¼š

âœ… **Playwright ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—** - è¨­å®šã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
âœ… **åŸºæœ¬çš„ãªãƒ†ã‚¹ãƒˆ** - ãƒšãƒ¼ã‚¸è¡¨ç¤ºã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
âœ… **èªè¨¼ãƒ•ãƒ­ãƒ¼ã®ãƒ†ã‚¹ãƒˆ** - ãƒ­ã‚°ã‚¤ãƒ³ã€ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã€æ¨©é™
âœ… **ã„ã„ã­ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½** - æ¥½è¦³çš„UIã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
âœ… **ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†** - CRUDæ“ä½œã€å‚åŠ ç™»éŒ²
âœ… **ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãƒ»ãƒ“ãƒ‡ã‚ª** - ãƒ‡ãƒãƒƒã‚°ã€è¨¼æ‹ ä¿å­˜
âœ… **ãƒ¢ãƒã‚¤ãƒ«ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³** - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ†ã‚¹ãƒˆ
âœ… **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ** - èª­ã¿è¾¼ã¿æ™‚é–“æ¸¬å®š
âœ… **CI/CDçµ±åˆ** - GitHub Actions ã§è‡ªå‹•å®Ÿè¡Œ

**æ¬¡ã®ç« ã§ã¯ã€CI/CD ã®è©³ç´°ãªå®Ÿè£…ã‚’å­¦ã³ã¾ã™ã€‚**

---

[â† å‰ã®ç« ï¼šç¬¬27ç«  çµåˆãƒ†ã‚¹ãƒˆã®å®Ÿè£…](27-çµåˆãƒ†ã‚¹ãƒˆã®å®Ÿè£….md) | [ç›®æ¬¡ã«æˆ»ã‚‹](00-ç›®æ¬¡.md) | [æ¬¡ã®ç« ã¸ï¼šç¬¬29ç«  CI/CDã®å®Ÿè£… â†’](29-CI-CDã®å®Ÿè£….md)
